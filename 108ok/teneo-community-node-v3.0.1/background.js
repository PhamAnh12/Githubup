const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["chunks/bidi-CW5FCHXd.js","chunks/_virtual_wxt-plugins-CYLfT0K8.js","chunks/general.config-osRriZOx.js","chunks/constants-BKXh9xlg.js","chunks/NodeWebSocketTransport-DkR-FYoZ.js"])))=>i.map(i=>d[i]);
var $p=Object.defineProperty;var Dl=s=>{throw TypeError(s)};var Wp=(s,r,e)=>r in s?$p(s,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[r]=e;var F=(s,r,e)=>Wp(s,typeof r!="symbol"?r+"":r,e),Ol=(s,r,e)=>r.has(s)||Dl("Cannot "+e),ut=(s,r)=>Object(r)!==r?Dl('Cannot use the "in" operator on this value'):s.has(r),n=(s,r,e)=>(Ol(s,r,"read from private field"),e?e.call(s):r.get(s)),d=(s,r,e)=>r.has(s)?Dl("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(s):r.set(s,e),p=(s,r,e,t)=>(Ol(s,r,"write to private field"),t?t.call(s,e):r.set(s,e),e),b=(s,r,e)=>(Ol(s,r,"access private method"),e);var Zn=(s,r,e,t)=>({set _(i){p(s,r,i,e)},get _(){return n(s,r,t)}});import{g as wc,D as Cl}from"./chunks/general.config-osRriZOx.js";import{w as Bp}from"./chunks/constants-BKXh9xlg.js";import{f as Vc,c as bh,i as jp}from"./chunks/_virtual_wxt-plugins-CYLfT0K8.js";const qp={},Sh=!1;function O(...s){Sh&&console.info("[safeWarn]",...s)}function z(...s){Sh&&console.info("[safeError]",...s)}const ui=class ui{constructor(){F(this,"platformConfigs",new Map);F(this,"activeScripts",new Map);F(this,"processingTabs",new Set);this.initializeMessageListener(),this.initializeStorageListener()}static getInstance(){return ui.instance||(ui.instance=new ui),ui.instance}registerPlatform(r,e){this.platformConfigs.has(r.id)?O(`[CSM] Updating platform: ${r.id}`):O(`[CSM] Registering new platform: ${r.id}`),this.platformConfigs.set(r.id,e),this.updateContentScriptStates()}initializeMessageListener(){chrome.runtime.onMessage.addListener(r=>{r.type==="DISABLE_GATHERING"?this.handleDisableGathering(r.tabId):r.type==="ENABLE_GATHERING"&&this.handleEnableGathering(r.tabId)})}initializeStorageListener(){chrome.storage.onChanged.addListener(r=>{r.platformSettings&&this.updateContentScriptStates()})}getPlatformForUrl(r){for(const[,e]of this.platformConfigs)if(e.hostnames.some(t=>r.includes(t)))return e.platform;return null}getPlatformConfig(r){return this.platformConfigs.get(r)}getPlatformById(r){const e=this.platformConfigs.get(r);return e?e.platform:null}async initializeContentScript(r,e){if(this.processingTabs.has(r)){O(`[CSM] Skip Init: Already processing tab ${r}.`);return}const t=this.platformConfigs.get(e.id);if(!t){z(`[CSM] Error Init: No config found for platform ${e.id} in tab ${r}.`);return}this.processingTabs.add(r),O(`[CSM] Start Init: Initializing script for ${e.id} in tab ${r}.`);try{const i={...t,platform:e};await this.sendMessageWithRetry(r,{type:"INIT_DYNAMIC_CONTENT_SCRIPT",target:"dynamic",config:i},2,1e3);const a=await chrome.runtime.sendMessage({type:"CHECK_WEBSOCKET_STATUS"});await chrome.tabs.sendMessage(r,{type:"WEBSOCKET_STATUS",isConnected:(a==null?void 0:a.isConnected)||!1}),O(`[CSM] Success Init: Content script initialized for ${e.id} in tab ${r}.`)}catch(i){const a=i instanceof Error?i:new Error(String(i));a.message.includes("no longer exists")?O(`[CSM] Info Init: Tab ${r} closed during INIT.`):z(`[CSM] Error Init: Failed during INIT_DYNAMIC_CONTENT_SCRIPT for tab ${r}:`,a)}finally{this.processingTabs.delete(r),O(`[CSM] End Init: Finished processing init for tab ${r}.`)}}async stopContentScript(r){if(this.processingTabs.has(r)){O(`[CSM] Skip Stop: Currently processing tab ${r}, stop will happen after.`);return}O(`[CSM] Action Stop: Sending STOP_CONTENT_SCRIPT to tab ${r}.`);try{await this.sendMessageWithRetry(r,{type:"STOP_CONTENT_SCRIPT"},1,200),O(`[CSM] Success Stop: STOP message sent to tab ${r}.`)}catch(e){const t=e instanceof Error?e:new Error(String(e));t.message.includes("no longer exists")||t.message.includes("Could not establish connection")?O(`[CSM] Info Stop: Tab ${r} likely closed or script unloaded.`):O(`[CSM] Warn Stop: Failed to send STOP message to tab ${r}:`,t.message)}}handleTabRemoval(r){O(`[CSM] Cleanup: Removing state for closed tab ${r}.`),this.activeScripts.delete(r),this.processingTabs.delete(r)}async sendMessageWithRetry(r,e,t=3,i=1e3){let a;for(let o=0;o<=t;o++)try{o>0&&(O(`Waiting ${i}ms before retry ${o+1}/${t+1}`),await new Promise(l=>setTimeout(l,i)));try{await chrome.tabs.get(r)}catch(l){const u=l instanceof Error?l.message:String(l);throw new Error(`Tab ${r} no longer exists: ${u}`)}const c=await chrome.tabs.sendMessage(r,e);if(O(`Message response for ${e.type}:`,c),(c==null?void 0:c.success)===!1){if(c.error==="Already initialized")return O("Content script already initialized, stopping retry attempts"),c;throw new Error(c.error||"Content script returned error")}return c}catch(c){if(a=c instanceof Error?c:new Error(String(c)),O(`Attempt ${o+1}/${t+1} failed:`,c),a.message.includes("no longer exists")||a.message.includes("Already initialized")){O(`[CSM] Info: Tab ${r} closed or already initialized.`);return}o<t&&(i*=2)}throw a}async handleEnableGathering(r){if(this.processingTabs.has(r)){O(`[CSM] Skip: Already processing enable/init for tab ${r}.`);return}let e=null;try{if(this.processingTabs.add(r),O(`[CSM] Start: Processing enable/init for tab ${r}.`),e=await this.getPlatformFromTab(r),!e){O(`[CSM] Info: No platform found for tab ${r}.`);return}const t=this.platformConfigs.get(e.id);if(!t){z(`[CSM] Error: No configuration found for platform ${e.id} in tab ${r}.`);return}O(`[CSM] Action: Enabling gathering for ${e.id} in tab ${r}.`);const i={...t,platform:e,platformId:e.id};let a=!0;try{O(`[CSM] Action: Attempting INIT_DYNAMIC_CONTENT_SCRIPT for tab ${r}.`);const o=await this.sendMessageWithRetry(r,{type:"INIT_DYNAMIC_CONTENT_SCRIPT",target:"dynamic",config:i},2,1e3);o!=null&&o.success?O(`[CSM] Success: Content script initialized successfully in tab ${r}.`):(o==null?void 0:o.error)==="Already initialized"?O(`[CSM] Info: Content script already initialized in tab ${r}.`):(z(`[CSM] Error: Content script initialization failed for tab ${r}:`,(o==null?void 0:o.error)||"Unknown error"),a=!1)}catch(o){const c=o instanceof Error?o:new Error(String(o));c.message.includes("no longer exists")?(O(`[CSM] Info: Tab ${r} closed during INIT. Cleaning up.`),this.activeScripts.delete(r),a=!1):(z(`[CSM] Error: Exception during INIT_DYNAMIC_CONTENT_SCRIPT for tab ${r}:`,c),a=!1)}if(a)try{O(`[CSM] Action: Attempting ENABLE_GATHERING for tab ${r}.`),await this.sendMessageWithRetry(r,{type:"ENABLE_GATHERING",tabId:r},1,500),O(`[CSM] Success: Gathering enabled successfully for tab ${r}.`)}catch(o){const c=o instanceof Error?o:new Error(String(o));c.message.includes("no longer exists")?(O(`[CSM] Info: Tab ${r} closed during ENABLE. Cleaning up.`),this.activeScripts.delete(r)):z(`[CSM] Error: Failed to enable gathering for tab ${r} after init attempt:`,c)}}catch(t){z(`[CSM] Error: Unhandled error during setup for tab ${r}:`,t)}finally{this.processingTabs.delete(r),O(`[CSM] End: Finished processing enable/init for tab ${r}.`)}}async getPlatformFromTab(r){if(typeof chrome>"u"||!chrome.tabs){const e=this.getPlatformForUrl(window.location.hostname.replace("www.",""));return O("url from tab",window.location.hostname.replace("www.","")),O("platform from tab",e),e}try{const e=await chrome.tabs.get(r);return!e||!e.url?(O(`[CSM] Warn: Could not get tab details or URL for tab ${r}.`),null):this.getPlatformForUrl(e.url)}catch(e){const t=e instanceof Error?e:new Error(String(e));return z(`[CSM] Error getting tab ${r} details: ${t.message}`,t),null}}async handleDisableGathering(r){try{this.activeScripts.delete(r),await chrome.tabs.sendMessage(r,{type:"DISABLE_GATHERING"})}catch{}}async updateContentScriptStates(){const r=await chrome.tabs.query({}),{platformSettings:e={}}=await chrome.storage.local.get("platformSettings");for(const t of r){if(!t.id||!t.url)continue;const i=this.getPlatformForUrl(t.url.replace("https://","").replace("http://",""));!i||!this.platformConfigs.get(i.id)||(e[i.id]?await this.handleEnableGathering(t.id):await this.handleDisableGathering(t.id))}}unregisterPlatform(r){this.platformConfigs.has(r)?(this.platformConfigs.delete(r),O(`[CSM] Unregistered platform: ${r}`),this.updateContentScriptStates()):O(`[CSM] Attempted to unregister a non-existent platform: ${r}`)}};F(ui,"instance");let Gl=ui;const us=Gl.getInstance();var Vl=function(s,r){return Vl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},Vl(s,r)};function yr(s,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");Vl(s,r);function e(){this.constructor=s}s.prototype=r===null?Object.create(r):(e.prototype=r.prototype,new e)}function Up(s,r,e,t){function i(a){return a instanceof e?a:new e(function(o){o(a)})}return new(e||(e=Promise))(function(a,o){function c(f){try{u(t.next(f))}catch(w){o(w)}}function l(f){try{u(t.throw(f))}catch(w){o(w)}}function u(f){f.done?a(f.value):i(f.value).then(c,l)}u((t=t.apply(s,[])).next())})}function kh(s,r){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},t,i,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=c(0),o.throw=c(1),o.return=c(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(f){return l([u,f])}}function l(u){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(e=0)),e;)try{if(t=1,i&&(a=u[0]&2?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return e.label++,{value:u[1],done:!1};case 5:e.label++,i=u[1],u=[0];continue;case 7:u=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){e=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){e.label=u[1];break}if(u[0]===6&&e.label<a[1]){e.label=a[1],a=u;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(u);break}a[2]&&e.ops.pop(),e.trys.pop();continue}u=r.call(s,e)}catch(f){u=[6,f],i=0}finally{t=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function qn(s){var r=typeof Symbol=="function"&&Symbol.iterator,e=r&&s[r],t=0;if(e)return e.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&t>=s.length&&(s=void 0),{value:s&&s[t++],done:!s}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function ds(s,r){var e=typeof Symbol=="function"&&s[Symbol.iterator];if(!e)return s;var t=e.call(s),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=t.next()).done;)a.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(e=t.return)&&e.call(t)}finally{if(o)throw o.error}}return a}function Un(s,r,e){if(arguments.length===2)for(var t=0,i=r.length,a;t<i;t++)(a||!(t in r))&&(a||(a=Array.prototype.slice.call(r,0,t)),a[t]=r[t]);return s.concat(a||Array.prototype.slice.call(r))}function Es(s){return this instanceof Es?(this.v=s,this):new Es(s)}function Hp(s,r,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e.apply(s,r||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(g){return function(S){return Promise.resolve(S).then(g,w)}}function c(g,S){t[g]&&(i[g]=function(m){return new Promise(function(v,T){a.push([g,m,v,T])>1||l(g,m)})},S&&(i[g]=S(i[g])))}function l(g,S){try{u(t[g](S))}catch(m){h(a[0][3],m)}}function u(g){g.value instanceof Es?Promise.resolve(g.value.v).then(f,w):h(a[0][2],g)}function f(g){l("next",g)}function w(g){l("throw",g)}function h(g,S){g(S),a.shift(),a.length&&l(a[0][0],a[0][1])}}function Gp(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=s[Symbol.asyncIterator],e;return r?r.call(s):(s=typeof qn=="function"?qn(s):s[Symbol.iterator](),e={},t("next"),t("throw"),t("return"),e[Symbol.asyncIterator]=function(){return this},e);function t(a){e[a]=s[a]&&function(o){return new Promise(function(c,l){o=s[a](o),i(c,l,o.done,o.value)})}}function i(a,o,c,l){Promise.resolve(l).then(function(u){a({value:u,done:c})},o)}}function ce(s){return typeof s=="function"}function sd(s){var r=function(t){Error.call(t),t.stack=new Error().stack},e=s(r);return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var xl=sd(function(s){return function(e){s(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(t,i){return i+1+") "+t.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function zc(s,r){if(s){var e=s.indexOf(r);0<=e&&s.splice(e,1)}}var vc=function(){function s(r){this.initialTeardown=r,this.closed=!1,this._parentage=null,this._finalizers=null}return s.prototype.unsubscribe=function(){var r,e,t,i,a;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var c=qn(o),l=c.next();!l.done;l=c.next()){var u=l.value;u.remove(this)}}catch(m){r={error:m}}finally{try{l&&!l.done&&(e=c.return)&&e.call(c)}finally{if(r)throw r.error}}else o.remove(this);var f=this.initialTeardown;if(ce(f))try{f()}catch(m){a=m instanceof xl?m.errors:[m]}var w=this._finalizers;if(w){this._finalizers=null;try{for(var h=qn(w),g=h.next();!g.done;g=h.next()){var S=g.value;try{Ad(S)}catch(m){a=a??[],m instanceof xl?a=Un(Un([],ds(a)),ds(m.errors)):a.push(m)}}}catch(m){t={error:m}}finally{try{g&&!g.done&&(i=h.return)&&i.call(h)}finally{if(t)throw t.error}}}if(a)throw new xl(a)}},s.prototype.add=function(r){var e;if(r&&r!==this)if(this.closed)Ad(r);else{if(r instanceof s){if(r.closed||r._hasParent(this))return;r._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(r)}},s.prototype._hasParent=function(r){var e=this._parentage;return e===r||Array.isArray(e)&&e.includes(r)},s.prototype._addParent=function(r){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(r),e):e?[e,r]:r},s.prototype._removeParent=function(r){var e=this._parentage;e===r?this._parentage=null:Array.isArray(e)&&zc(e,r)},s.prototype.remove=function(r){var e=this._finalizers;e&&zc(e,r),r instanceof s&&r._removeParent(this)},s.EMPTY=function(){var r=new s;return r.closed=!0,r}(),s}(),Eh=vc.EMPTY;function Th(s){return s instanceof vc||s&&"closed"in s&&ce(s.remove)&&ce(s.add)&&ce(s.unsubscribe)}function Ad(s){ce(s)?s():s.unsubscribe()}var Vp={Promise:void 0},zp={setTimeout:function(s,r){for(var e=[],t=2;t<arguments.length;t++)e[t-2]=arguments[t];return setTimeout.apply(void 0,Un([s,r],ds(e)))},clearTimeout:function(s){return clearTimeout(s)},delegate:void 0};function Ch(s){zp.setTimeout(function(){throw s})}function Hn(){}function Mc(s){s()}var nd=function(s){yr(r,s);function r(e){var t=s.call(this)||this;return t.isStopped=!1,e?(t.destination=e,Th(e)&&e.add(t)):t.destination=Qp,t}return r.create=function(e,t,i){return new Jc(e,t,i)},r.prototype.next=function(e){this.isStopped||this._next(e)},r.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,s.prototype.unsubscribe.call(this),this.destination=null)},r.prototype._next=function(e){this.destination.next(e)},r.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},r.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},r}(vc),Jp=function(){function s(r){this.partialObserver=r}return s.prototype.next=function(r){var e=this.partialObserver;if(e.next)try{e.next(r)}catch(t){Sc(t)}},s.prototype.error=function(r){var e=this.partialObserver;if(e.error)try{e.error(r)}catch(t){Sc(t)}else Sc(r)},s.prototype.complete=function(){var r=this.partialObserver;if(r.complete)try{r.complete()}catch(e){Sc(e)}},s}(),Jc=function(s){yr(r,s);function r(e,t,i){var a=s.call(this)||this,o;return ce(e)||!e?o={next:e??void 0,error:t??void 0,complete:i??void 0}:o=e,a.destination=new Jp(o),a}return r}(nd);function Sc(s){Ch(s)}function Xp(s){throw s}var Qp={closed:!0,next:Hn,error:Xp,complete:Hn},ad=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Gt(s){return s}function Yp(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];return Ph(s)}function Ph(s){return s.length===0?Gt:s.length===1?s[0]:function(e){return s.reduce(function(t,i){return i(t)},e)}}var ke=function(){function s(r){r&&(this._subscribe=r)}return s.prototype.lift=function(r){var e=new s;return e.source=this,e.operator=r,e},s.prototype.subscribe=function(r,e,t){var i=this,a=em(r)?r:new Jc(r,e,t);return Mc(function(){var o=i,c=o.operator,l=o.source;a.add(c?c.call(a,l):l?i._subscribe(a):i._trySubscribe(a))}),a},s.prototype._trySubscribe=function(r){try{return this._subscribe(r)}catch(e){r.error(e)}},s.prototype.forEach=function(r,e){var t=this;return e=Id(e),new e(function(i,a){var o=new Jc({next:function(c){try{r(c)}catch(l){a(l),o.unsubscribe()}},error:a,complete:i});t.subscribe(o)})},s.prototype._subscribe=function(r){var e;return(e=this.source)===null||e===void 0?void 0:e.subscribe(r)},s.prototype[ad]=function(){return this},s.prototype.pipe=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return Ph(r)(this)},s.prototype.toPromise=function(r){var e=this;return r=Id(r),new r(function(t,i){var a;e.subscribe(function(o){return a=o},function(o){return i(o)},function(){return t(a)})})},s.create=function(r){return new s(r)},s}();function Id(s){var r;return(r=s??Vp.Promise)!==null&&r!==void 0?r:Promise}function Zp(s){return s&&ce(s.next)&&ce(s.error)&&ce(s.complete)}function em(s){return s&&s instanceof nd||Zp(s)&&Th(s)}function tm(s){return ce(s==null?void 0:s.lift)}function Le(s){return function(r){if(tm(r))return r.lift(function(e){try{return s(e,this)}catch(t){this.error(t)}});throw new TypeError("Unable to lift unknown Observable type")}}function Fe(s,r,e,t,i){return new rm(s,r,e,t,i)}var rm=function(s){yr(r,s);function r(e,t,i,a,o,c){var l=s.call(this,e)||this;return l.onFinalize=o,l.shouldUnsubscribe=c,l._next=t?function(u){try{t(u)}catch(f){e.error(f)}}:s.prototype._next,l._error=a?function(u){try{a(u)}catch(f){e.error(f)}finally{this.unsubscribe()}}:s.prototype._error,l._complete=i?function(){try{i()}catch(u){e.error(u)}finally{this.unsubscribe()}}:s.prototype._complete,l}return r.prototype.unsubscribe=function(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var t=this.closed;s.prototype.unsubscribe.call(this),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}},r}(nd),im=sd(function(s){return function(){s(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),_h=function(s){yr(r,s);function r(){var e=s.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return r.prototype.lift=function(e){var t=new Fd(this,this);return t.operator=e,t},r.prototype._throwIfClosed=function(){if(this.closed)throw new im},r.prototype.next=function(e){var t=this;Mc(function(){var i,a;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var o=qn(t.currentObservers),c=o.next();!c.done;c=o.next()){var l=c.value;l.next(e)}}catch(u){i={error:u}}finally{try{c&&!c.done&&(a=o.return)&&a.call(o)}finally{if(i)throw i.error}}}})},r.prototype.error=function(e){var t=this;Mc(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var i=t.observers;i.length;)i.shift().error(e)}})},r.prototype.complete=function(){var e=this;Mc(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})},r.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(r.prototype,"observed",{get:function(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0},enumerable:!1,configurable:!0}),r.prototype._trySubscribe=function(e){return this._throwIfClosed(),s.prototype._trySubscribe.call(this,e)},r.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},r.prototype._innerSubscribe=function(e){var t=this,i=this,a=i.hasError,o=i.isStopped,c=i.observers;return a||o?Eh:(this.currentObservers=null,c.push(e),new vc(function(){t.currentObservers=null,zc(c,e)}))},r.prototype._checkFinalizedStatuses=function(e){var t=this,i=t.hasError,a=t.thrownError,o=t.isStopped;i?e.error(a):o&&e.complete()},r.prototype.asObservable=function(){var e=new ke;return e.source=this,e},r.create=function(e,t){return new Fd(e,t)},r}(ke),Fd=function(s){yr(r,s);function r(e,t){var i=s.call(this)||this;return i.destination=e,i.source=t,i}return r.prototype.next=function(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.next)===null||i===void 0||i.call(t,e)},r.prototype.error=function(e){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.error)===null||i===void 0||i.call(t,e)},r.prototype.complete=function(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)},r.prototype._subscribe=function(e){var t,i;return(i=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&i!==void 0?i:Eh},r}(_h),od={now:function(){return(od.delegate||Date).now()},delegate:void 0},sm=function(s){yr(r,s);function r(e,t,i){e===void 0&&(e=1/0),t===void 0&&(t=1/0),i===void 0&&(i=od);var a=s.call(this)||this;return a._bufferSize=e,a._windowTime=t,a._timestampProvider=i,a._buffer=[],a._infiniteTimeWindow=!0,a._infiniteTimeWindow=t===1/0,a._bufferSize=Math.max(1,e),a._windowTime=Math.max(1,t),a}return r.prototype.next=function(e){var t=this,i=t.isStopped,a=t._buffer,o=t._infiniteTimeWindow,c=t._timestampProvider,l=t._windowTime;i||(a.push(e),!o&&a.push(c.now()+l)),this._trimBuffer(),s.prototype.next.call(this,e)},r.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),i=this,a=i._infiniteTimeWindow,o=i._buffer,c=o.slice(),l=0;l<c.length&&!e.closed;l+=a?1:2)e.next(c[l]);return this._checkFinalizedStatuses(e),t},r.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,i=e._timestampProvider,a=e._buffer,o=e._infiniteTimeWindow,c=(o?1:2)*t;if(t<1/0&&c<a.length&&a.splice(0,a.length-c),!o){for(var l=i.now(),u=0,f=1;f<a.length&&a[f]<=l;f+=2)u=f;u&&a.splice(0,u+1)}},r}(_h),nm=function(s){yr(r,s);function r(e,t){return s.call(this)||this}return r.prototype.schedule=function(e,t){return this},r}(vc),Dd={setInterval:function(s,r){for(var e=[],t=2;t<arguments.length;t++)e[t-2]=arguments[t];return setInterval.apply(void 0,Un([s,r],ds(e)))},clearInterval:function(s){return clearInterval(s)},delegate:void 0},am=function(s){yr(r,s);function r(e,t){var i=s.call(this,e,t)||this;return i.scheduler=e,i.work=t,i.pending=!1,i}return r.prototype.schedule=function(e,t){var i;if(t===void 0&&(t=0),this.closed)return this;this.state=e;var a=this.id,o=this.scheduler;return a!=null&&(this.id=this.recycleAsyncId(o,a,t)),this.pending=!0,this.delay=t,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(o,this.id,t),this},r.prototype.requestAsyncId=function(e,t,i){return i===void 0&&(i=0),Dd.setInterval(e.flush.bind(e,this),i)},r.prototype.recycleAsyncId=function(e,t,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return t;t!=null&&Dd.clearInterval(t)},r.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(e,t);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},r.prototype._execute=function(e,t){var i=!1,a;try{this.work(e)}catch(o){i=!0,a=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),a},r.prototype.unsubscribe=function(){if(!this.closed){var e=this,t=e.id,i=e.scheduler,a=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,zc(a,this),t!=null&&(this.id=this.recycleAsyncId(i,t,null)),this.delay=null,s.prototype.unsubscribe.call(this)}},r}(nm),Od=function(){function s(r,e){e===void 0&&(e=s.now),this.schedulerActionCtor=r,this.now=e}return s.prototype.schedule=function(r,e,t){return e===void 0&&(e=0),new this.schedulerActionCtor(this,r).schedule(t,e)},s.now=od.now,s}(),om=function(s){yr(r,s);function r(e,t){t===void 0&&(t=Od.now);var i=s.call(this,e,t)||this;return i.actions=[],i._active=!1,i}return r.prototype.flush=function(e){var t=this.actions;if(this._active){t.push(e);return}var i;this._active=!0;do if(i=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}},r}(Od),cm=new om(am),lm=cm,cs=new ke(function(s){return s.complete()});function um(s){return s&&ce(s.schedule)}function cd(s){return s[s.length-1]}function dm(s){return ce(cd(s))?s.pop():void 0}function bc(s){return um(cd(s))?s.pop():void 0}function hm(s,r){return typeof cd(s)=="number"?s.pop():r}var ld=function(s){return s&&typeof s.length=="number"&&typeof s!="function"};function Mh(s){return ce(s==null?void 0:s.then)}function Ah(s){return ce(s[ad])}function Ih(s){return Symbol.asyncIterator&&ce(s==null?void 0:s[Symbol.asyncIterator])}function Fh(s){return new TypeError("You provided "+(s!==null&&typeof s=="object"?"an invalid object":"'"+s+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function fm(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Dh=fm();function Oh(s){return ce(s==null?void 0:s[Dh])}function xh(s){return Hp(this,arguments,function(){var e,t,i,a;return kh(this,function(o){switch(o.label){case 0:e=s.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,Es(e.read())];case 3:return t=o.sent(),i=t.value,a=t.done,a?[4,Es(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,Es(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}})})}function Rh(s){return ce(s==null?void 0:s.getReader)}function Ge(s){if(s instanceof ke)return s;if(s!=null){if(Ah(s))return pm(s);if(ld(s))return mm(s);if(Mh(s))return gm(s);if(Ih(s))return Lh(s);if(Oh(s))return ym(s);if(Rh(s))return wm(s)}throw Fh(s)}function pm(s){return new ke(function(r){var e=s[ad]();if(ce(e.subscribe))return e.subscribe(r);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function mm(s){return new ke(function(r){for(var e=0;e<s.length&&!r.closed;e++)r.next(s[e]);r.complete()})}function gm(s){return new ke(function(r){s.then(function(e){r.closed||(r.next(e),r.complete())},function(e){return r.error(e)}).then(null,Ch)})}function ym(s){return new ke(function(r){var e,t;try{for(var i=qn(s),a=i.next();!a.done;a=i.next()){var o=a.value;if(r.next(o),r.closed)return}}catch(c){e={error:c}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}r.complete()})}function Lh(s){return new ke(function(r){vm(s,r).catch(function(e){return r.error(e)})})}function wm(s){return Lh(xh(s))}function vm(s,r){var e,t,i,a;return Up(this,void 0,void 0,function(){var o,c;return kh(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),e=Gp(s),l.label=1;case 1:return[4,e.next()];case 2:if(t=l.sent(),!!t.done)return[3,4];if(o=t.value,r.next(o),r.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=l.sent(),i={error:c},[3,11];case 6:return l.trys.push([6,,9,10]),t&&!t.done&&(a=e.return)?[4,a.call(e)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return r.complete(),[2]}})})}function ri(s,r,e,t,i){t===void 0&&(t=0),i===void 0&&(i=!1);var a=r.schedule(function(){e(),i?s.add(this.schedule(null,t)):this.unsubscribe()},t);if(s.add(a),!i)return a}function Nh(s,r){return r===void 0&&(r=0),Le(function(e,t){e.subscribe(Fe(t,function(i){return ri(t,s,function(){return t.next(i)},r)},function(){return ri(t,s,function(){return t.complete()},r)},function(i){return ri(t,s,function(){return t.error(i)},r)}))})}function Kh(s,r){return r===void 0&&(r=0),Le(function(e,t){t.add(s.schedule(function(){return e.subscribe(t)},r))})}function bm(s,r){return Ge(s).pipe(Kh(r),Nh(r))}function Sm(s,r){return Ge(s).pipe(Kh(r),Nh(r))}function km(s,r){return new ke(function(e){var t=0;return r.schedule(function(){t===s.length?e.complete():(e.next(s[t++]),e.closed||this.schedule())})})}function Em(s,r){return new ke(function(e){var t;return ri(e,r,function(){t=s[Dh](),ri(e,r,function(){var i,a,o;try{i=t.next(),a=i.value,o=i.done}catch(c){e.error(c);return}o?e.complete():e.next(a)},0,!0)}),function(){return ce(t==null?void 0:t.return)&&t.return()}})}function $h(s,r){if(!s)throw new Error("Iterable cannot be null");return new ke(function(e){ri(e,r,function(){var t=s[Symbol.asyncIterator]();ri(e,r,function(){t.next().then(function(i){i.done?e.complete():e.next(i.value)})},0,!0)})})}function Tm(s,r){return $h(xh(s),r)}function Cm(s,r){if(s!=null){if(Ah(s))return bm(s,r);if(ld(s))return km(s,r);if(Mh(s))return Sm(s,r);if(Ih(s))return $h(s,r);if(Oh(s))return Em(s,r);if(Rh(s))return Tm(s,r)}throw Fh(s)}function se(s,r){return r?Cm(s,r):Ge(s)}function xd(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];var e=bc(s);return se(s,e)}var ud=sd(function(s){return function(){s(this),this.name="EmptyError",this.message="no elements in sequence"}});function Je(s,r){return new Promise(function(e,t){var i=new Jc({next:function(a){e(a),i.unsubscribe()},error:t,complete:function(){t(new ud)}});s.subscribe(i)})}function Pm(s){return s instanceof Date&&!isNaN(s)}function Ue(s,r){return Le(function(e,t){var i=0;e.subscribe(Fe(t,function(a){t.next(s.call(r,a,i++))}))})}var _m=Array.isArray;function Mm(s,r){return _m(r)?s.apply(void 0,Un([],ds(r))):s(r)}function Wh(s){return Ue(function(r){return Mm(s,r)})}var Am=Array.isArray,Im=Object.getPrototypeOf,Fm=Object.prototype,Dm=Object.keys;function Om(s){if(s.length===1){var r=s[0];if(Am(r))return{args:r,keys:null};if(xm(r)){var e=Dm(r);return{args:e.map(function(t){return r[t]}),keys:e}}}return{args:s,keys:null}}function xm(s){return s&&typeof s=="object"&&Im(s)===Fm}function Rm(s,r){return s.reduce(function(e,t,i){return e[t]=r[i],e},{})}function Yw(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];var e=bc(s),t=dm(s),i=Om(s),a=i.args,o=i.keys;if(a.length===0)return se([],e);var c=new ke(Lm(a,e,o?function(l){return Rm(o,l)}:Gt));return t?c.pipe(Wh(t)):c}function Lm(s,r,e){return e===void 0&&(e=Gt),function(t){Rd(r,function(){for(var i=s.length,a=new Array(i),o=i,c=i,l=function(f){Rd(r,function(){var w=se(s[f],r),h=!1;w.subscribe(Fe(t,function(g){a[f]=g,h||(h=!0,c--),c||t.next(e(a.slice()))},function(){--o||t.complete()}))},t)},u=0;u<i;u++)l(u)},t)}}function Rd(s,r,e){s?ri(e,s,r):r()}function Bh(s,r,e,t,i,a,o,c){var l=[],u=0,f=0,w=!1,h=function(){w&&!l.length&&!u&&r.complete()},g=function(m){return u<t?S(m):l.push(m)},S=function(m){a&&r.next(m),u++;var v=!1;Ge(e(m,f++)).subscribe(Fe(r,function(T){i==null||i(T),a?g(T):r.next(T)},function(){v=!0},void 0,function(){if(v)try{u--;for(var T=function(){var D=l.shift();o||S(D)};l.length&&u<t;)T();h()}catch(D){r.error(D)}}))};return s.subscribe(Fe(r,g,function(){w=!0,h()})),function(){c==null||c()}}function _e(s,r,e){return e===void 0&&(e=1/0),ce(r)?_e(function(t,i){return Ue(function(a,o){return r(t,a,i,o)})(Ge(s(t,i)))},e):(typeof r=="number"&&(e=r),Le(function(t,i){return Bh(t,i,s,e)}))}function jh(s){return s===void 0&&(s=1/0),_e(Gt,s)}function Nm(){return jh(1)}function zl(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];return Nm()(se(s,bc(s)))}function Ts(s){return new ke(function(r){Ge(s()).subscribe(r)})}var Km=["addListener","removeListener"],$m=["addEventListener","removeEventListener"],Wm=["on","off"];function Jl(s,r,e,t){if(ce(e)&&(t=e,e=void 0),t)return Jl(s,r,e).pipe(Wh(t));var i=ds(qm(s)?$m.map(function(c){return function(l){return s[c](r,l,e)}}):Bm(s)?Km.map(Ld(s,r)):jm(s)?Wm.map(Ld(s,r)):[],2),a=i[0],o=i[1];if(!a&&ld(s))return _e(function(c){return Jl(c,r,e)})(Ge(s));if(!a)throw new TypeError("Invalid event target");return new ke(function(c){var l=function(){for(var u=[],f=0;f<arguments.length;f++)u[f]=arguments[f];return c.next(1<u.length?u:u[0])};return a(l),function(){return o(l)}})}function Ld(s,r){return function(e){return function(t){return s[e](r,t)}}}function Bm(s){return ce(s.addListener)&&ce(s.removeListener)}function jm(s){return ce(s.on)&&ce(s.off)}function qm(s){return ce(s.addEventListener)&&ce(s.removeEventListener)}function dd(s,r,e){return s===void 0&&(s=0),e===void 0&&(e=lm),new ke(function(t){var i=Pm(s)?+s-e.now():s;i<0&&(i=0);var a=0;return e.schedule(function(){t.closed||(t.next(a++),t.complete())},i)})}function fa(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];var e=bc(s),t=hm(s,1/0),i=s;return i.length?i.length===1?Ge(i[0]):jh(t)(se(i,e)):cs}var qh=new ke(Hn),Um=Array.isArray;function Hm(s){return s.length===1&&Um(s[0])?s[0]:s}function Qn(s,r){return Le(function(e,t){var i=0;e.subscribe(Fe(t,function(a){return s.call(r,a,i++)&&t.next(a)}))})}function Gm(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];return s=Hm(s),s.length===1?Ge(s[0]):new ke(Uh(s))}function Uh(s){return function(r){for(var e=[],t=function(a){e.push(Ge(s[a]).subscribe(Fe(r,function(o){if(e){for(var c=0;c<e.length;c++)c!==a&&e[c].unsubscribe();e=null}r.next(o)})))},i=0;e&&!r.closed&&i<s.length;i++)t(i)}}function sa(s){return Le(function(r,e){var t=null,i=!1,a;t=r.subscribe(Fe(e,void 0,void 0,function(o){a=Ge(s(o,sa(s)(r))),t?(t.unsubscribe(),t=null,a.subscribe(e)):i=!0})),i&&(t.unsubscribe(),t=null,a.subscribe(e))})}function Hh(s){return Le(function(r,e){var t=!1;r.subscribe(Fe(e,function(i){t=!0,e.next(i)},function(){t||e.next(s),e.complete()}))})}function hd(s){return s<=0?function(){return cs}:Le(function(r,e){var t=0;r.subscribe(Fe(e,function(i){++t<=s&&(e.next(i),s<=t&&e.complete())}))})}function Ac(){return Le(function(s,r){s.subscribe(Fe(r,Hn))})}function Vm(s){return Ue(function(){return s})}function Zw(s,r){return _e(function(e,t){return Ge(s(e,t)).pipe(hd(1),Vm(e))})}function Pl(s){return s===void 0&&(s=zm),Le(function(r,e){var t=!1;r.subscribe(Fe(e,function(i){t=!0,e.next(i)},function(){return t?e.complete():e.error(s())}))})}function zm(){return new ud}function Xc(s,r){var e=arguments.length>=2;return function(t){return t.pipe(s?Qn(function(i,a){return s(i,a,t)}):Gt,hd(1),e?Hh(r):Pl(function(){return new ud}))}}function Jm(s,r,e){return e===void 0&&(e=1/0),Le(function(t,i){var a=r;return Bh(t,i,function(o,c){return s(a,o,c)},e,function(o){a=o},!1,void 0,function(){return a=null})})}function Wt(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];return s.length?Le(function(e,t){Uh(Un([e],ds(s)))(t)}):Gt}function Ic(s){s===void 0&&(s=1/0);var r;s&&typeof s=="object"?r=s:r={count:s};var e=r.count,t=e===void 0?1/0:e,i=r.delay,a=r.resetOnSuccess,o=a===void 0?!1:a;return t<=0?Gt:Le(function(c,l){var u=0,f,w=function(){var h=!1;f=c.subscribe(Fe(l,function(g){o&&(u=0),l.next(g)},void 0,function(g){if(u++<t){var S=function(){f?(f.unsubscribe(),f=null,w()):h=!0};if(i!=null){var m=typeof i=="number"?dd(i):Ge(i(g,u)),v=Fe(l,function(){v.unsubscribe(),S()},function(){l.complete()});m.subscribe(v)}else S()}else l.error(g)})),h&&(f.unsubscribe(),f=null,w())};w()})}function Xm(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];var e=bc(s);return Le(function(t,i){(e?zl(s,t,e):zl(s,t)).subscribe(i)})}function Qm(s,r){return Le(function(e,t){var i=null,a=0,o=!1,c=function(){return o&&!i&&t.complete()};e.subscribe(Fe(t,function(l){i==null||i.unsubscribe();var u=0,f=a++;Ge(s(l,f)).subscribe(i=Fe(t,function(w){return t.next(r?r(l,w,f,u++):w)},function(){i=null,c()}))},function(){o=!0,c()}))})}function Ym(s){return Le(function(r,e){Ge(s).subscribe(Fe(e,function(){return e.complete()},Hn)),!e.closed&&r.subscribe(e)})}function kc(s,r,e){var t=ce(s)||r||e?{next:s,error:r,complete:e}:s;return t?Le(function(i,a){var o;(o=t.subscribe)===null||o===void 0||o.call(t);var c=!0;i.subscribe(Fe(a,function(l){var u;(u=t.next)===null||u===void 0||u.call(t,l),a.next(l)},function(){var l;c=!1,(l=t.complete)===null||l===void 0||l.call(t),a.complete()},function(l){var u;c=!1,(u=t.error)===null||u===void 0||u.call(t,l),a.error(l)},function(){var l,u;c&&((l=t.unsubscribe)===null||l===void 0||l.call(t)),(u=t.finalize)===null||u===void 0||u.call(t)}))}):Gt}function Zm(s){return{all:s=s||new Map,on:function(r,e){var t=s.get(r);t?t.push(e):s.set(r,[e])},off:function(r,e){var t=s.get(r);t&&(e?t.splice(t.indexOf(e)>>>0,1):s.set(r,[]))},emit:function(r,e){var t=s.get(r);t&&t.slice().map(function(i){i(e)}),(t=s.get("*"))&&t.slice().map(function(i){i(r,e)})}}}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */Symbol.dispose??(Symbol.dispose=Symbol("dispose"));Symbol.asyncDispose??(Symbol.asyncDispose=Symbol("asyncDispose"));const oe=Symbol.dispose,bt=Symbol.asyncDispose;var hh,fh,Sr,Jt;fh=oe,hh=Symbol.toStringTag;const bd=class bd{constructor(){d(this,Sr,!1);d(this,Jt,[]);F(this,fh,this.dispose);F(this,hh,"DisposableStack")}get disposed(){return n(this,Sr)}dispose(){if(!n(this,Sr)){p(this,Sr,!0);for(const r of n(this,Jt).reverse())r[oe]()}}use(r){return r&&n(this,Jt).push(r),r}adopt(r,e){return n(this,Jt).push({[oe](){e(r)}}),r}defer(r){n(this,Jt).push({[oe](){r()}})}move(){if(n(this,Sr))throw new ReferenceError("a disposed stack can not use anything new");const r=new bd;return p(r,Jt,n(this,Jt)),p(this,Sr,!0),r}};Sr=new WeakMap,Jt=new WeakMap;let qt=bd;var ph,mh,kr,Xt;mh=bt,ph=Symbol.toStringTag;const Sd=class Sd{constructor(){d(this,kr,!1);d(this,Xt,[]);F(this,mh,this.dispose);F(this,ph,"AsyncDisposableStack")}get disposed(){return n(this,kr)}async dispose(){if(!n(this,kr)){p(this,kr,!0);for(const r of n(this,Xt).reverse())await r[bt]()}}use(r){return r&&n(this,Xt).push(r),r}adopt(r,e){return n(this,Xt).push({[bt](){return e(r)}}),r}defer(r){n(this,Xt).push({[bt](){return r()}})}move(){if(n(this,kr))throw new ReferenceError("a disposed stack can not use anything new");const r=new Sd;return p(r,Xt,n(this,Xt)),p(this,kr,!0),r}};kr=new WeakMap,Xt=new WeakMap;let Qc=Sd;/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Qt,It;class pe{constructor(r=Zm(new Map)){d(this,Qt);d(this,It,new Map);p(this,Qt,r)}on(r,e){const t=n(this,It).get(r);return t===void 0?n(this,It).set(r,[e]):t.push(e),n(this,Qt).on(r,e),this}off(r,e){const t=n(this,It).get(r)??[];if(e===void 0){for(const a of t)n(this,Qt).off(r,a);return n(this,It).delete(r),this}const i=t.lastIndexOf(e);return i>-1&&n(this,Qt).off(r,...t.splice(i,1)),this}emit(r,e){return n(this,Qt).emit(r,e),this.listenerCount(r)>0}once(r,e){const t=i=>{e(i),this.off(r,t)};return this.on(r,t)}listenerCount(r){var e;return((e=n(this,It).get(r))==null?void 0:e.length)||0}removeAllListeners(r){return r!==void 0?this.off(r):(this[oe](),this)}[oe](){for(const[r,e]of n(this,It))for(const t of e)n(this,Qt).off(r,t);n(this,It).clear()}}Qt=new WeakMap,It=new WeakMap;/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const Gh=!!(typeof process<"u"&&process.version),ls={value:{get fs(){throw new Error("fs is not available in this environment")},get ScreenRecorder(){throw new Error("ScreenRecorder is not available in this environment")}}},eg="24.4.0";/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const x=(s,r)=>{if(!s)throw new Error(r)};/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */function Vh(s,r=!1){if(r){const e=atob(s);return Uint8Array.from(e,t=>t.codePointAt(0))}return new TextEncoder().encode(s)}function tg(s){return zh(new TextEncoder().encode(s))}function zh(s){const e=[];for(let i=0;i<s.length;i+=65534){const a=s.subarray(i,i+65534);e.push(String.fromCodePoint.apply(null,a))}const t=e.join("");return btoa(t)}function rg(s){let r=0;for(const i of s)r+=i.length;const e=new Uint8Array(r);let t=0;for(const i of s)e.set(i,t),t+=i.length;return e}const ig="modulepreload",sg=function(s){return"/"+s},Nd={},pa=function(r,e,t){let i=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(e.map(l=>{if(l=sg(l),l in Nd)return;Nd[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const w=document.createElement("link");if(w.rel=u?"stylesheet":ig,u||(w.as="script"),w.crossOrigin="",w.href=l,c&&w.setAttribute("nonce",c),document.head.appendChild(w),u)return new Promise((h,g)=>{w.addEventListener("load",h),w.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return r().catch(a)})};let Rl=null;async function ng(){return Rl||(Rl=(await pa(async()=>{const{default:s}=await import("debug");return{default:s}},[])).default),Rl}const fd=s=>Gh?async(...r)=>{(await ng())(s)(r)}:(...r)=>{const e=globalThis.__PUPPETEER_DEBUG;!e||!(e==="*"||(e.endsWith("*")?s.startsWith(e):s===e))||console.log(`${s}:`,...r)};/**
 * @license
 * Copyright 2018 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class _l extends Error{constructor(r,e){super(r,e),this.name=this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}}class pd extends _l{}class Xl extends _l{}var wa,va;class Gn extends _l{constructor(){super(...arguments);d(this,wa);d(this,va,"")}set code(e){p(this,wa,e)}get code(){return n(this,wa)}set originalMessage(e){p(this,va,e)}get originalMessage(){return n(this,va)}}wa=new WeakMap,va=new WeakMap;class md extends _l{}class ti extends Gn{}/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const ag={letter:{cm:{width:21.59,height:27.94},in:{width:8.5,height:11}},legal:{cm:{width:21.59,height:35.56},in:{width:8.5,height:14}},tabloid:{cm:{width:27.94,height:43.18},in:{width:11,height:17}},ledger:{cm:{width:43.18,height:27.94},in:{width:17,height:11}},a0:{cm:{width:84.1,height:118.9},in:{width:33.1102,height:46.811}},a1:{cm:{width:59.4,height:84.1},in:{width:23.3858,height:33.1102}},a2:{cm:{width:42,height:59.4},in:{width:16.5354,height:23.3858}},a3:{cm:{width:29.7,height:42},in:{width:11.6929,height:16.5354}},a4:{cm:{width:21,height:29.7},in:{width:8.2677,height:11.6929}},a5:{cm:{width:14.8,height:21},in:{width:5.8268,height:8.2677}},a6:{cm:{width:10.5,height:14.8},in:{width:4.1339,height:5.8268}}};/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const B=fd("puppeteer:error"),Jh=Object.freeze({width:800,height:600}),Yc=Symbol("Source URL for Puppeteer evaluation scripts");var hi,fi;const di=class di{constructor(){d(this,hi);d(this,fi)}static fromCallSite(r,e){const t=new di;return p(t,hi,r),p(t,fi,e.toString()),t}get functionName(){return n(this,hi)}get siteString(){return n(this,fi)}toString(){return`pptr:${[n(this,hi),encodeURIComponent(n(this,fi))].join(";")}`}};hi=new WeakMap,fi=new WeakMap,F(di,"INTERNAL_URL","pptr:internal"),F(di,"parse",r=>{r=r.slice(5);const[e="",t=""]=r.split(";"),i=new di;return p(i,hi,e),p(i,fi,decodeURIComponent(t)),i}),F(di,"isPuppeteerURL",r=>r.startsWith("pptr:"));let pr=di;const Ie=(s,r)=>{if(Object.prototype.hasOwnProperty.call(r,Yc))return r;const e=Error.prepareStackTrace;Error.prepareStackTrace=(i,a)=>a[2];const t=new Error().stack;return Error.prepareStackTrace=e,Object.assign(r,{[Yc]:pr.fromCallSite(s,t)})},og=s=>{if(Object.prototype.hasOwnProperty.call(s,Yc))return s[Yc]},gs=s=>typeof s=="string"||s instanceof String,cg=s=>typeof s=="number"||s instanceof Number,ev=s=>typeof s=="object"&&(s==null?void 0:s.constructor)===Object,tv=s=>typeof s=="object"&&(s==null?void 0:s.constructor)===RegExp,rv=s=>typeof s=="object"&&(s==null?void 0:s.constructor)===Date;function Xh(s,...r){if(gs(s))return x(r.length===0,"Cannot evaluate a string with arguments"),s;function e(t){return Object.is(t,void 0)?"undefined":JSON.stringify(t)}return`(${s})(${r.map(e).join(",")})`}async function Qh(s,r){const e=[],t=s.getReader();if(r){const i=await ls.value.fs.promises.open(r,"w+");try{for(;;){const{done:a,value:o}=await t.read();if(a)break;e.push(o),await i.writeFile(o)}}finally{await i.close()}}else for(;;){const{done:i,value:a}=await t.read();if(i)break;e.push(a)}try{const i=rg(e);return i.length===0?null:i}catch(i){return B(i),null}}async function Yh(s,r){return new ReadableStream({async pull(e){function t(c,l){return l?Uint8Array.from(atob(c),f=>f.codePointAt(0)):new TextEncoder().encode(c)}const{data:i,base64Encoded:a,eof:o}=await s.send("IO.read",{handle:r});e.enqueue(t(i,a??!1)),o&&(await s.send("IO.close",{handle:r}),e.close())}})}function lg(s){let r=null;return new Set(["alert","confirm","prompt","beforeunload"]).has(s)&&(r=s),x(r,`Unknown javascript dialog type: ${s}`),r}function Bt(s,r){return s===0?qh:dd(s).pipe(Ue(()=>{throw new pd(`Timed out after waiting ${s}ms`,{cause:r})}))}const Kd="__puppeteer_utility_world__"+eg,$d=/^[\x20\t]*\/\/[@#] sourceURL=\s{0,10}(\S*?)\s{0,10}$/m;function ug(s){return`//# sourceURL=${s}`}const dg=500;function hg(s={},r="in"){var o,c,l,u;const e={scale:1,displayHeaderFooter:!1,headerTemplate:"",footerTemplate:"",printBackground:!1,landscape:!1,pageRanges:"",preferCSSPageSize:!1,omitBackground:!1,outline:!1,tagged:!0,waitForFonts:!0};let t=8.5,i=11;if(s.format){const f=ag[s.format.toLowerCase()][r];x(f,"Unknown paper format: "+s.format),t=f.width,i=f.height}else t=ys(s.width,r)??t,i=ys(s.height,r)??i;const a={top:ys((o=s.margin)==null?void 0:o.top,r)||0,left:ys((c=s.margin)==null?void 0:c.left,r)||0,bottom:ys((l=s.margin)==null?void 0:l.bottom,r)||0,right:ys((u=s.margin)==null?void 0:u.right,r)||0};return s.outline&&(s.tagged=!0),{...e,...s,width:t,height:i,margin:a}}const Ll={px:1,in:96,cm:37.8,mm:3.78};function ys(s,r="in"){if(typeof s>"u")return;let e;if(cg(s))e=s;else if(gs(s)){const t=s;let i=t.substring(t.length-2).toLowerCase(),a="";i in Ll?a=t.substring(0,t.length-2):(i="px",a=t);const o=Number(a);x(!isNaN(o),"Failed to parse parameter value: "+t),e=o*Ll[i]}else throw new Error("page.pdf() Cannot handle parameter type: "+typeof s);return e/Ll[r]}function Se(s,r){return new ke(e=>{const t=i=>{e.next(i)};return s.on(r,t),()=>{s.off(r,t)}})}function bs(s,r){return s?Jl(s,"abort").pipe(Ue(()=>{throw s.reason instanceof Error?(s.reason.cause=r,s.reason):new Error(s.reason,{cause:r})})):qh}function oa(s){return _e(r=>se(Promise.resolve(s(r))).pipe(Qn(e=>e),Ue(()=>r)))}const fg=new Map([["accelerometer","sensors"],["ambient-light-sensor","sensors"],["background-sync","backgroundSync"],["camera","videoCapture"],["clipboard-read","clipboardReadWrite"],["clipboard-sanitized-write","clipboardSanitizedWrite"],["clipboard-write","clipboardReadWrite"],["geolocation","geolocation"],["gyroscope","sensors"],["idle-detection","idleDetection"],["keyboard-lock","keyboardLock"],["magnetometer","sensors"],["microphone","audioCapture"],["midi","midi"],["notifications","notifications"],["payment-handler","paymentHandler"],["persistent-storage","durableStorage"],["pointer-lock","pointerLock"],["midi-sysex","midiSysex"]]);class pg extends pe{constructor(){super()}async waitForTarget(r,e={}){const{timeout:t=3e4,signal:i}=e;return await Je(fa(Se(this,"targetcreated"),Se(this,"targetchanged"),se(this.targets())).pipe(oa(r),Wt(bs(i),Bt(t))))}async pages(){return(await Promise.all(this.browserContexts().map(e=>e.pages()))).reduce((e,t)=>e.concat(t),[])}async cookies(){return await this.defaultBrowserContext().cookies()}async setCookie(...r){return await this.defaultBrowserContext().setCookie(...r)}async deleteCookie(...r){return await this.defaultBrowserContext().deleteCookie(...r)}isConnected(){return this.connected}[oe](){return this.process()?void this.close().catch(B):void this.disconnect().catch(B)}[bt](){return this.process()?this.close():this.disconnect()}}/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Er,Tr,pi,ba,cl,_s,Sa,ka,Ql,Ms;const ll=class ll{constructor(r){d(this,ka);d(this,Er,!1);d(this,Tr,!1);d(this,pi);d(this,ba);d(this,cl,new Promise(r=>{p(this,ba,r)}));d(this,_s);d(this,Sa);d(this,Ms);r&&r.timeout>0&&(p(this,Sa,new pd(r.message)),p(this,_s,setTimeout(()=>{this.reject(n(this,Sa))},r.timeout)))}static create(r){return new ll(r)}static async race(r){const e=new Set;try{const t=r.map(i=>i instanceof ll?(n(i,_s)&&e.add(i),i.valueOrThrow()):i);return await Promise.race(t)}finally{for(const t of e)t.reject(new Error("Timeout cleared"))}}resolve(r){n(this,Tr)||n(this,Er)||(p(this,Er,!0),b(this,ka,Ql).call(this,r))}reject(r){n(this,Tr)||n(this,Er)||(p(this,Tr,!0),b(this,ka,Ql).call(this,r))}resolved(){return n(this,Er)}finished(){return n(this,Er)||n(this,Tr)}value(){return n(this,pi)}valueOrThrow(){return n(this,Ms)||p(this,Ms,(async()=>{if(await n(this,cl),n(this,Tr))throw n(this,pi);return n(this,pi)})()),n(this,Ms)}};Er=new WeakMap,Tr=new WeakMap,pi=new WeakMap,ba=new WeakMap,cl=new WeakMap,_s=new WeakMap,Sa=new WeakMap,ka=new WeakSet,Ql=function(r){clearTimeout(n(this,_s)),p(this,pi,r),n(this,ba).call(this)},Ms=new WeakMap;let ue=ll;/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Ea,Ta,gh,As,Ca;const da=class da{constructor(){d(this,As,!1);d(this,Ca,[])}async acquire(r){if(!n(this,As))return p(this,As,!0),new da.Guard(this);const e=ue.create();return n(this,Ca).push(e.resolve.bind(e)),await e.valueOrThrow(),new da.Guard(this,r)}release(){const r=n(this,Ca).shift();if(!r){p(this,As,!1);return}r()}};As=new WeakMap,Ca=new WeakMap,F(da,"Guard",(gh=class{constructor(e,t){d(this,Ea);d(this,Ta);p(this,Ea,e),p(this,Ta,t)}[oe](){var e;return(e=n(this,Ta))==null||e.call(this),n(this,Ea).release()}},Ea=new WeakMap,Ta=new WeakMap,gh));let ma=da;/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var mi,Is;class mg extends pe{constructor(){super();d(this,mi);d(this,Is,0)}startScreenshot(){const e=n(this,mi)||new ma;return p(this,mi,e),Zn(this,Is)._++,e.acquire(()=>{Zn(this,Is)._--,n(this,Is)===0&&p(this,mi,void 0)})}waitForScreenshotOperations(){var e;return(e=n(this,mi))==null?void 0:e.acquire()}async waitForTarget(e,t={}){const{timeout:i=3e4}=t;return await Je(fa(Se(this,"targetcreated"),Se(this,"targetchanged"),se(this.targets())).pipe(oa(e),Wt(Bt(i))))}async deleteCookie(...e){return await this.setCookie(...e.map(t=>({...t,expires:1})))}get closed(){return!this.browser().browserContexts().includes(this)}get id(){}[oe](){return void this.close().catch(B)}[bt](){return this.close()}}mi=new WeakMap,Is=new WeakMap;var fe;(function(s){s.Disconnected=Symbol("CDPSession.Disconnected"),s.Swapped=Symbol("CDPSession.Swapped"),s.Ready=Symbol("CDPSession.Ready"),s.SessionAttached="sessionattached",s.SessionDetached="sessiondetached"})(fe||(fe={}));class Yl extends pe{constructor(){super()}parentSession(){}}/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Pa,_a,Ma;class gg{constructor(r,e,t=""){d(this,Pa);d(this,_a);d(this,Ma);F(this,"handled",!1);p(this,Pa,r),p(this,_a,e),p(this,Ma,t)}type(){return n(this,Pa)}message(){return n(this,_a)}defaultValue(){return n(this,Ma)}async accept(r){x(!this.handled,"Cannot accept dialog which is already handled!"),this.handled=!0,await this.handle({accept:!0,text:r})}async dismiss(){x(!this.handled,"Cannot dismiss dialog which is already handled!"),this.handled=!0,await this.handle({accept:!1})}}Pa=new WeakMap,_a=new WeakMap,Ma=new WeakMap;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const Fc=Symbol("_isElementHandle");/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */function Ut(s){return typeof s=="object"&&s!==null&&"name"in s&&"message"in s}function Zh(s,r,e){return s.message=r,s.originalMessage=e??s.originalMessage,s}function ef(s){let r=s.error.message;return s.error&&typeof s.error=="object"&&"data"in s.error&&(r+=` ${s.error.data}`),r}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const Wd=new Map,yg=s=>{let r=Wd.get(s);return r||(r=new Function(`return ${s}`)(),Wd.set(s,r),r)};function ii(s){let r=s.toString();try{new Function(`(${r})`)}catch(e){if(e.message.includes("Refused to evaluate a string as JavaScript because 'unsafe-eval' is not an allowed source of script in the following Content Security Policy directive"))return r;let t="function ";r.startsWith("async ")&&(t=`async ${t}`,r=r.substring(6)),r=`${t}${r}`;try{new Function(`(${r})`)}catch{throw new Error("Passed function cannot be serialized!")}}return r}const ca=(s,r)=>{let e=ii(s);for(const[t,i]of Object.entries(r))e=e.replace(new RegExp(`PLACEHOLDER\\(\\s*(?:'${t}'|"${t}")\\s*\\)`,"g"),`(${i})`);return yg(e)};/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Dc=function(s,r,e){if(r!=null){if(typeof r!="object"&&typeof r!="function")throw new TypeError("Object expected.");var t,i;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");t=r[Symbol.asyncDispose]}if(t===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");t=r[Symbol.dispose],e&&(i=t)}if(typeof t!="function")throw new TypeError("Object not disposable.");i&&(t=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),s.stack.push({value:r,dispose:t,async:e})}else e&&s.stack.push({async:!0});return r},Zl=function(s){return function(r){function e(o){r.error=r.hasError?new s(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,i=0;function a(){for(;t=r.stack.pop();)try{if(!t.async&&i===1)return i=0,r.stack.push(t),Promise.resolve().then(a);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return i|=2,Promise.resolve(o).then(a,function(c){return e(c),a()})}else i|=1}catch(c){e(c)}if(i===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return a()}}(typeof SuppressedError=="function"?SuppressedError:function(s,r,e){var t=new Error(e);return t.name="SuppressedError",t.error=s,t.suppressed=r,t});const wg=20;async function*vg(s,r){const e={stack:[],error:void 0,hasError:!1};try{const i=await Dc(e,await s.evaluateHandle(async(c,l)=>{const u=[];for(;u.length<l;){const f=await c.next();if(f.done)break;u.push(f.value)}return u},r),!1).getProperties(),a=i.values();return Dc(e,new qt,!1).defer(()=>{for(const c of a){const l={stack:[],error:void 0,hasError:!1};try{Dc(l,c,!1)[oe]()}catch(u){l.error=u,l.hasError=!0}finally{Zl(l)}}}),yield*a,i.size===0}catch(t){e.error=t,e.hasError=!0}finally{Zl(e)}}async function*bg(s){let r=wg;for(;!(yield*vg(s,r));)r<<=1}async function*tf(s){const r={stack:[],error:void 0,hasError:!1};try{const e=Dc(r,await s.evaluateHandle(t=>async function*(){yield*t}()),!1);yield*bg(e)}catch(e){r.error=e,r.hasError=!0}finally{Zl(r)}}/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Aa;const ul=class ul{constructor(r){d(this,Aa);p(this,Aa,r)}async get(r){return await n(this,Aa).call(this,r)}};Aa=new WeakMap,F(ul,"create",r=>new ul(r));let St=ul;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Ec=function(s,r,e){if(r!=null){if(typeof r!="object"&&typeof r!="function")throw new TypeError("Object expected.");var t,i;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");t=r[Symbol.asyncDispose]}if(t===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");t=r[Symbol.dispose],e&&(i=t)}if(typeof t!="function")throw new TypeError("Object not disposable.");i&&(t=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),s.stack.push({value:r,dispose:t,async:e})}else e&&s.stack.push({async:!0});return r},Tc=function(s){return function(r){function e(o){r.error=r.hasError?new s(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,i=0;function a(){for(;t=r.stack.pop();)try{if(!t.async&&i===1)return i=0,r.stack.push(t),Promise.resolve().then(a);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return i|=2,Promise.resolve(o).then(a,function(c){return e(c),a()})}else i|=1}catch(c){e(c)}if(i===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return a()}}(typeof SuppressedError=="function"?SuppressedError:function(s,r,e){var t=new Error(e);return t.name="SuppressedError",t.error=s,t.suppressed=r,t});class mr{static get _querySelector(){if(this.querySelector)return this.querySelector;if(!this.querySelectorAll)throw new Error("Cannot create default `querySelector`.");return this.querySelector=ca(async(r,e,t)=>{const a=PLACEHOLDER("querySelectorAll")(r,e,t);for await(const o of a)return o;return null},{querySelectorAll:ii(this.querySelectorAll)})}static get _querySelectorAll(){if(this.querySelectorAll)return this.querySelectorAll;if(!this.querySelector)throw new Error("Cannot create default `querySelectorAll`.");return this.querySelectorAll=ca(async function*(r,e,t){const a=await PLACEHOLDER("querySelector")(r,e,t);a&&(yield a)},{querySelector:ii(this.querySelector)})}static async*queryAll(r,e){const t={stack:[],error:void 0,hasError:!1};try{const i=Ec(t,await r.evaluateHandle(this._querySelectorAll,e,St.create(a=>a.puppeteerUtil)),!1);yield*tf(i)}catch(i){t.error=i,t.hasError=!0}finally{Tc(t)}}static async queryOne(r,e){const t={stack:[],error:void 0,hasError:!1};try{const i=Ec(t,await r.evaluateHandle(this._querySelector,e,St.create(a=>a.puppeteerUtil)),!1);return Fc in i?i.move():null}catch(i){t.error=i,t.hasError=!0}finally{Tc(t)}}static async waitFor(r,e,t){const i={stack:[],error:void 0,hasError:!1};try{let a;const o=Ec(i,await(async()=>{if(!(Fc in r)){a=r;return}return a=r.frame,await a.isolatedRealm().adoptHandle(r)})(),!1),{visible:c=!1,hidden:l=!1,timeout:u,signal:f}=t,w=c||l?"raf":t.polling;try{const h={stack:[],error:void 0,hasError:!1};try{f==null||f.throwIfAborted();const g=Ec(h,await a.isolatedRealm().waitForFunction(async(S,m,v,T,D)=>{const M=await S.createFunction(m)(T??document,v,S);return S.checkVisibility(M,D)},{polling:w,root:o,timeout:u,signal:f},St.create(S=>S.puppeteerUtil),ii(this._querySelector),e,o,c?!0:l?!1:void 0),!1);if(f!=null&&f.aborted)throw f.reason;return Fc in g?await a.mainRealm().transferHandle(g):null}catch(g){h.error=g,h.hasError=!0}finally{Tc(h)}}catch(h){throw!Ut(h)||h.name==="AbortError"||(h.message=`Waiting for selector \`${e}\` failed: ${h.message}`),h}}catch(a){i.error=a,i.hasError=!0}finally{Tc(i)}}}F(mr,"querySelectorAll"),F(mr,"querySelector");class Ml{static async*map(r,e){for await(const t of r)yield await e(t)}static async*flatMap(r,e){for await(const t of r)yield*e(t)}static async collect(r){const e=[];for await(const t of r)e.push(t);return e}static async first(r){for await(const e of r)return e}}/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const Sg=s=>["name","role"].includes(s),kg=/\[\s*(?<attribute>\w+)\s*=\s*(?<quote>"|')(?<value>\\.|.*?(?=\k<quote>))\k<quote>\s*\]/g,Eg=s=>{if(s.length>1e4)throw new Error(`Selector ${s} is too long`);const r={},e=s.replace(kg,(t,i,a,o)=>(x(Sg(i),`Unknown aria attribute "${i}" in selector`),r[i]=o,""));return e&&!r.name&&(r.name=e),r},ha=class ha extends mr{static async*queryAll(r,e){const{name:t,role:i}=Eg(e);yield*r.queryAXTree(t,i)}};F(ha,"querySelector",async(r,e,{ariaQuerySelector:t})=>await t(r,e)),F(ha,"queryOne",async(r,e)=>await Ml.first(ha.queryAll(r,e))??null);let ga=ha;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Zc extends mr{}F(Zc,"querySelector",(r,e,{cssQuerySelector:t})=>t(r,e)),F(Zc,"querySelectorAll",(r,e,{cssQuerySelectorAll:t})=>t(r,e));const Tg='"use strict";var g=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var Y=Object.prototype.hasOwnProperty;var l=(t,e)=>{for(var r in e)g(t,r,{get:e[r],enumerable:!0})},J=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of B(e))!Y.call(t,n)&&n!==r&&g(t,n,{get:()=>e[n],enumerable:!(o=X(e,n))||o.enumerable});return t};var z=t=>J(g({},"__esModule",{value:!0}),t);var pe={};l(pe,{default:()=>he});module.exports=z(pe);var N=class extends Error{constructor(e,r){super(e,r),this.name=this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}},p=class extends N{};var c=class t{static create(e){return new t(e)}static async race(e){let r=new Set;try{let o=e.map(n=>n instanceof t?(n.#n&&r.add(n),n.valueOrThrow()):n);return await Promise.race(o)}finally{for(let o of r)o.reject(new Error("Timeout cleared"))}}#e=!1;#r=!1;#o;#t;#a=new Promise(e=>{this.#t=e});#n;#i;constructor(e){e&&e.timeout>0&&(this.#i=new p(e.message),this.#n=setTimeout(()=>{this.reject(this.#i)},e.timeout))}#l(e){clearTimeout(this.#n),this.#o=e,this.#t()}resolve(e){this.#r||this.#e||(this.#e=!0,this.#l(e))}reject(e){this.#r||this.#e||(this.#r=!0,this.#l(e))}resolved(){return this.#e}finished(){return this.#e||this.#r}value(){return this.#o}#s;valueOrThrow(){return this.#s||(this.#s=(async()=>{if(await this.#a,this.#r)throw this.#o;return this.#o})()),this.#s}};var L=new Map,F=t=>{let e=L.get(t);return e||(e=new Function(`return ${t}`)(),L.set(t,e),e)};var x={};l(x,{ariaQuerySelector:()=>G,ariaQuerySelectorAll:()=>b});var G=(t,e)=>globalThis.__ariaQuerySelector(t,e),b=async function*(t,e){yield*await globalThis.__ariaQuerySelectorAll(t,e)};var E={};l(E,{cssQuerySelector:()=>K,cssQuerySelectorAll:()=>Z});var K=(t,e)=>t.querySelector(e),Z=function(t,e){return t.querySelectorAll(e)};var A={};l(A,{customQuerySelectors:()=>P});var v=class{#e=new Map;register(e,r){if(!r.queryOne&&r.queryAll){let o=r.queryAll;r.queryOne=(n,i)=>{for(let s of o(n,i))return s;return null}}else if(r.queryOne&&!r.queryAll){let o=r.queryOne;r.queryAll=(n,i)=>{let s=o(n,i);return s?[s]:[]}}else if(!r.queryOne||!r.queryAll)throw new Error("At least one query method must be defined.");this.#e.set(e,{querySelector:r.queryOne,querySelectorAll:r.queryAll})}unregister(e){this.#e.delete(e)}get(e){return this.#e.get(e)}clear(){this.#e.clear()}},P=new v;var R={};l(R,{pierceQuerySelector:()=>ee,pierceQuerySelectorAll:()=>te});var ee=(t,e)=>{let r=null,o=n=>{let i=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT);do{let s=i.currentNode;s.shadowRoot&&o(s.shadowRoot),!(s instanceof ShadowRoot)&&s!==n&&!r&&s.matches(e)&&(r=s)}while(!r&&i.nextNode())};return t instanceof Document&&(t=t.documentElement),o(t),r},te=(t,e)=>{let r=[],o=n=>{let i=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT);do{let s=i.currentNode;s.shadowRoot&&o(s.shadowRoot),!(s instanceof ShadowRoot)&&s!==n&&s.matches(e)&&r.push(s)}while(i.nextNode())};return t instanceof Document&&(t=t.documentElement),o(t),r};var u=(t,e)=>{if(!t)throw new Error(e)};var y=class{#e;#r;#o;#t;constructor(e,r){this.#e=e,this.#r=r}async start(){let e=this.#t=c.create(),r=await this.#e();if(r){e.resolve(r);return}this.#o=new MutationObserver(async()=>{let o=await this.#e();o&&(e.resolve(o),await this.stop())}),this.#o.observe(this.#r,{childList:!0,subtree:!0,attributes:!0})}async stop(){u(this.#t,"Polling never started."),this.#t.finished()||this.#t.reject(new Error("Polling stopped")),this.#o&&(this.#o.disconnect(),this.#o=void 0)}result(){return u(this.#t,"Polling never started."),this.#t.valueOrThrow()}},w=class{#e;#r;constructor(e){this.#e=e}async start(){let e=this.#r=c.create(),r=await this.#e();if(r){e.resolve(r);return}let o=async()=>{if(e.finished())return;let n=await this.#e();if(!n){window.requestAnimationFrame(o);return}e.resolve(n),await this.stop()};window.requestAnimationFrame(o)}async stop(){u(this.#r,"Polling never started."),this.#r.finished()||this.#r.reject(new Error("Polling stopped"))}result(){return u(this.#r,"Polling never started."),this.#r.valueOrThrow()}},S=class{#e;#r;#o;#t;constructor(e,r){this.#e=e,this.#r=r}async start(){let e=this.#t=c.create(),r=await this.#e();if(r){e.resolve(r);return}this.#o=setInterval(async()=>{let o=await this.#e();o&&(e.resolve(o),await this.stop())},this.#r)}async stop(){u(this.#t,"Polling never started."),this.#t.finished()||this.#t.reject(new Error("Polling stopped")),this.#o&&(clearInterval(this.#o),this.#o=void 0)}result(){return u(this.#t,"Polling never started."),this.#t.valueOrThrow()}};var _={};l(_,{PCombinator:()=>H,pQuerySelector:()=>fe,pQuerySelectorAll:()=>$});var a=class{static async*map(e,r){for await(let o of e)yield await r(o)}static async*flatMap(e,r){for await(let o of e)yield*r(o)}static async collect(e){let r=[];for await(let o of e)r.push(o);return r}static async first(e){for await(let r of e)return r}};var C={};l(C,{textQuerySelectorAll:()=>m});var re=new Set(["checkbox","image","radio"]),oe=t=>t instanceof HTMLSelectElement||t instanceof HTMLTextAreaElement||t instanceof HTMLInputElement&&!re.has(t.type),ne=new Set(["SCRIPT","STYLE"]),f=t=>!ne.has(t.nodeName)&&!document.head?.contains(t),I=new WeakMap,j=t=>{for(;t;)I.delete(t),t instanceof ShadowRoot?t=t.host:t=t.parentNode},W=new WeakSet,se=new MutationObserver(t=>{for(let e of t)j(e.target)}),d=t=>{let e=I.get(t);if(e||(e={full:"",immediate:[]},!f(t)))return e;let r="";if(oe(t))e.full=t.value,e.immediate.push(t.value),t.addEventListener("input",o=>{j(o.target)},{once:!0,capture:!0});else{for(let o=t.firstChild;o;o=o.nextSibling){if(o.nodeType===Node.TEXT_NODE){e.full+=o.nodeValue??"",r+=o.nodeValue??"";continue}r&&e.immediate.push(r),r="",o.nodeType===Node.ELEMENT_NODE&&(e.full+=d(o).full)}r&&e.immediate.push(r),t instanceof Element&&t.shadowRoot&&(e.full+=d(t.shadowRoot).full),W.has(t)||(se.observe(t,{childList:!0,characterData:!0,subtree:!0}),W.add(t))}return I.set(t,e),e};var m=function*(t,e){let r=!1;for(let o of t.childNodes)if(o instanceof Element&&f(o)){let n;o.shadowRoot?n=m(o.shadowRoot,e):n=m(o,e);for(let i of n)yield i,r=!0}r||t instanceof Element&&f(t)&&d(t).full.includes(e)&&(yield t)};var k={};l(k,{checkVisibility:()=>le,pierce:()=>T,pierceAll:()=>O});var ie=["hidden","collapse"],le=(t,e)=>{if(!t)return e===!1;if(e===void 0)return t;let r=t.nodeType===Node.TEXT_NODE?t.parentElement:t,o=window.getComputedStyle(r),n=o&&!ie.includes(o.visibility)&&!ae(r);return e===n?t:!1};function ae(t){let e=t.getBoundingClientRect();return e.width===0||e.height===0}var ce=t=>"shadowRoot"in t&&t.shadowRoot instanceof ShadowRoot;function*T(t){ce(t)?yield t.shadowRoot:yield t}function*O(t){t=T(t).next().value,yield t;let e=[document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT)];for(let r of e){let o;for(;o=r.nextNode();)o.shadowRoot&&(yield o.shadowRoot,e.push(document.createTreeWalker(o.shadowRoot,NodeFilter.SHOW_ELEMENT)))}}var Q={};l(Q,{xpathQuerySelectorAll:()=>q});var q=function*(t,e,r=-1){let n=(t.ownerDocument||document).evaluate(e,t,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE),i=[],s;for(;(s=n.iterateNext())&&(i.push(s),!(r&&i.length===r)););for(let h=0;h<i.length;h++)s=i[h],yield s,delete i[h]};var ue=/[-\\w\\P{ASCII}*]/u,H=(r=>(r.Descendent=">>>",r.Child=">>>>",r))(H||{}),V=t=>"querySelectorAll"in t,M=class{#e;#r=[];#o=void 0;elements;constructor(e,r){this.elements=[e],this.#e=r,this.#t()}async run(){if(typeof this.#o=="string")switch(this.#o.trimStart()){case":scope":this.#t();break}for(;this.#o!==void 0;this.#t()){let e=this.#o;typeof e=="string"?e[0]&&ue.test(e[0])?this.elements=a.flatMap(this.elements,async function*(r){V(r)&&(yield*r.querySelectorAll(e))}):this.elements=a.flatMap(this.elements,async function*(r){if(!r.parentElement){if(!V(r))return;yield*r.querySelectorAll(e);return}let o=0;for(let n of r.parentElement.children)if(++o,n===r)break;yield*r.parentElement.querySelectorAll(`:scope>:nth-child(${o})${e}`)}):this.elements=a.flatMap(this.elements,async function*(r){switch(e.name){case"text":yield*m(r,e.value);break;case"xpath":yield*q(r,e.value);break;case"aria":yield*b(r,e.value);break;default:let o=P.get(e.name);if(!o)throw new Error(`Unknown selector type: ${e.name}`);yield*o.querySelectorAll(r,e.value)}})}}#t(){if(this.#r.length!==0){this.#o=this.#r.shift();return}if(this.#e.length===0){this.#o=void 0;return}let e=this.#e.shift();switch(e){case">>>>":{this.elements=a.flatMap(this.elements,T),this.#t();break}case">>>":{this.elements=a.flatMap(this.elements,O),this.#t();break}default:this.#r=e,this.#t();break}}},D=class{#e=new WeakMap;calculate(e,r=[]){if(e===null)return r;e instanceof ShadowRoot&&(e=e.host);let o=this.#e.get(e);if(o)return[...o,...r];let n=0;for(let s=e.previousSibling;s;s=s.previousSibling)++n;let i=this.calculate(e.parentNode,[n]);return this.#e.set(e,i),[...i,...r]}},U=(t,e)=>{if(t.length+e.length===0)return 0;let[r=-1,...o]=t,[n=-1,...i]=e;return r===n?U(o,i):r<n?-1:1},de=async function*(t){let e=new Set;for await(let o of t)e.add(o);let r=new D;yield*[...e.values()].map(o=>[o,r.calculate(o)]).sort(([,o],[,n])=>U(o,n)).map(([o])=>o)},$=function(t,e){let r=JSON.parse(e);if(r.some(o=>{let n=0;return o.some(i=>(typeof i=="string"?++n:n=0,n>1))}))throw new Error("Multiple deep combinators found in sequence.");return de(a.flatMap(r,o=>{let n=new M(t,o);return n.run(),n.elements}))},fe=async function(t,e){for await(let r of $(t,e))return r;return null};var me=Object.freeze({...x,...A,...R,..._,...C,...k,...Q,...E,Deferred:c,createFunction:F,createTextContent:d,IntervalPoller:S,isSuitableNodeForTextMatching:f,MutationPoller:y,RAFPoller:w}),he=me;\n';/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Fs,Ds,ps,eu,rf;class Cg{constructor(){d(this,ps);d(this,Fs,!1);d(this,Ds,new Set)}append(r){b(this,ps,eu).call(this,()=>{n(this,Ds).add(r)})}pop(r){b(this,ps,eu).call(this,()=>{n(this,Ds).delete(r)})}inject(r,e=!1){(n(this,Fs)||e)&&r(b(this,ps,rf).call(this)),p(this,Fs,!1)}}Fs=new WeakMap,Ds=new WeakMap,ps=new WeakSet,eu=function(r){r(),p(this,Fs,!0)},rf=function(){return`(() => {
      const module = {};
      ${Tg}
      ${[...n(this,Ds)].map(r=>`(${r})(module.exports.default);`).join("")}
      return module.exports.default;
    })()`};const Oc=new Cg;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var ft;class Pg{constructor(){d(this,ft,new Map)}get(r){const e=n(this,ft).get(r);return e?e[1]:void 0}register(r,e){var a;x(!n(this,ft).has(r),`Cannot register over existing handler: ${r}`),x(/^[a-zA-Z]+$/.test(r),"Custom query handler names may only contain [a-zA-Z]"),x(e.queryAll||e.queryOne,"At least one query method must be implemented.");const t=(a=class extends mr{},F(a,"querySelectorAll",ca((o,c,l)=>l.customQuerySelectors.get(PLACEHOLDER("name")).querySelectorAll(o,c),{name:JSON.stringify(r)})),F(a,"querySelector",ca((o,c,l)=>l.customQuerySelectors.get(PLACEHOLDER("name")).querySelector(o,c),{name:JSON.stringify(r)})),a),i=ca(o=>{o.customQuerySelectors.register(PLACEHOLDER("name"),{queryAll:PLACEHOLDER("queryAll"),queryOne:PLACEHOLDER("queryOne")})},{name:JSON.stringify(r),queryAll:e.queryAll?ii(e.queryAll):String(void 0),queryOne:e.queryOne?ii(e.queryOne):String(void 0)}).toString();n(this,ft).set(r,[i,t]),Oc.append(i)}unregister(r){const e=n(this,ft).get(r);if(!e)throw new Error(`Cannot unregister unknown handler: ${r}`);Oc.pop(e[0]),n(this,ft).delete(r)}names(){return[...n(this,ft).keys()]}clear(){for(const[r]of n(this,ft))Oc.pop(r);n(this,ft).clear()}}ft=new WeakMap;const tu=new Pg;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class ru extends mr{}F(ru,"querySelector",(r,e,{pierceQuerySelector:t})=>t(r,e)),F(ru,"querySelectorAll",(r,e,{pierceQuerySelectorAll:t})=>t(r,e));/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class iu extends mr{}F(iu,"querySelectorAll",(r,e,{pQuerySelectorAll:t})=>t(r,e)),F(iu,"querySelector",(r,e,{pQuerySelector:t})=>t(r,e));var Vn={attribute:/\[\s*(?:(?<namespace>\*|[-\w\P{ASCII}]*)\|)?(?<name>[-\w\P{ASCII}]+)\s*(?:(?<operator>\W?=)\s*(?<value>.+?)\s*(\s(?<caseSensitive>[iIsS]))?\s*)?\]/gu,id:/#(?<name>[-\w\P{ASCII}]+)/gu,class:/\.(?<name>[-\w\P{ASCII}]+)/gu,comma:/\s*,\s*/g,combinator:/\s*[\s>+~]\s*/g,"pseudo-element":/::(?<name>[-\w\P{ASCII}]+)(?:\((?<argument>*)\))?/gu,"pseudo-class":/:(?<name>[-\w\P{ASCII}]+)(?:\((?<argument>*)\))?/gu,universal:/(?:(?<namespace>\*|[-\w\P{ASCII}]*)\|)?\*/gu,type:/(?:(?<namespace>\*|[-\w\P{ASCII}]*)\|)?(?<name>[-\w\P{ASCII}]+)/gu},_g=new Set(["combinator","comma"]),Mg=s=>{switch(s){case"pseudo-element":case"pseudo-class":return new RegExp(Vn[s].source.replace("(?<argument>*)","(?<argument>.*)"),"gu");default:return Vn[s]}};function Ag(s,r){let e=0,t="";for(;r<s.length;r++){const i=s[r];switch(i){case"(":++e;break;case")":--e;break}if(t+=i,e===0)return t}return t}function Ig(s,r=Vn){if(!s)return[];const e=[s];for(const[i,a]of Object.entries(r))for(let o=0;o<e.length;o++){const c=e[o];if(typeof c!="string")continue;a.lastIndex=0;const l=a.exec(c);if(!l)continue;const u=l.index-1,f=[],w=l[0],h=c.slice(0,u+1);h&&f.push(h),f.push({...l.groups,type:i,content:w});const g=c.slice(u+w.length+1);g&&f.push(g),e.splice(o,1,...f)}let t=0;for(const i of e)switch(typeof i){case"string":throw new Error(`Unexpected sequence ${i} found at index ${t}`);case"object":t+=i.content.length,i.pos=[t-i.content.length,t],_g.has(i.type)&&(i.content=i.content.trim()||" ");break}return e}var Fg=/(['"])([^\\\n]+?)\1/g,Dg=/\\./g;function Og(s,r=Vn){if(s=s.trim(),s==="")return[];const e=[];s=s.replace(Dg,(a,o)=>(e.push({value:a,offset:o}),"".repeat(a.length))),s=s.replace(Fg,(a,o,c,l)=>(e.push({value:a,offset:l}),`${o}${"".repeat(c.length)}${o}`));{let a=0,o;for(;(o=s.indexOf("(",a))>-1;){const c=Ag(s,o);e.push({value:c,offset:o}),s=`${s.substring(0,o)}(${"".repeat(c.length-2)})${s.substring(o+c.length)}`,a=o+c.length}}const t=Ig(s,r),i=new Set;for(const a of e.reverse())for(const o of t){const{offset:c,value:l}=a;if(!(o.pos[0]<=c&&c+l.length<=o.pos[1]))continue;const{content:u}=o,f=c-o.pos[0];o.content=u.slice(0,f)+l+u.slice(f+l.length),o.content!==u&&i.add(o)}for(const a of i){const o=Mg(a.type);if(!o)throw new Error(`Unknown token type: ${a.type}`);o.lastIndex=0;const c=o.exec(a.content);if(!c)throw new Error(`Unable to parse content for ${a.type}: ${a.content}`);Object.assign(a,c.groups)}return t}function $t(s){if(Array.isArray(s))return s.map(r=>r.content).join("");switch(s.type){case"list":return s.list.map($t).join(",");case"relative":return s.combinator+$t(s.right);case"complex":return $t(s.left)+s.combinator+$t(s.right);case"compound":return s.list.map($t).join("");default:return s.content}}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */Vn.nesting=/&/g;Vn.combinator=/\s*(>>>>?|[\s>+~])\s*/g;const xg=/\\[\s\S]/g,Rg=s=>s.length<=1?s:((s[0]==='"'||s[0]==="'")&&s.endsWith(s[0])&&(s=s.slice(1,-1)),s.replace(xg,r=>r[1]));function Lg(s){let r=!0,e=!1,t=!1;const i=Og(s);if(i.length===0)return[[],r,t,!1];let a=[],o=[a];const c=[o],l=[];for(const u of i){switch(u.type){case"combinator":switch(u.content){case">>>":r=!1,l.length&&(a.push($t(l)),l.splice(0)),a=[],o.push(">>>"),o.push(a);continue;case">>>>":r=!1,l.length&&(a.push($t(l)),l.splice(0)),a=[],o.push(">>>>"),o.push(a);continue}break;case"pseudo-element":if(!u.name.startsWith("-p-"))break;r=!1,l.length&&(a.push($t(l)),l.splice(0));const f=u.name.slice(3);f==="aria"&&(e=!0),a.push({name:f,value:Rg(u.argument??"")});continue;case"pseudo-class":t=!0;break;case"comma":l.length&&(a.push($t(l)),l.splice(0)),a=[],o=[a],c.push(o);continue}l.push(u)}return l.length&&a.push($t(l)),[c,r,t,e]}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class sf extends mr{}F(sf,"querySelectorAll",(r,e,{textQuerySelectorAll:t})=>t(r,e));/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class su extends mr{}F(su,"querySelectorAll",(r,e,{xpathQuerySelectorAll:t})=>t(r,e)),F(su,"querySelector",(r,e,{xpathQuerySelectorAll:t})=>{for(const i of t(r,e,1))return i;return null});/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const Ng={aria:ga,pierce:ru,xpath:su,text:sf},Kg=["=","/"];function xc(s){for(const r of[tu.names().map(e=>[e,tu.get(e)]),Object.entries(Ng)])for(const[e,t]of r)for(const i of Kg){const a=`${e}${i}`;if(s.startsWith(a))return s=s.slice(a.length),{updatedSelector:s,polling:e==="aria"?"raf":"mutation",QueryHandler:t}}try{const[r,e,t,i]=Lg(s);return e?{updatedSelector:s,polling:t?"raf":"mutation",QueryHandler:Zc}:{updatedSelector:JSON.stringify(r),polling:i?"raf":"mutation",QueryHandler:iu}}catch{return{updatedSelector:s,polling:"mutation",QueryHandler:Zc}}}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var $g=function(s,r,e){if(r!=null){if(typeof r!="object"&&typeof r!="function")throw new TypeError("Object expected.");var t,i;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");t=r[Symbol.asyncDispose]}if(t===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");t=r[Symbol.dispose],e&&(i=t)}if(typeof t!="function")throw new TypeError("Object not disposable.");i&&(t=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),s.stack.push({value:r,dispose:t,async:e})}else e&&s.stack.push({async:!0});return r},Wg=function(s){return function(r){function e(o){r.error=r.hasError?new s(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,i=0;function a(){for(;t=r.stack.pop();)try{if(!t.async&&i===1)return i=0,r.stack.push(t),Promise.resolve().then(a);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return i|=2,Promise.resolve(o).then(a,function(c){return e(c),a()})}else i|=1}catch(c){e(c)}if(i===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return a()}}(typeof SuppressedError=="function"?SuppressedError:function(s,r,e){var t=new Error(e);return t.name="SuppressedError",t.error=s,t.suppressed=r,t});const ea=new WeakSet;function Bg(s,r){let e=!1;if(s.prototype[oe]){const t=s.prototype[oe];s.prototype[oe]=function(){if(ea.has(this)){ea.delete(this);return}return t.call(this)},e=!0}if(s.prototype[bt]){const t=s.prototype[bt];s.prototype[bt]=function(){if(ea.has(this)){ea.delete(this);return}return t.call(this)},e=!0}return e&&(s.prototype.move=function(){return ea.add(this),this}),s}function Q(s=r=>`Attempted to use disposed ${r.constructor.name}.`){return(r,e)=>function(...t){if(this.disposed)throw new Error(s(this));return r.call(this,...t)}}function sv(s,r){return function(...e){if(!this.disposed)return s.call(this,...e)}}function Tt(s,r){const e=new WeakMap;let t=-1;return function(...i){if(t===-1&&(t=i.length),t!==i.length)throw new Error("Memoized method was called with the wrong number of arguments");let a=!1,o=e;for(const c of i)o.has(c)||(a=!0,o.set(c,new WeakMap)),o=o.get(c);if(a)return s.call(this,...i)}}function jg(s=function(){return this}){return(r,e)=>{const t=new WeakMap;return async function(...i){const a={stack:[],error:void 0,hasError:!1};try{const o=s.call(this);let c=t.get(o);c||(c=new ma,t.set(o,c));const l=$g(a,await c.acquire(),!0);return await r.call(this,...i)}catch(o){a.error=o,a.hasError=!0}finally{const o=Wg(a);o&&await o}}}}const el=new WeakMap,Bd=function(s){const r=el.get(this)??new Map;if(r.has(s))return;const e=s!==void 0?(t,i)=>{s.includes(t)&&this.emit(t,i)}:(t,i)=>{this.emit(t,i)};r.set(s,e),el.set(this,r)};function nv(s){return({set:r,get:e},t)=>(t.addInitializer(function(){return Bd.apply(this,[s])}),{set(i){const a=el.get(this).get(s),o=e.call(this);o!==void 0&&o.off("*",a),i!==void 0&&(i.on("*",a),r.call(this,i))},init(i){if(i===void 0)return i;Bd.apply(this,[s]);const a=el.get(this).get(s);return i.on("*",a),i}})}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var jd=function(s,r,e){for(var t=arguments.length>2,i=0;i<r.length;i++)e=t?r[i].call(s,e):r[i].call(s);return t?e:void 0},Nl=function(s,r,e,t,i,a){function o(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var c=t.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!r&&s?t.static?s:s.prototype:null,f=r||(u?Object.getOwnPropertyDescriptor(u,t.name):{}),w,h=!1,g=e.length-1;g>=0;g--){var S={};for(var m in t)S[m]=m==="access"?{}:t[m];for(var m in t.access)S.access[m]=t.access[m];S.addInitializer=function(T){if(h)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(T||null))};var v=(0,e[g])(c==="accessor"?{get:f.get,set:f.set}:f[l],S);if(c==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(w=o(v.get))&&(f.get=w),(w=o(v.set))&&(f.set=w),(w=o(v.init))&&i.unshift(w)}else(w=o(v))&&(c==="field"?i.unshift(w):f[l]=w)}u&&Object.defineProperty(u,t.name,f),h=!0},qg=function(s,r,e){if(r!=null){if(typeof r!="object"&&typeof r!="function")throw new TypeError("Object expected.");var t,i;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");t=r[Symbol.asyncDispose]}if(t===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");t=r[Symbol.dispose],e&&(i=t)}if(typeof t!="function")throw new TypeError("Object not disposable.");i&&(t=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),s.stack.push({value:r,dispose:t,async:e})}else e&&s.stack.push({async:!0});return r},Ug=function(s){return function(r){function e(o){r.error=r.hasError?new s(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,i=0;function a(){for(;t=r.stack.pop();)try{if(!t.async&&i===1)return i=0,r.stack.push(t),Promise.resolve().then(a);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return i|=2,Promise.resolve(o).then(a,function(c){return e(c),a()})}else i|=1}catch(c){e(c)}if(i===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return a()}}(typeof SuppressedError=="function"?SuppressedError:function(s,r,e){var t=new Error(e);return t.name="SuppressedError",t.error=s,t.suppressed=r,t});let Cs=(()=>{var c;let s=[Bg],r,e=[],t,i=[],a,o;return c=class{constructor(){jd(this,i)}async evaluate(u,...f){return u=Ie(this.evaluate.name,u),await this.realm.evaluate(u,this,...f)}async evaluateHandle(u,...f){return u=Ie(this.evaluateHandle.name,u),await this.realm.evaluateHandle(u,this,...f)}async getProperty(u){return await this.evaluateHandle((f,w)=>f[w],u)}async getProperties(){const u=await this.evaluate(h=>{var m;const g=[],S=Object.getOwnPropertyDescriptors(h);for(const v in S)(m=S[v])!=null&&m.enumerable&&g.push(v);return g}),f=new Map,w=await Promise.all(u.map(h=>this.getProperty(h)));for(const[h,g]of Object.entries(u)){const S={stack:[],error:void 0,hasError:!1};try{const m=qg(S,w[h],!1);m&&f.set(g,m.move())}catch(m){S.error=m,S.hasError=!0}finally{Ug(S)}}return f}[(a=[Q()],o=[Q()],oe)](){return void this.dispose().catch(B)}[bt](){return this.dispose()}},t=c,(()=>{const u=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;Nl(c,null,a,{kind:"method",name:"getProperty",static:!1,private:!1,access:{has:f=>"getProperty"in f,get:f=>f.getProperty},metadata:u},null,i),Nl(c,null,o,{kind:"method",name:"getProperties",static:!1,private:!1,access:{has:f=>"getProperties"in f,get:f=>f.getProperties},metadata:u},null,i),Nl(null,r={value:t},s,{kind:"class",name:t.name,metadata:u},null,e),t=r.value,u&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:u}),jd(t,e)})(),t})();/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Hg=function(s,r,e){for(var t=arguments.length>2,i=0;i<r.length;i++)e=t?r[i].call(s,e):r[i].call(s);return t?e:void 0},ie=function(s,r,e,t,i,a){function o(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var c=t.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!r&&s?t.static?s:s.prototype:null,f=r||(u?Object.getOwnPropertyDescriptor(u,t.name):{}),w,h=!1,g=e.length-1;g>=0;g--){var S={};for(var m in t)S[m]=m==="access"?{}:t[m];for(var m in t.access)S.access[m]=t.access[m];S.addInitializer=function(T){if(h)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(T||null))};var v=(0,e[g])(c==="accessor"?{get:f.get,set:f.set}:f[l],S);if(c==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(w=o(v.get))&&(f.get=w),(w=o(v.set))&&(f.set=w),(w=o(v.init))&&i.unshift(w)}else(w=o(v))&&(c==="field"?i.unshift(w):f[l]=w)}u&&Object.defineProperty(u,t.name,f),h=!0},ta=function(s,r,e){if(r!=null){if(typeof r!="object"&&typeof r!="function")throw new TypeError("Object expected.");var t,i;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");t=r[Symbol.asyncDispose]}if(t===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");t=r[Symbol.dispose],e&&(i=t)}if(typeof t!="function")throw new TypeError("Object not disposable.");i&&(t=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),s.stack.push({value:r,dispose:t,async:e})}else e&&s.stack.push({async:!0});return r},ra=function(s){return function(r){function e(o){r.error=r.hasError?new s(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,i=0;function a(){for(;t=r.stack.pop();)try{if(!t.async&&i===1)return i=0,r.stack.push(t),Promise.resolve().then(a);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return i|=2,Promise.resolve(o).then(a,function(c){return e(c),a()})}else i|=1}catch(c){e(c)}if(i===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return a()}}(typeof SuppressedError=="function"?SuppressedError:function(s,r,e){var t=new Error(e);return t.name="SuppressedError",t.error=s,t.suppressed=r,t}),Gg=function(s,r,e){return typeof r=="symbol"&&(r=r.description?"[".concat(r.description,"]"):""),Object.defineProperty(s,"name",{configurable:!0,value:e?"".concat(e," ",r):r})};function re(s,r){return async function(...e){if(this.realm===this.frame.isolatedRealm())return await s.call(this,...e);let t;this.isolatedHandle?t=this.isolatedHandle:this.isolatedHandle=t=await this.frame.isolatedRealm().adoptHandle(this);const i=await s.call(t,...e);return i===t?this:i instanceof Cs?await this.realm.transferHandle(i):(Array.isArray(i)&&await Promise.all(i.map(async(a,o,c)=>{a instanceof Cs&&(c[o]=await this.realm.transferHandle(a))})),i instanceof Map&&await Promise.all([...i.entries()].map(async([a,o])=>{o instanceof Cs&&i.set(a,await this.realm.transferHandle(o))})),i)}}let Vg=(()=>{var q,nu,au,ou,nf,cu,lu,af,of,cf,J;let s=Cs,r=[],e,t,i,a,o,c,l,u,f,w,h,g,S,m,v,T,D,P,M,U,H,N,G,L,V,De,A,k,K,$,te,ge;return J=class extends s{constructor(E){super();d(this,q);F(this,"isolatedHandle",Hg(this,r));F(this,"handle");this.handle=E,this[Fc]=!0}get id(){return this.handle.id}get disposed(){return this.handle.disposed}async getProperty(E){return await this.handle.getProperty(E)}async getProperties(){return await this.handle.getProperties()}async evaluate(E,...y){return E=Ie(this.evaluate.name,E),await this.handle.evaluate(E,...y)}async evaluateHandle(E,...y){return E=Ie(this.evaluateHandle.name,E),await this.handle.evaluateHandle(E,...y)}async jsonValue(){return await this.handle.jsonValue()}toString(){return this.handle.toString()}remoteObject(){return this.handle.remoteObject()}async dispose(){var E;await Promise.all([this.handle.dispose(),(E=this.isolatedHandle)==null?void 0:E.dispose()])}asElement(){return this}async $(E){const{updatedSelector:y,QueryHandler:_}=xc(E);return await _.queryOne(this,y)}async $$(E,y){return(y==null?void 0:y.isolate)===!1?await b(this,q,au).call(this,E):await n(this,q,nu).call(this,E)}async $eval(E,y,..._){const C={stack:[],error:void 0,hasError:!1};try{y=Ie(this.$eval.name,y);const I=ta(C,await this.$(E),!1);if(!I)throw new Error(`Error: failed to find element matching selector "${E}"`);return await I.evaluate(y,..._)}catch(I){C.error=I,C.hasError=!0}finally{ra(C)}}async $$eval(E,y,..._){const C={stack:[],error:void 0,hasError:!1};try{y=Ie(this.$$eval.name,y);const I=await this.$$(E),W=ta(C,await this.evaluateHandle((Oe,...be)=>be,...I),!1),[ae]=await Promise.all([W.evaluate(y,..._),...I.map(Oe=>Oe.dispose())]);return ae}catch(I){C.error=I,C.hasError=!0}finally{ra(C)}}async waitForSelector(E,y={}){const{updatedSelector:_,QueryHandler:C,polling:I}=xc(E);return await C.waitFor(this,_,{polling:I,...y})}async isVisible(){return await b(this,q,ou).call(this,!0)}async isHidden(){return await b(this,q,ou).call(this,!1)}async toElement(E){if(!await this.evaluate((_,C)=>_.nodeName===C.toUpperCase(),E))throw new Error(`Element is not a(n) \`${E}\` element`);return this}async clickablePoint(E){const y=await b(this,q,nf).call(this);if(!y)throw new Error("Node is either not clickable or not an Element");return E!==void 0?{x:y.x+E.x,y:y.y+E.y}:{x:y.x+y.width/2,y:y.y+y.height/2}}async hover(){await this.scrollIntoViewIfNeeded();const{x:E,y}=await this.clickablePoint();await this.frame.page().mouse.move(E,y)}async click(E={}){await this.scrollIntoViewIfNeeded();const{x:y,y:_}=await this.clickablePoint(E.offset);await this.frame.page().mouse.click(y,_,E)}async drag(E){await this.scrollIntoViewIfNeeded();const y=this.frame.page();if(y.isDragInterceptionEnabled()){const _=await this.clickablePoint();return E instanceof J&&(E=await E.clickablePoint()),await y.mouse.drag(_,E)}try{y._isDragging||(y._isDragging=!0,await this.hover(),await y.mouse.down()),E instanceof J?await E.hover():await y.mouse.move(E.x,E.y)}catch(_){throw y._isDragging=!1,_}}async dragEnter(E={items:[],dragOperationsMask:1}){const y=this.frame.page();await this.scrollIntoViewIfNeeded();const _=await this.clickablePoint();await y.mouse.dragEnter(_,E)}async dragOver(E={items:[],dragOperationsMask:1}){const y=this.frame.page();await this.scrollIntoViewIfNeeded();const _=await this.clickablePoint();await y.mouse.dragOver(_,E)}async drop(E={items:[],dragOperationsMask:1}){const y=this.frame.page();if("items"in E){await this.scrollIntoViewIfNeeded();const _=await this.clickablePoint();await y.mouse.drop(_,E)}else await E.drag(this),y._isDragging=!1,await y.mouse.up()}async dragAndDrop(E,y){const _=this.frame.page();x(_.isDragInterceptionEnabled(),"Drag Interception is not enabled!"),await this.scrollIntoViewIfNeeded();const C=await this.clickablePoint(),I=await E.clickablePoint();await _.mouse.dragAndDrop(C,I,y)}async select(...E){for(const y of E)x(gs(y),'Values must be strings. Found value "'+y+'" of type "'+typeof y+'"');return await this.evaluate((y,_)=>{const C=new Set(_);if(!(y instanceof HTMLSelectElement))throw new Error("Element is not a <select> element.");const I=new Set;if(y.multiple)for(const W of y.options)W.selected=C.has(W.value),W.selected&&I.add(W.value);else{for(const W of y.options)W.selected=!1;for(const W of y.options)if(C.has(W.value)){W.selected=!0,I.add(W.value);break}}return y.dispatchEvent(new Event("input",{bubbles:!0})),y.dispatchEvent(new Event("change",{bubbles:!0})),[...I.values()]},E)}async tap(){await this.scrollIntoViewIfNeeded();const{x:E,y}=await this.clickablePoint();await this.frame.page().touchscreen.tap(E,y)}async touchStart(){await this.scrollIntoViewIfNeeded();const{x:E,y}=await this.clickablePoint();return await this.frame.page().touchscreen.touchStart(E,y)}async touchMove(E){await this.scrollIntoViewIfNeeded();const{x:y,y:_}=await this.clickablePoint();if(E)return await E.move(y,_);await this.frame.page().touchscreen.touchMove(y,_)}async touchEnd(){await this.scrollIntoViewIfNeeded(),await this.frame.page().touchscreen.touchEnd()}async focus(){await this.evaluate(E=>{if(!(E instanceof HTMLElement))throw new Error("Cannot focus non-HTMLElement");return E.focus()})}async type(E,y){await this.focus(),await this.frame.page().keyboard.type(E,y)}async press(E,y){await this.focus(),await this.frame.page().keyboard.press(E,y)}async boundingBox(){const E=await this.evaluate(_=>{if(!(_ instanceof Element)||_.getClientRects().length===0)return null;const C=_.getBoundingClientRect();return{x:C.x,y:C.y,width:C.width,height:C.height}});if(!E)return null;const y=await b(this,q,lu).call(this);return y?{x:E.x+y.x,y:E.y+y.y,height:E.height,width:E.width}:null}async boxModel(){const E=await this.evaluate(_=>{if(!(_ instanceof Element)||_.getClientRects().length===0)return null;const C=_.getBoundingClientRect(),I=window.getComputedStyle(_),W={padding:{left:parseInt(I.paddingLeft,10),top:parseInt(I.paddingTop,10),right:parseInt(I.paddingRight,10),bottom:parseInt(I.paddingBottom,10)},margin:{left:-parseInt(I.marginLeft,10),top:-parseInt(I.marginTop,10),right:-parseInt(I.marginRight,10),bottom:-parseInt(I.marginBottom,10)},border:{left:parseInt(I.borderLeft,10),top:parseInt(I.borderTop,10),right:parseInt(I.borderRight,10),bottom:parseInt(I.borderBottom,10)}},ae=[{x:C.left,y:C.top},{x:C.left+C.width,y:C.top},{x:C.left+C.width,y:C.top+C.height},{x:C.left,y:C.top+C.height}],Oe=ct(ae,W.border),be=ct(Oe,W.padding),Vt=ct(ae,W.margin);return{content:be,padding:Oe,border:ae,margin:Vt,width:C.width,height:C.height};function ct(Et,lt){return[{x:Et[0].x+lt.left,y:Et[0].y+lt.top},{x:Et[1].x-lt.right,y:Et[1].y+lt.top},{x:Et[2].x-lt.right,y:Et[2].y-lt.bottom},{x:Et[3].x+lt.left,y:Et[3].y-lt.bottom}]}});if(!E)return null;const y=await b(this,q,lu).call(this);if(!y)return null;for(const _ of["content","padding","border","margin"])for(const C of E[_])C.x+=y.x,C.y+=y.y;return E}async screenshot(E={}){const{scrollIntoView:y=!0,clip:_}=E,C=this.frame.page();y&&await this.scrollIntoViewIfNeeded();const I=await b(this,q,af).call(this),[W,ae]=await this.evaluate(()=>{if(!window.visualViewport)throw new Error("window.visualViewport is not supported.");return[window.visualViewport.pageLeft,window.visualViewport.pageTop]});return I.x+=W,I.y+=ae,_&&(I.x+=_.x,I.y+=_.y,I.height=_.height,I.width=_.width),await C.screenshot({...E,clip:I})}async assertConnectedElement(){const E=await this.evaluate(async y=>{if(!y.isConnected)return"Node is detached from document";if(y.nodeType!==Node.ELEMENT_NODE)return"Node is not of type HTMLElement"});if(E)throw new Error(E)}async scrollIntoViewIfNeeded(){await this.isIntersectingViewport({threshold:1})||await this.scrollIntoView()}async isIntersectingViewport(E={}){var _;const y={stack:[],error:void 0,hasError:!1};try{await this.assertConnectedElement();const C=await b(this,q,of).call(this);return await(ta(y,C&&await b(_=C,q,cf).call(_),!1)??this).evaluate(async(W,ae)=>{const Oe=await new Promise(be=>{const Vt=new IntersectionObserver(ct=>{be(ct[0].intersectionRatio),Vt.disconnect()});Vt.observe(W)});return ae===1?Oe===1:Oe>ae},E.threshold??0)}catch(C){y.error=C,y.hasError=!0}finally{ra(y)}}async scrollIntoView(){await this.assertConnectedElement(),await this.evaluate(async E=>{E.scrollIntoView({block:"center",inline:"center",behavior:"instant"})})}},q=new WeakSet,nu=function(){return l.value},au=async function(E){const{updatedSelector:y,QueryHandler:_}=xc(E);return await Ml.collect(_.queryAll(this,y))},ou=async function(E){return await this.evaluate(async(y,_,C)=>!!_.checkVisibility(y,C),St.create(y=>y.puppeteerUtil),E)},nf=async function(){var I;const E=await this.evaluate(W=>W instanceof Element?[...W.getClientRects()].map(ae=>({x:ae.x,y:ae.y,width:ae.width,height:ae.height})):null);if(!(E!=null&&E.length))return null;await b(this,q,cu).call(this,E);let y=this.frame,_;for(;_=y==null?void 0:y.parentFrame();){const W={stack:[],error:void 0,hasError:!1};try{const ae=ta(W,await y.frameElement(),!1);if(!ae)throw new Error("Unsupported frame type");const Oe=await ae.evaluate(be=>{if(be.getClientRects().length===0)return null;const Vt=be.getBoundingClientRect(),ct=window.getComputedStyle(be);return{left:Vt.left+parseInt(ct.paddingLeft,10)+parseInt(ct.borderLeftWidth,10),top:Vt.top+parseInt(ct.paddingTop,10)+parseInt(ct.borderTopWidth,10)}});if(!Oe)return null;for(const be of E)be.x+=Oe.left,be.y+=Oe.top;await b(I=ae,q,cu).call(I,E),y=_}catch(ae){W.error=ae,W.hasError=!0}finally{ra(W)}}const C=E.find(W=>W.width>=1&&W.height>=1);return C?{x:C.x,y:C.y,height:C.height,width:C.width}:null},cu=async function(E){const{documentWidth:y,documentHeight:_}=await this.frame.isolatedRealm().evaluate(()=>({documentWidth:document.documentElement.clientWidth,documentHeight:document.documentElement.clientHeight}));for(const C of E)zg(C,y,_)},lu=async function(){const E={x:0,y:0};let y=this.frame,_;for(;_=y==null?void 0:y.parentFrame();){const C={stack:[],error:void 0,hasError:!1};try{const I=ta(C,await y.frameElement(),!1);if(!I)throw new Error("Unsupported frame type");const W=await I.evaluate(ae=>{if(ae.getClientRects().length===0)return null;const Oe=ae.getBoundingClientRect(),be=window.getComputedStyle(ae);return{left:Oe.left+parseInt(be.paddingLeft,10)+parseInt(be.borderLeftWidth,10),top:Oe.top+parseInt(be.paddingTop,10)+parseInt(be.borderTopWidth,10)}});if(!W)return null;E.x+=W.left,E.y+=W.top,y=_}catch(I){C.error=I,C.hasError=!0}finally{ra(C)}}return E},af=async function(){const E=await this.boundingBox();return x(E,"Node is either not visible or not an HTMLElement"),x(E.width!==0,"Node has 0 width."),x(E.height!==0,"Node has 0 height."),E},of=async function(){return await this.evaluate(E=>E instanceof SVGElement)?this:null},cf=async function(){return await this.evaluateHandle(E=>E instanceof SVGSVGElement?E:E.ownerSVGElement)},(()=>{const E=typeof Symbol=="function"&&Symbol.metadata?Object.create(s[Symbol.metadata]??null):void 0;e=[Q(),re],t=[Q(),re],i=[Q(),re],a=[Q(),re],o=[Q()],c=[re],u=[Q(),re],f=[Q(),re],w=[Q(),re],h=[Q(),re],g=[Q(),re],S=[Q(),re],m=[Q(),re],v=[Q(),re],T=[Q(),re],D=[Q(),re],P=[Q(),re],M=[Q(),re],U=[Q(),re],H=[Q(),re],N=[Q(),re],G=[Q(),re],L=[Q(),re],V=[Q(),re],De=[Q(),re],A=[Q(),re],k=[Q(),re],K=[Q(),re],$=[Q(),re],te=[Q(),re],ge=[Q(),re],ie(J,null,e,{kind:"method",name:"getProperty",static:!1,private:!1,access:{has:y=>"getProperty"in y,get:y=>y.getProperty},metadata:E},null,r),ie(J,null,t,{kind:"method",name:"getProperties",static:!1,private:!1,access:{has:y=>"getProperties"in y,get:y=>y.getProperties},metadata:E},null,r),ie(J,null,i,{kind:"method",name:"jsonValue",static:!1,private:!1,access:{has:y=>"jsonValue"in y,get:y=>y.jsonValue},metadata:E},null,r),ie(J,null,a,{kind:"method",name:"$",static:!1,private:!1,access:{has:y=>"$"in y,get:y=>y.$},metadata:E},null,r),ie(J,null,o,{kind:"method",name:"$$",static:!1,private:!1,access:{has:y=>"$$"in y,get:y=>y.$$},metadata:E},null,r),ie(J,l={value:Gg(async function(y){return await b(this,q,au).call(this,y)},"#$$")},c,{kind:"method",name:"#$$",static:!1,private:!0,access:{has:y=>ut(q,y),get:y=>n(y,q,nu)},metadata:E},null,r),ie(J,null,u,{kind:"method",name:"waitForSelector",static:!1,private:!1,access:{has:y=>"waitForSelector"in y,get:y=>y.waitForSelector},metadata:E},null,r),ie(J,null,f,{kind:"method",name:"isVisible",static:!1,private:!1,access:{has:y=>"isVisible"in y,get:y=>y.isVisible},metadata:E},null,r),ie(J,null,w,{kind:"method",name:"isHidden",static:!1,private:!1,access:{has:y=>"isHidden"in y,get:y=>y.isHidden},metadata:E},null,r),ie(J,null,h,{kind:"method",name:"toElement",static:!1,private:!1,access:{has:y=>"toElement"in y,get:y=>y.toElement},metadata:E},null,r),ie(J,null,g,{kind:"method",name:"clickablePoint",static:!1,private:!1,access:{has:y=>"clickablePoint"in y,get:y=>y.clickablePoint},metadata:E},null,r),ie(J,null,S,{kind:"method",name:"hover",static:!1,private:!1,access:{has:y=>"hover"in y,get:y=>y.hover},metadata:E},null,r),ie(J,null,m,{kind:"method",name:"click",static:!1,private:!1,access:{has:y=>"click"in y,get:y=>y.click},metadata:E},null,r),ie(J,null,v,{kind:"method",name:"drag",static:!1,private:!1,access:{has:y=>"drag"in y,get:y=>y.drag},metadata:E},null,r),ie(J,null,T,{kind:"method",name:"dragEnter",static:!1,private:!1,access:{has:y=>"dragEnter"in y,get:y=>y.dragEnter},metadata:E},null,r),ie(J,null,D,{kind:"method",name:"dragOver",static:!1,private:!1,access:{has:y=>"dragOver"in y,get:y=>y.dragOver},metadata:E},null,r),ie(J,null,P,{kind:"method",name:"drop",static:!1,private:!1,access:{has:y=>"drop"in y,get:y=>y.drop},metadata:E},null,r),ie(J,null,M,{kind:"method",name:"dragAndDrop",static:!1,private:!1,access:{has:y=>"dragAndDrop"in y,get:y=>y.dragAndDrop},metadata:E},null,r),ie(J,null,U,{kind:"method",name:"select",static:!1,private:!1,access:{has:y=>"select"in y,get:y=>y.select},metadata:E},null,r),ie(J,null,H,{kind:"method",name:"tap",static:!1,private:!1,access:{has:y=>"tap"in y,get:y=>y.tap},metadata:E},null,r),ie(J,null,N,{kind:"method",name:"touchStart",static:!1,private:!1,access:{has:y=>"touchStart"in y,get:y=>y.touchStart},metadata:E},null,r),ie(J,null,G,{kind:"method",name:"touchMove",static:!1,private:!1,access:{has:y=>"touchMove"in y,get:y=>y.touchMove},metadata:E},null,r),ie(J,null,L,{kind:"method",name:"touchEnd",static:!1,private:!1,access:{has:y=>"touchEnd"in y,get:y=>y.touchEnd},metadata:E},null,r),ie(J,null,V,{kind:"method",name:"focus",static:!1,private:!1,access:{has:y=>"focus"in y,get:y=>y.focus},metadata:E},null,r),ie(J,null,De,{kind:"method",name:"type",static:!1,private:!1,access:{has:y=>"type"in y,get:y=>y.type},metadata:E},null,r),ie(J,null,A,{kind:"method",name:"press",static:!1,private:!1,access:{has:y=>"press"in y,get:y=>y.press},metadata:E},null,r),ie(J,null,k,{kind:"method",name:"boundingBox",static:!1,private:!1,access:{has:y=>"boundingBox"in y,get:y=>y.boundingBox},metadata:E},null,r),ie(J,null,K,{kind:"method",name:"boxModel",static:!1,private:!1,access:{has:y=>"boxModel"in y,get:y=>y.boxModel},metadata:E},null,r),ie(J,null,$,{kind:"method",name:"screenshot",static:!1,private:!1,access:{has:y=>"screenshot"in y,get:y=>y.screenshot},metadata:E},null,r),ie(J,null,te,{kind:"method",name:"isIntersectingViewport",static:!1,private:!1,access:{has:y=>"isIntersectingViewport"in y,get:y=>y.isIntersectingViewport},metadata:E},null,r),ie(J,null,ge,{kind:"method",name:"scrollIntoView",static:!1,private:!1,access:{has:y=>"scrollIntoView"in y,get:y=>y.scrollIntoView},metadata:E},null,r),E&&Object.defineProperty(J,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:E})})(),J})();function zg(s,r,e){s.width=Math.max(s.x>=0?Math.min(r-s.x,s.width):Math.min(r,s.width+s.x),0),s.height=Math.max(s.y>=0?Math.min(e-s.y,s.height):Math.min(e,s.height+s.y),0)}var Jg=function(s,r,e){if(r!=null){if(typeof r!="object"&&typeof r!="function")throw new TypeError("Object expected.");var t,i;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");t=r[Symbol.asyncDispose]}if(t===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");t=r[Symbol.dispose],e&&(i=t)}if(typeof t!="function")throw new TypeError("Object not disposable.");i&&(t=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),s.stack.push({value:r,dispose:t,async:e})}else e&&s.stack.push({async:!0});return r},Xg=function(s){return function(r){function e(o){r.error=r.hasError?new s(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,i=0;function a(){for(;t=r.stack.pop();)try{if(!t.async&&i===1)return i=0,r.stack.push(t),Promise.resolve().then(a);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return i|=2,Promise.resolve(o).then(a,function(c){return e(c),a()})}else i|=1}catch(c){e(c)}if(i===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return a()}}(typeof SuppressedError=="function"?SuppressedError:function(s,r,e){var t=new Error(e);return t.name="SuppressedError",t.error=s,t.suppressed=r,t}),Ss;(function(s){s.Action="action"})(Ss||(Ss={}));var gi,yi,wi,Ia,vi,bi,Ht,lf,uf,df,hf;class Yn extends pe{constructor(){super(...arguments);d(this,Ht);F(this,"visibility",null);F(this,"_timeout",3e4);d(this,gi,!0);d(this,yi,!0);d(this,wi,!0);F(this,"operators",{conditions:(e,t)=>_e(i=>fa(...e.map(a=>a(i,t))).pipe(Hh(i))),retryAndRaceWithSignalAndTimer:(e,t)=>{const i=[];return e&&i.push(bs(e,t)),i.push(Bt(this._timeout,t)),Yp(Ic({delay:Rc}),Wt(...i))}});d(this,Ia,(e,t)=>n(this,yi)?se(e.frame.waitForFunction(i=>i instanceof HTMLElement?!["BUTTON","INPUT","SELECT","TEXTAREA","OPTION","OPTGROUP"].includes(i.nodeName)||!i.hasAttribute("disabled"):!0,{timeout:this._timeout,signal:t},e)).pipe(Ac()):cs);d(this,vi,e=>n(this,wi)?Ts(()=>se(e.evaluate(t=>new Promise(i=>{window.requestAnimationFrame(()=>{const a=t.getBoundingClientRect();window.requestAnimationFrame(()=>{const o=t.getBoundingClientRect();i([{x:a.x,y:a.y,width:a.width,height:a.height},{x:o.x,y:o.y,width:o.width,height:o.height}])})})})))).pipe(Xc(([t,i])=>t.x===i.x&&t.y===i.y&&t.width===i.width&&t.height===i.height),Ic({delay:Rc}),Ac()):cs);d(this,bi,e=>n(this,gi)?se(e.isIntersectingViewport({threshold:0})).pipe(Qn(t=>!t),_e(()=>se(e.scrollIntoView())),_e(()=>Ts(()=>se(e.isIntersectingViewport({threshold:0}))).pipe(Xc(Gt),Ic({delay:Rc}),Ac()))):cs)}static race(e){return uu.create(e)}get timeout(){return this._timeout}setTimeout(e){const t=this._clone();return t._timeout=e,t}setVisibility(e){const t=this._clone();return t.visibility=e,t}setWaitForEnabled(e){const t=this._clone();return p(t,yi,e),t}setEnsureElementIsInTheViewport(e){const t=this._clone();return p(t,gi,e),t}setWaitForStableBoundingBox(e){const t=this._clone();return p(t,wi,e),t}copyOptions(e){return this._timeout=e._timeout,this.visibility=e.visibility,p(this,yi,n(e,yi)),p(this,gi,n(e,gi)),p(this,wi,n(e,wi)),this}clone(){return this._clone()}async waitHandle(e){const t=new Error("Locator.waitHandle");return await Je(this._wait(e).pipe(this.operators.retryAndRaceWithSignalAndTimer(e==null?void 0:e.signal,t)))}async wait(e){const t={stack:[],error:void 0,hasError:!1};try{return await Jg(t,await this.waitHandle(e),!1).jsonValue()}catch(i){t.error=i,t.hasError=!0}finally{Xg(t)}}map(e){return new il(this._clone(),t=>t.evaluateHandle(e))}filter(e){return new rl(this._clone(),async(t,i)=>(await t.frame.waitForFunction(e,{signal:i,timeout:this._timeout},t),!0))}filterHandle(e){return new rl(this._clone(),e)}mapHandle(e){return new il(this._clone(),e)}click(e){return Je(b(this,Ht,lf).call(this,e))}fill(e,t){return Je(b(this,Ht,uf).call(this,e,t))}hover(e){return Je(b(this,Ht,df).call(this,e))}scroll(e){return Je(b(this,Ht,hf).call(this,e))}}gi=new WeakMap,yi=new WeakMap,wi=new WeakMap,Ia=new WeakMap,vi=new WeakMap,bi=new WeakMap,Ht=new WeakSet,lf=function(e){const t=e==null?void 0:e.signal,i=new Error("Locator.click");return this._wait(e).pipe(this.operators.conditions([n(this,bi),n(this,vi),n(this,Ia)],t),kc(()=>this.emit(Ss.Action,void 0)),_e(a=>se(a.click(e)).pipe(sa(o=>{throw a.dispose().catch(B),o}))),this.operators.retryAndRaceWithSignalAndTimer(t,i))},uf=function(e,t){const i=t==null?void 0:t.signal,a=new Error("Locator.fill");return this._wait(t).pipe(this.operators.conditions([n(this,bi),n(this,vi),n(this,Ia)],i),kc(()=>this.emit(Ss.Action,void 0)),_e(o=>se(o.evaluate(c=>c instanceof HTMLSelectElement?"select":c instanceof HTMLTextAreaElement?"typeable-input":c instanceof HTMLInputElement?new Set(["textarea","text","url","tel","search","password","number","email"]).has(c.type)?"typeable-input":"other-input":c.isContentEditable?"contenteditable":"unknown")).pipe(_e(c=>{switch(c){case"select":return se(o.select(e).then(Hn));case"contenteditable":case"typeable-input":return se(o.evaluate((l,u)=>{const f=l.isContentEditable?l.innerText:l.value;if(u.length<=f.length||!u.startsWith(l.value))return l.isContentEditable?l.innerText="":l.value="",u;const w=l.isContentEditable?l.innerText:l.value;return l.isContentEditable?(l.innerText="",l.innerText=w):(l.value="",l.value=w),u.substring(w.length)},e)).pipe(_e(l=>se(o.type(l))));case"other-input":return se(o.focus()).pipe(_e(()=>se(o.evaluate((l,u)=>{l.value=u,l.dispatchEvent(new Event("input",{bubbles:!0})),l.dispatchEvent(new Event("change",{bubbles:!0}))},e))));case"unknown":throw new Error("Element cannot be filled out.")}})).pipe(sa(c=>{throw o.dispose().catch(B),c}))),this.operators.retryAndRaceWithSignalAndTimer(i,a))},df=function(e){const t=e==null?void 0:e.signal,i=new Error("Locator.hover");return this._wait(e).pipe(this.operators.conditions([n(this,bi),n(this,vi)],t),kc(()=>this.emit(Ss.Action,void 0)),_e(a=>se(a.hover()).pipe(sa(o=>{throw a.dispose().catch(B),o}))),this.operators.retryAndRaceWithSignalAndTimer(t,i))},hf=function(e){const t=e==null?void 0:e.signal,i=new Error("Locator.scroll");return this._wait(e).pipe(this.operators.conditions([n(this,bi),n(this,vi)],t),kc(()=>this.emit(Ss.Action,void 0)),_e(a=>se(a.evaluate((o,c,l)=>{c!==void 0&&(o.scrollTop=c),l!==void 0&&(o.scrollLeft=l)},e==null?void 0:e.scrollTop,e==null?void 0:e.scrollLeft)).pipe(sa(o=>{throw a.dispose().catch(B),o}))),this.operators.retryAndRaceWithSignalAndTimer(t,i))};var Os,xs;const dl=class dl extends Yn{constructor(e,t){super();d(this,Os);d(this,xs);p(this,Os,e),p(this,xs,t)}static create(e,t){return new dl(e,t).setTimeout("getDefaultTimeout"in e?e.getDefaultTimeout():e.page().getDefaultTimeout())}_clone(){return new dl(n(this,Os),n(this,xs))}_wait(e){const t=e==null?void 0:e.signal;return Ts(()=>se(n(this,Os).waitForFunction(n(this,xs),{timeout:this.timeout,signal:t}))).pipe(Pl())}};Os=new WeakMap,xs=new WeakMap;let tl=dl;var Ne;class ff extends Yn{constructor(e){super();d(this,Ne);p(this,Ne,e),this.copyOptions(n(this,Ne))}get delegate(){return n(this,Ne)}setTimeout(e){const t=super.setTimeout(e);return p(t,Ne,n(this,Ne).setTimeout(e)),t}setVisibility(e){const t=super.setVisibility(e);return p(t,Ne,n(t,Ne).setVisibility(e)),t}setWaitForEnabled(e){const t=super.setWaitForEnabled(e);return p(t,Ne,n(this,Ne).setWaitForEnabled(e)),t}setEnsureElementIsInTheViewport(e){const t=super.setEnsureElementIsInTheViewport(e);return p(t,Ne,n(this,Ne).setEnsureElementIsInTheViewport(e)),t}setWaitForStableBoundingBox(e){const t=super.setWaitForStableBoundingBox(e);return p(t,Ne,n(this,Ne).setWaitForStableBoundingBox(e)),t}}Ne=new WeakMap;var Rs;const kd=class kd extends ff{constructor(e,t){super(e);d(this,Rs);p(this,Rs,t)}_clone(){return new kd(this.delegate.clone(),n(this,Rs)).copyOptions(this)}_wait(e){return this.delegate._wait(e).pipe(_e(t=>se(Promise.resolve(n(this,Rs).call(this,t,e==null?void 0:e.signal))).pipe(Qn(i=>i),Ue(()=>t))),Pl())}};Rs=new WeakMap;let rl=kd;var Ls;const Ed=class Ed extends ff{constructor(e,t){super(e);d(this,Ls);p(this,Ls,t)}_clone(){return new Ed(this.delegate.clone(),n(this,Ls)).copyOptions(this)}_wait(e){return this.delegate._wait(e).pipe(_e(t=>se(Promise.resolve(n(this,Ls).call(this,t,e==null?void 0:e.signal)))))}};Ls=new WeakMap;let il=Ed;var Ns,Ks,hl;const fl=class fl extends Yn{constructor(e,t){super();d(this,Ns);d(this,Ks);d(this,hl,e=>this.visibility?(()=>{switch(this.visibility){case"hidden":return Ts(()=>se(e.isHidden()));case"visible":return Ts(()=>se(e.isVisible()))}})().pipe(Xc(Gt),Ic({delay:Rc}),Ac()):cs);p(this,Ns,e),p(this,Ks,t)}static create(e,t){return new fl(e,t).setTimeout("getDefaultTimeout"in e?e.getDefaultTimeout():e.page().getDefaultTimeout())}_clone(){return new fl(n(this,Ns),n(this,Ks)).copyOptions(this)}_wait(e){const t=e==null?void 0:e.signal;return Ts(()=>se(n(this,Ns).waitForSelector(n(this,Ks),{visible:!1,timeout:this._timeout,signal:t}))).pipe(Qn(i=>i!==null),Pl(),this.operators.conditions([n(this,hl)],t))}};Ns=new WeakMap,Ks=new WeakMap,hl=new WeakMap;let sl=fl;function Qg(s){for(const r of s)if(!(r instanceof Yn))throw new Error("Unknown locator for race candidate");return s}var $s;const pl=class pl extends Yn{constructor(e){super();d(this,$s);p(this,$s,e)}static create(e){const t=Qg(e);return new pl(t)}_clone(){return new pl(n(this,$s).map(e=>e.clone())).copyOptions(this)}_wait(e){return Gm(...n(this,$s).map(t=>t._wait(e)))}};$s=new WeakMap;let uu=pl;const Rc=100;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Yg=function(s,r,e){for(var t=arguments.length>2,i=0;i<r.length;i++)e=t?r[i].call(s,e):r[i].call(s);return t?e:void 0},ye=function(s,r,e,t,i,a){function o(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var c=t.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!r&&s?t.static?s:s.prototype:null,f=r||(u?Object.getOwnPropertyDescriptor(u,t.name):{}),w,h=!1,g=e.length-1;g>=0;g--){var S={};for(var m in t)S[m]=m==="access"?{}:t[m];for(var m in t.access)S.access[m]=t.access[m];S.addInitializer=function(T){if(h)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(T||null))};var v=(0,e[g])(c==="accessor"?{get:f.get,set:f.set}:f[l],S);if(c==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(w=o(v.get))&&(f.get=w),(w=o(v.set))&&(f.set=w),(w=o(v.init))&&i.unshift(w)}else(w=o(v))&&(c==="field"?i.unshift(w):f[l]=w)}u&&Object.defineProperty(u,t.name,f),h=!0},wr=function(s,r,e){if(r!=null){if(typeof r!="object"&&typeof r!="function")throw new TypeError("Object expected.");var t,i;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");t=r[Symbol.asyncDispose]}if(t===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");t=r[Symbol.dispose],e&&(i=t)}if(typeof t!="function")throw new TypeError("Object not disposable.");i&&(t=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),s.stack.push({value:r,dispose:t,async:e})}else e&&s.stack.push({async:!0});return r},vr=function(s){return function(r){function e(o){r.error=r.hasError?new s(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,i=0;function a(){for(;t=r.stack.pop();)try{if(!t.async&&i===1)return i=0,r.stack.push(t),Promise.resolve().then(a);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return i|=2,Promise.resolve(o).then(a,function(c){return e(c),a()})}else i|=1}catch(c){e(c)}if(i===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return a()}}(typeof SuppressedError=="function"?SuppressedError:function(s,r,e){var t=new Error(e);return t.name="SuppressedError",t.error=s,t.suppressed=r,t}),xe;(function(s){s.FrameNavigated=Symbol("Frame.FrameNavigated"),s.FrameSwapped=Symbol("Frame.FrameSwapped"),s.LifecycleEvent=Symbol("Frame.LifecycleEvent"),s.FrameNavigatedWithinDocument=Symbol("Frame.FrameNavigatedWithinDocument"),s.FrameDetached=Symbol("Frame.FrameDetached"),s.FrameSwappedByActivation=Symbol("Frame.FrameSwappedByActivation")})(xe||(xe={}));const le=Q(s=>`Attempted to use detached Frame '${s._id}'.`);let Zg=(()=>{var H,N,na,L;let s=pe,r=[],e,t,i,a,o,c,l,u,f,w,h,g,S,m,v,T,D,P,M,U;return L=class extends s{constructor(){super();d(this,N);F(this,"_id",Yg(this,r));F(this,"_parentId");F(this,"_name");F(this,"_hasStartedLoading",!1);d(this,H)}clearDocumentHandle(){p(this,H,void 0)}async frameElement(){const A={stack:[],error:void 0,hasError:!1};try{const k=this.parentFrame();if(!k)return null;const K=wr(A,await k.isolatedRealm().evaluateHandle(()=>document.querySelectorAll("iframe,frame")),!1);for await(const $ of tf(K)){const te={stack:[],error:void 0,hasError:!1};try{const ge=wr(te,$,!1),q=await ge.contentFrame();if((q==null?void 0:q._id)===this._id)return await k.mainRealm().adoptHandle(ge)}catch(ge){te.error=ge,te.hasError=!0}finally{vr(te)}}return null}catch(k){A.error=k,A.hasError=!0}finally{vr(A)}}async evaluateHandle(A,...k){return A=Ie(this.evaluateHandle.name,A),await this.mainRealm().evaluateHandle(A,...k)}async evaluate(A,...k){return A=Ie(this.evaluate.name,A),await this.mainRealm().evaluate(A,...k)}locator(A){return typeof A=="string"?sl.create(this,A):tl.create(this,A)}async $(A){return await(await b(this,N,na).call(this)).$(A)}async $$(A,k){return await(await b(this,N,na).call(this)).$$(A,k)}async $eval(A,k,...K){return k=Ie(this.$eval.name,k),await(await b(this,N,na).call(this)).$eval(A,k,...K)}async $$eval(A,k,...K){return k=Ie(this.$$eval.name,k),await(await b(this,N,na).call(this)).$$eval(A,k,...K)}async waitForSelector(A,k={}){const{updatedSelector:K,QueryHandler:$,polling:te}=xc(A);return await $.waitFor(this,K,{polling:te,...k})}async waitForFunction(A,k={},...K){return await this.mainRealm().waitForFunction(A,k,...K)}async content(){return await this.evaluate(()=>{let A="";for(const k of document.childNodes)switch(k){case document.documentElement:A+=document.documentElement.outerHTML;break;default:A+=new XMLSerializer().serializeToString(k);break}return A})}async setFrameContent(A){return await this.evaluate(k=>{document.open(),document.write(k),document.close()},A)}name(){return this._name||""}isDetached(){return this.detached}get disposed(){return this.detached}async addScriptTag(A){let{content:k="",type:K}=A;const{path:$}=A;if(+!!A.url+ +!!$+ +!!k!=1)throw new Error("Exactly one of `url`, `path`, or `content` must be specified.");return $&&(k=await ls.value.fs.promises.readFile($,"utf8"),k+=`//# sourceURL=${$.replace(/\n/g,"")}`),K=K??"text/javascript",await this.mainRealm().transferHandle(await this.isolatedRealm().evaluateHandle(async({url:te,id:ge,type:q,content:Ee})=>await new Promise((j,Np)=>{const kt=document.createElement("script");kt.type=q,kt.text=Ee,kt.addEventListener("error",Kp=>{Np(new Error(Kp.message??"Could not load script"))},{once:!0}),ge&&(kt.id=ge),te?(kt.src=te,kt.addEventListener("load",()=>{j(kt)},{once:!0}),document.head.appendChild(kt)):(document.head.appendChild(kt),j(kt))}),{...A,type:K,content:k}))}async addStyleTag(A){let{content:k=""}=A;const{path:K}=A;if(+!!A.url+ +!!K+ +!!k!=1)throw new Error("Exactly one of `url`, `path`, or `content` must be specified.");return K&&(k=await ls.value.fs.promises.readFile(K,"utf8"),k+="/*# sourceURL="+K.replace(/\n/g,"")+"*/",A.content=k),await this.mainRealm().transferHandle(await this.isolatedRealm().evaluateHandle(async({url:$,content:te})=>await new Promise((ge,q)=>{let Ee;if(!$)Ee=document.createElement("style"),Ee.appendChild(document.createTextNode(te));else{const j=document.createElement("link");j.rel="stylesheet",j.href=$,Ee=j}return Ee.addEventListener("load",()=>{ge(Ee)},{once:!0}),Ee.addEventListener("error",j=>{q(new Error(j.message??"Could not load style"))},{once:!0}),document.head.appendChild(Ee),Ee}),A))}async click(A,k={}){const K={stack:[],error:void 0,hasError:!1};try{const $=wr(K,await this.$(A),!1);x($,`No element found for selector: ${A}`),await $.click(k),await $.dispose()}catch($){K.error=$,K.hasError=!0}finally{vr(K)}}async focus(A){const k={stack:[],error:void 0,hasError:!1};try{const K=wr(k,await this.$(A),!1);x(K,`No element found for selector: ${A}`),await K.focus()}catch(K){k.error=K,k.hasError=!0}finally{vr(k)}}async hover(A){const k={stack:[],error:void 0,hasError:!1};try{const K=wr(k,await this.$(A),!1);x(K,`No element found for selector: ${A}`),await K.hover()}catch(K){k.error=K,k.hasError=!0}finally{vr(k)}}async select(A,...k){const K={stack:[],error:void 0,hasError:!1};try{const $=wr(K,await this.$(A),!1);return x($,`No element found for selector: ${A}`),await $.select(...k)}catch($){K.error=$,K.hasError=!0}finally{vr(K)}}async tap(A){const k={stack:[],error:void 0,hasError:!1};try{const K=wr(k,await this.$(A),!1);x(K,`No element found for selector: ${A}`),await K.tap()}catch(K){k.error=K,k.hasError=!0}finally{vr(k)}}async type(A,k,K){const $={stack:[],error:void 0,hasError:!1};try{const te=wr($,await this.$(A),!1);x(te,`No element found for selector: ${A}`),await te.type(k,K)}catch(te){$.error=te,$.hasError=!0}finally{vr($)}}async title(){return await this.isolatedRealm().evaluate(()=>document.title)}},H=new WeakMap,N=new WeakSet,na=function(){return n(this,H)||p(this,H,this.mainRealm().evaluateHandle(()=>document)),n(this,H)},(()=>{const A=typeof Symbol=="function"&&Symbol.metadata?Object.create(s[Symbol.metadata]??null):void 0;e=[le],t=[le],i=[le],a=[le],o=[le],c=[le],l=[le],u=[le],f=[le],w=[le],h=[le],g=[le],S=[le],m=[le],v=[le],T=[le],D=[le],P=[le],M=[le],U=[le],ye(L,null,e,{kind:"method",name:"frameElement",static:!1,private:!1,access:{has:k=>"frameElement"in k,get:k=>k.frameElement},metadata:A},null,r),ye(L,null,t,{kind:"method",name:"evaluateHandle",static:!1,private:!1,access:{has:k=>"evaluateHandle"in k,get:k=>k.evaluateHandle},metadata:A},null,r),ye(L,null,i,{kind:"method",name:"evaluate",static:!1,private:!1,access:{has:k=>"evaluate"in k,get:k=>k.evaluate},metadata:A},null,r),ye(L,null,a,{kind:"method",name:"locator",static:!1,private:!1,access:{has:k=>"locator"in k,get:k=>k.locator},metadata:A},null,r),ye(L,null,o,{kind:"method",name:"$",static:!1,private:!1,access:{has:k=>"$"in k,get:k=>k.$},metadata:A},null,r),ye(L,null,c,{kind:"method",name:"$$",static:!1,private:!1,access:{has:k=>"$$"in k,get:k=>k.$$},metadata:A},null,r),ye(L,null,l,{kind:"method",name:"$eval",static:!1,private:!1,access:{has:k=>"$eval"in k,get:k=>k.$eval},metadata:A},null,r),ye(L,null,u,{kind:"method",name:"$$eval",static:!1,private:!1,access:{has:k=>"$$eval"in k,get:k=>k.$$eval},metadata:A},null,r),ye(L,null,f,{kind:"method",name:"waitForSelector",static:!1,private:!1,access:{has:k=>"waitForSelector"in k,get:k=>k.waitForSelector},metadata:A},null,r),ye(L,null,w,{kind:"method",name:"waitForFunction",static:!1,private:!1,access:{has:k=>"waitForFunction"in k,get:k=>k.waitForFunction},metadata:A},null,r),ye(L,null,h,{kind:"method",name:"content",static:!1,private:!1,access:{has:k=>"content"in k,get:k=>k.content},metadata:A},null,r),ye(L,null,g,{kind:"method",name:"addScriptTag",static:!1,private:!1,access:{has:k=>"addScriptTag"in k,get:k=>k.addScriptTag},metadata:A},null,r),ye(L,null,S,{kind:"method",name:"addStyleTag",static:!1,private:!1,access:{has:k=>"addStyleTag"in k,get:k=>k.addStyleTag},metadata:A},null,r),ye(L,null,m,{kind:"method",name:"click",static:!1,private:!1,access:{has:k=>"click"in k,get:k=>k.click},metadata:A},null,r),ye(L,null,v,{kind:"method",name:"focus",static:!1,private:!1,access:{has:k=>"focus"in k,get:k=>k.focus},metadata:A},null,r),ye(L,null,T,{kind:"method",name:"hover",static:!1,private:!1,access:{has:k=>"hover"in k,get:k=>k.hover},metadata:A},null,r),ye(L,null,D,{kind:"method",name:"select",static:!1,private:!1,access:{has:k=>"select"in k,get:k=>k.select},metadata:A},null,r),ye(L,null,P,{kind:"method",name:"tap",static:!1,private:!1,access:{has:k=>"tap"in k,get:k=>k.tap},metadata:A},null,r),ye(L,null,M,{kind:"method",name:"type",static:!1,private:!1,access:{has:k=>"type"in k,get:k=>k.type},metadata:A},null,r),ye(L,null,U,{kind:"method",name:"title",static:!1,private:!1,access:{has:k=>"title"in k,get:k=>k.title},metadata:A},null,r),A&&Object.defineProperty(L,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:A})})(),L})();var Ws,Lc;class qd{constructor(){d(this,Ws);F(this,"_interceptionId");F(this,"_failureText",null);F(this,"_response",null);F(this,"_fromMemoryCache",!1);F(this,"_redirectChain",[]);F(this,"interception",{enabled:!1,handled:!1,handlers:[],resolutionState:{action:Mt.None},requestOverrides:{},response:null,abortReason:null})}continueRequestOverrides(){return x(this.interception.enabled,"Request Interception is not enabled!"),this.interception.requestOverrides}responseForRequest(){return x(this.interception.enabled,"Request Interception is not enabled!"),this.interception.response}abortErrorReason(){return x(this.interception.enabled,"Request Interception is not enabled!"),this.interception.abortReason}interceptResolutionState(){return this.interception.enabled?this.interception.handled?{action:Mt.AlreadyHandled}:{...this.interception.resolutionState}:{action:Mt.Disabled}}isInterceptResolutionHandled(){return this.interception.handled}enqueueInterceptAction(r){this.interception.handlers.push(r)}async finalizeInterceptions(){await this.interception.handlers.reduce((e,t)=>e.then(t),Promise.resolve()),this.interception.handlers=[];const{action:r}=this.interceptResolutionState();switch(r){case"abort":return await this._abort(this.interception.abortReason);case"respond":if(this.interception.response===null)throw new Error("Response is missing for the interception");return await this._respond(this.interception.response);case"continue":return await this._continue(this.interception.requestOverrides)}}async continue(r={},e){if(b(this,Ws,Lc).call(this)){if(x(this.interception.enabled,"Request Interception is not enabled!"),x(!this.interception.handled,"Request is already handled!"),e===void 0)return await this._continue(r);if(this.interception.requestOverrides=r,this.interception.resolutionState.priority===void 0||e>this.interception.resolutionState.priority){this.interception.resolutionState={action:Mt.Continue,priority:e};return}if(e===this.interception.resolutionState.priority){if(this.interception.resolutionState.action==="abort"||this.interception.resolutionState.action==="respond")return;this.interception.resolutionState.action=Mt.Continue}}}async respond(r,e){if(b(this,Ws,Lc).call(this)){if(x(this.interception.enabled,"Request Interception is not enabled!"),x(!this.interception.handled,"Request is already handled!"),e===void 0)return await this._respond(r);if(this.interception.response=r,this.interception.resolutionState.priority===void 0||e>this.interception.resolutionState.priority){this.interception.resolutionState={action:Mt.Respond,priority:e};return}if(e===this.interception.resolutionState.priority){if(this.interception.resolutionState.action==="abort")return;this.interception.resolutionState.action=Mt.Respond}}}async abort(r="failed",e){if(!b(this,Ws,Lc).call(this))return;const t=ty[r];if(x(t,"Unknown error code: "+r),x(this.interception.enabled,"Request Interception is not enabled!"),x(!this.interception.handled,"Request is already handled!"),e===void 0)return await this._abort(t);if(this.interception.abortReason=t,this.interception.resolutionState.priority===void 0||e>=this.interception.resolutionState.priority){this.interception.resolutionState={action:Mt.Abort,priority:e};return}}static getResponse(r){const e=gs(r)?new TextEncoder().encode(r):r;return{contentLength:e.byteLength,base64:zh(e)}}}Ws=new WeakSet,Lc=function(){return!this.url().startsWith("data:")&&!this._fromMemoryCache};var Mt;(function(s){s.Abort="abort",s.Respond="respond",s.Continue="continue",s.Disabled="disabled",s.None="none",s.AlreadyHandled="already-handled"})(Mt||(Mt={}));function Ud(s){const r=[];for(const e in s){const t=s[e];if(!Object.is(t,void 0)){const i=Array.isArray(t)?t:[t];r.push(...i.map(a=>({name:e,value:a+""})))}}return r}const ey={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Switch Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"},ty={aborted:"Aborted",accessdenied:"AccessDenied",addressunreachable:"AddressUnreachable",blockedbyclient:"BlockedByClient",blockedbyresponse:"BlockedByResponse",connectionaborted:"ConnectionAborted",connectionclosed:"ConnectionClosed",connectionfailed:"ConnectionFailed",connectionrefused:"ConnectionRefused",connectionreset:"ConnectionReset",internetdisconnected:"InternetDisconnected",namenotresolved:"NameNotResolved",timedout:"TimedOut",failed:"Failed"};function Kl(s){if(s.originalMessage.includes("Invalid header")||s.originalMessage.includes("Unsafe header")||s.originalMessage.includes('Expected "header"')||s.originalMessage.includes("invalid argument"))throw s;B(s)}/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class ry{constructor(){}ok(){const r=this.status();return r===0||r>=200&&r<=299}async buffer(){const r=await this.content();return Buffer.from(r)}async text(){const r=await this.content();return new TextDecoder().decode(r)}async json(){const r=await this.text();return JSON.parse(r)}}/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */function pf(){let s=0;return()=>++s}/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class iy{constructor(){}}const Re=Object.freeze({Left:"left",Right:"right",Middle:"middle",Back:"back",Forward:"forward"});class sy{constructor(){}}class ny{constructor(){F(this,"idGenerator",pf());F(this,"touches",[])}removeHandle(r){const e=this.touches.indexOf(r);e!==-1&&this.touches.splice(e,1)}async tap(r,e){await(await this.touchStart(r,e)).end()}async touchMove(r,e){const t=this.touches[0];if(!t)throw new Xl("Must start a new Touch first");return await t.move(r,e)}async touchEnd(){const r=this.touches.shift();if(!r)throw new Xl("Must start a new Touch first");await r.end()}}/**
 * @license
 * Copyright 2019 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const Hd=3e4;var Yt,Si;class gd{constructor(){d(this,Yt);d(this,Si);p(this,Yt,null),p(this,Si,null)}setDefaultTimeout(r){p(this,Yt,r)}setDefaultNavigationTimeout(r){p(this,Si,r)}navigationTimeout(){return n(this,Si)!==null?n(this,Si):n(this,Yt)!==null?n(this,Yt):Hd}timeout(){return n(this,Yt)!==null?n(this,Yt):Hd}}Yt=new WeakMap,Si=new WeakMap;/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var ay=function(s,r,e){for(var t=arguments.length>2,i=0;i<r.length;i++)e=t?r[i].call(s,e):r[i].call(s);return t?e:void 0},oy=function(s,r,e,t,i,a){function o(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var c=t.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!r&&s?t.static?s:s.prototype:null,f=r||(u?Object.getOwnPropertyDescriptor(u,t.name):{}),w,h=!1,g=e.length-1;g>=0;g--){var S={};for(var m in t)S[m]=m==="access"?{}:t[m];for(var m in t.access)S.access[m]=t.access[m];S.addInitializer=function(T){if(h)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(T||null))};var v=(0,e[g])(c==="accessor"?{get:f.get,set:f.set}:f[l],S);if(c==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(w=o(v.get))&&(f.get=w),(w=o(v.set))&&(f.set=w),(w=o(v.init))&&i.unshift(w)}else(w=o(v))&&(c==="field"?i.unshift(w):f[l]=w)}u&&Object.defineProperty(u,t.name,f),h=!0},$l=function(s,r,e){if(r!=null){if(typeof r!="object"&&typeof r!="function")throw new TypeError("Object expected.");var t,i;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");t=r[Symbol.asyncDispose]}if(t===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");t=r[Symbol.dispose],e&&(i=t)}if(typeof t!="function")throw new TypeError("Object not disposable.");i&&(t=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),s.stack.push({value:r,dispose:t,async:e})}else e&&s.stack.push({async:!0});return r},Gd=function(s){return function(r){function e(o){r.error=r.hasError?new s(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,i=0;function a(){for(;t=r.stack.pop();)try{if(!t.async&&i===1)return i=0,r.stack.push(t),Promise.resolve().then(a);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return i|=2,Promise.resolve(o).then(a,function(c){return e(c),a()})}else i|=1}catch(c){e(c)}if(i===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return a()}}(typeof SuppressedError=="function"?SuppressedError:function(s,r,e){var t=new Error(e);return t.name="SuppressedError",t.error=s,t.suppressed=r,t});function cy(s){s.optimizeForSpeed??(s.optimizeForSpeed=!1),s.type??(s.type="png"),s.fromSurface??(s.fromSurface=!0),s.fullPage??(s.fullPage=!1),s.omitBackground??(s.omitBackground=!1),s.encoding??(s.encoding="binary"),s.captureBeyondViewport??(s.captureBeyondViewport=!0)}let ly=(()=>{var t,i,a,o,c,mf,u;let s=pe,r=[],e;return u=class extends s{constructor(){super();d(this,c);F(this,"_isDragging",(ay(this,r),!1));F(this,"_timeoutSettings",new gd);d(this,t,new WeakMap);d(this,i,new sm(1));d(this,a,0);d(this,o);Se(this,"request").pipe(_e(h=>zl(xd(1),fa(Se(this,"requestfailed"),Se(this,"requestfinished"),Se(this,"response").pipe(Ue(g=>g.request()))).pipe(Qn(g=>g.id===h.id),hd(1),Ue(()=>-1)))),Jm((h,g)=>xd(h+g),0),Ym(Se(this,"close")),Xm(0)).subscribe(n(this,i))}on(h,g){if(h!=="request")return super.on(h,g);let S=n(this,t).get(g);return S===void 0&&(S=m=>{m.enqueueInterceptAction(()=>g(m))},n(this,t).set(g,S)),super.on(h,S)}off(h,g){return h==="request"&&(g=n(this,t).get(g)||g),super.off(h,g)}get accessibility(){return this.mainFrame().accessibility}locator(h){return typeof h=="string"?sl.create(this,h):tl.create(this,h)}locatorRace(h){return Yn.race(h)}async $(h){return await this.mainFrame().$(h)}async $$(h,g){return await this.mainFrame().$$(h,g)}async evaluateHandle(h,...g){return h=Ie(this.evaluateHandle.name,h),await this.mainFrame().evaluateHandle(h,...g)}async $eval(h,g,...S){return g=Ie(this.$eval.name,g),await this.mainFrame().$eval(h,g,...S)}async $$eval(h,g,...S){return g=Ie(this.$$eval.name,g),await this.mainFrame().$$eval(h,g,...S)}async addScriptTag(h){return await this.mainFrame().addScriptTag(h)}async addStyleTag(h){return await this.mainFrame().addStyleTag(h)}url(){return this.mainFrame().url()}async content(){return await this.mainFrame().content()}async setContent(h,g){await this.mainFrame().setContent(h,g)}async goto(h,g){return await this.mainFrame().goto(h,g)}async waitForNavigation(h={}){return await this.mainFrame().waitForNavigation(h)}waitForRequest(h,g={}){const{timeout:S=this._timeoutSettings.timeout(),signal:m}=g;if(typeof h=="string"){const T=h;h=D=>D.url()===T}const v=Se(this,"request").pipe(oa(h),Wt(Bt(S),bs(m),Se(this,"close").pipe(Ue(()=>{throw new ti("Page closed!")}))));return Je(v)}waitForResponse(h,g={}){const{timeout:S=this._timeoutSettings.timeout(),signal:m}=g;if(typeof h=="string"){const T=h;h=D=>D.url()===T}const v=Se(this,"response").pipe(oa(h),Wt(Bt(S),bs(m),Se(this,"close").pipe(Ue(()=>{throw new ti("Page closed!")}))));return Je(v)}waitForNetworkIdle(h={}){return Je(this.waitForNetworkIdle$(h))}waitForNetworkIdle$(h={}){const{timeout:g=this._timeoutSettings.timeout(),idleTime:S=dg,concurrency:m=0,signal:v}=h;return n(this,i).pipe(Qm(T=>T>m?cs:dd(S)),Ue(()=>{}),Wt(Bt(g),bs(v),Se(this,"close").pipe(Ue(()=>{throw new ti("Page closed!")}))))}async waitForFrame(h,g={}){const{timeout:S=this.getDefaultTimeout(),signal:m}=g,v=gs(h)?T=>h===T.url():h;return await Je(fa(Se(this,"frameattached"),Se(this,"framenavigated"),se(this.frames())).pipe(oa(v),Xc(),Wt(Bt(S),bs(m),Se(this,"close").pipe(Ue(()=>{throw new ti("Page closed.")})))))}async emulate(h){await Promise.all([this.setUserAgent(h.userAgent),this.setViewport(h.viewport)])}async evaluate(h,...g){return h=Ie(this.evaluate.name,h),await this.mainFrame().evaluate(h,...g)}async _maybeWriteTypedArrayToFile(h,g){h&&await ls.value.fs.promises.writeFile(h,g)}async screencast(h={}){const g=ls.value.ScreenRecorder,[S,m,v]=await b(this,c,mf).call(this);let T;if(h.crop){const{x:P,y:M,width:U,height:H}=zd(Vd(h.crop));if(P<0||M<0)throw new Error("`crop.x` and `crop.y` must be greater than or equal to 0.");if(U<=0||H<=0)throw new Error("`crop.height` and `crop.width` must be greater than or equal to 0.");const N=S/v,G=m/v;if(P+U>N)throw new Error(`\`crop.width\` cannot be larger than the viewport width (${N}).`);if(M+H>G)throw new Error(`\`crop.height\` cannot be larger than the viewport height (${G}).`);T={x:P*v,y:M*v,width:U*v,height:H*v}}if(h.speed!==void 0&&h.speed<=0)throw new Error("`speed` must be greater than 0.");if(h.scale!==void 0&&h.scale<=0)throw new Error("`scale` must be greater than 0.");const D=new g(this,S,m,{...h,path:h.ffmpegPath,crop:T});try{await this._startScreencast()}catch(P){throw D.stop(),P}if(h.path){const{createWriteStream:P}=ls.value.fs,M=P(h.path,"binary");D.pipe(M)}return D}async _startScreencast(){++Zn(this,a)._,n(this,o)||p(this,o,this.mainFrame().client.send("Page.startScreencast",{format:"png"}).then(()=>new Promise(h=>this.mainFrame().client.once("Page.screencastFrame",()=>h())))),await n(this,o)}async _stopScreencast(){--Zn(this,a)._,n(this,o)&&(p(this,o,void 0),n(this,a)===0&&await this.mainFrame().client.send("Page.stopScreencast"))}async screenshot(h={}){const g={stack:[],error:void 0,hasError:!1};try{const S=$l(g,await this.browserContext().startScreenshot(),!1),m={...h,clip:h.clip?{...h.clip}:void 0};if(m.type===void 0&&m.path!==void 0){const P=m.path;switch(P.slice(P.lastIndexOf(".")+1).toLowerCase()){case"png":m.type="png";break;case"jpeg":case"jpg":m.type="jpeg";break;case"webp":m.type="webp";break}}if(m.quality!==void 0){if(m.quality<0||m.quality>100)throw new Error(`Expected 'quality' (${m.quality}) to be between 0 and 100, inclusive.`);if(m.type===void 0||!["jpeg","webp"].includes(m.type))throw new Error(`${m.type??"png"} screenshots do not support 'quality'.`)}if(m.clip){if(m.clip.width<=0)throw new Error("'width' in 'clip' must be positive.");if(m.clip.height<=0)throw new Error("'height' in 'clip' must be positive.")}cy(m);const v=$l(g,new Qc,!0);if(m.clip){if(m.fullPage)throw new Error("'clip' and 'fullPage' are mutually exclusive");m.clip=zd(Vd(m.clip))}else if(m.fullPage){if(!m.captureBeyondViewport){const P=await this.mainFrame().isolatedRealm().evaluate(()=>{const U=document.documentElement;return{width:U.scrollWidth,height:U.scrollHeight}}),M=this.viewport();await this.setViewport({...M,...P}),v.defer(async()=>{await this.setViewport(M).catch(B)})}}else m.captureBeyondViewport=!1;const T=await this._screenshot(m);if(m.encoding==="base64")return T;const D=Vh(T,!0);return await this._maybeWriteTypedArrayToFile(m.path,D),D}catch(S){g.error=S,g.hasError=!0}finally{const S=Gd(g);S&&await S}}async title(){return await this.mainFrame().title()}click(h,g){return this.mainFrame().click(h,g)}focus(h){return this.mainFrame().focus(h)}hover(h){return this.mainFrame().hover(h)}select(h,...g){return this.mainFrame().select(h,...g)}tap(h){return this.mainFrame().tap(h)}type(h,g,S){return this.mainFrame().type(h,g,S)}async waitForSelector(h,g={}){return await this.mainFrame().waitForSelector(h,g)}waitForFunction(h,g,...S){return this.mainFrame().waitForFunction(h,g,...S)}[(e=[jg(function(){return this.browser()})],oe)](){return void this.close().catch(B)}[bt](){return this.close()}},t=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,c=new WeakSet,mf=async function(){const h={stack:[],error:void 0,hasError:!1};try{const g=this.viewport(),S=$l(h,new qt,!1);return g&&g.deviceScaleFactor!==0&&(await this.setViewport({...g,deviceScaleFactor:0}),S.defer(()=>{this.setViewport(g).catch(B)})),await this.mainFrame().isolatedRealm().evaluate(()=>[window.visualViewport.width*window.devicePixelRatio,window.visualViewport.height*window.devicePixelRatio,window.devicePixelRatio])}catch(g){h.error=g,h.hasError=!0}finally{Gd(h)}},(()=>{const h=typeof Symbol=="function"&&Symbol.metadata?Object.create(s[Symbol.metadata]??null):void 0;oy(u,null,e,{kind:"method",name:"screenshot",static:!1,private:!1,access:{has:g=>"screenshot"in g,get:g=>g.screenshot},metadata:h},null,r),h&&Object.defineProperty(u,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h})})(),u})();function Vd(s){return{...s,...s.width<0?{x:s.x+s.width,width:-s.width}:{x:s.x,width:s.width},...s.height<0?{y:s.y+s.height,height:-s.height}:{y:s.y,height:s.height}}}function zd(s){const r=Math.round(s.x),e=Math.round(s.y),t=Math.round(s.width+s.x-r),i=Math.round(s.height+s.y-e);return{...s,x:r,y:e,width:t,height:i}}/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Zt,Bs,Fa,Cr,ki,Da,Oa,Ei,et,Ti,js,xa;class uy{constructor(r,e,t,...i){d(this,Zt);d(this,Bs);d(this,Fa);d(this,Cr);d(this,ki);d(this,Da);d(this,Oa);d(this,Ei,ue.create());d(this,et);d(this,Ti);d(this,js,[]);d(this,xa,()=>{var r;this.terminate((r=n(this,Ti))==null?void 0:r.reason)});var a;switch(p(this,Zt,r),p(this,Bs,e.polling),p(this,Fa,e.root),p(this,Ti,e.signal),(a=n(this,Ti))==null||a.addEventListener("abort",n(this,xa),{once:!0}),typeof t){case"string":p(this,Cr,`() => {return (${t});}`);break;default:p(this,Cr,ii(t));break}p(this,ki,i),n(this,Zt).taskManager.add(this),e.timeout&&(p(this,Oa,new pd(`Waiting failed: ${e.timeout}ms exceeded`)),p(this,Da,setTimeout(()=>{this.terminate(n(this,Oa))},e.timeout))),this.rerun()}get result(){return n(this,Ei).valueOrThrow()}async rerun(){for(const e of n(this,js))e.abort();n(this,js).length=0;const r=new AbortController;n(this,js).push(r);try{switch(n(this,Bs)){case"raf":p(this,et,await n(this,Zt).evaluateHandle(({RAFPoller:t,createFunction:i},a,...o)=>{const c=i(a);return new t(()=>c(...o))},St.create(t=>t.puppeteerUtil),n(this,Cr),...n(this,ki)));break;case"mutation":p(this,et,await n(this,Zt).evaluateHandle(({MutationPoller:t,createFunction:i},a,o,...c)=>{const l=i(o);return new t(()=>l(...c),a||document)},St.create(t=>t.puppeteerUtil),n(this,Fa),n(this,Cr),...n(this,ki)));break;default:p(this,et,await n(this,Zt).evaluateHandle(({IntervalPoller:t,createFunction:i},a,o,...c)=>{const l=i(o);return new t(()=>l(...c),a)},St.create(t=>t.puppeteerUtil),n(this,Bs),n(this,Cr),...n(this,ki)));break}await n(this,et).evaluate(t=>{t.start()});const e=await n(this,et).evaluateHandle(t=>t.result());n(this,Ei).resolve(e),await this.terminate()}catch(e){if(r.signal.aborted)return;const t=this.getBadError(e);t&&await this.terminate(t)}}async terminate(r){var e;if(n(this,Zt).taskManager.delete(this),(e=n(this,Ti))==null||e.removeEventListener("abort",n(this,xa)),clearTimeout(n(this,Da)),r&&!n(this,Ei).finished()&&n(this,Ei).reject(r),n(this,et))try{await n(this,et).evaluate(async t=>{await t.stop()}),n(this,et)&&(await n(this,et).dispose(),p(this,et,void 0))}catch{}}getBadError(r){return Ut(r)?r.message.includes("Execution context is not available in detached frame")?new Error("Waiting failed: Frame detached"):r.message.includes("Execution context was destroyed")||r.message.includes("Cannot find context with specified id")||r.message.includes("DiscardedBrowsingContextError")?void 0:r:new Error("WaitTask failed with an error",{cause:r})}}Zt=new WeakMap,Bs=new WeakMap,Fa=new WeakMap,Cr=new WeakMap,ki=new WeakMap,Da=new WeakMap,Oa=new WeakMap,Ei=new WeakMap,et=new WeakMap,Ti=new WeakMap,js=new WeakMap,xa=new WeakMap;var Pr;class dy{constructor(){d(this,Pr,new Set)}add(r){n(this,Pr).add(r)}delete(r){n(this,Pr).delete(r)}terminateAll(r){for(const e of n(this,Pr))e.terminate(r);n(this,Pr).clear()}async rerunAll(){await Promise.all([...n(this,Pr)].map(r=>r.rerun()))}}Pr=new WeakMap;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Ra;class hy{constructor(r){F(this,"timeoutSettings");F(this,"taskManager",new dy);d(this,Ra,!1);this.timeoutSettings=r}async waitForFunction(r,e={},...t){const{polling:i="raf",timeout:a=this.timeoutSettings.timeout(),root:o,signal:c}=e;if(typeof i=="number"&&i<0)throw new Error("Cannot poll with non-positive interval");return await new uy(this,{polling:i,root:o,timeout:a,signal:c},r,...t).result}get disposed(){return n(this,Ra)}dispose(){p(this,Ra,!0),this.taskManager.terminateAll(new Error("waitForFunction failed: frame got detached."))}[oe](){this.dispose()}}Ra=new WeakMap;/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var at;(function(s){s.PAGE="page",s.BACKGROUND_PAGE="background_page",s.SERVICE_WORKER="service_worker",s.SHARED_WORKER="shared_worker",s.BROWSER="browser",s.WEBVIEW="webview",s.OTHER="other",s.TAB="tab"})(at||(at={}));class fy{constructor(){}async worker(){return null}async page(){return null}}/**
 * @license
 * Copyright 2018 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var La;class py extends pe{constructor(e){super();F(this,"timeoutSettings",new gd);d(this,La);p(this,La,e)}url(){return n(this,La)}async evaluate(e,...t){return e=Ie(this.evaluate.name,e),await this.mainRealm().evaluate(e,...t)}async evaluateHandle(e,...t){return e=Ie(this.evaluateHandle.name,e),await this.mainRealm().evaluateHandle(e,...t)}async close(){throw new md("WebWorker.close() is not supported")}}La=new WeakMap;/**
 * @license
 * Copyright 2018 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var my=function(s,r,e){if(r!=null){if(typeof r!="object"&&typeof r!="function")throw new TypeError("Object expected.");var t,i;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");t=r[Symbol.asyncDispose]}if(t===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");t=r[Symbol.dispose],e&&(i=t)}if(typeof t!="function")throw new TypeError("Object not disposable.");i&&(t=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),s.stack.push({value:r,dispose:t,async:e})}else e&&s.stack.push({async:!0});return r},gy=function(s){return function(r){function e(o){r.error=r.hasError?new s(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,i=0;function a(){for(;t=r.stack.pop();)try{if(!t.async&&i===1)return i=0,r.stack.push(t),Promise.resolve().then(a);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return i|=2,Promise.resolve(o).then(a,function(c){return e(c),a()})}else i|=1}catch(c){e(c)}if(i===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return a()}}(typeof SuppressedError=="function"?SuppressedError:function(s,r,e){var t=new Error(e);return t.name="SuppressedError",t.error=s,t.suppressed=r,t}),_r,Na;class yy{constructor(r,e=""){d(this,_r);d(this,Na);p(this,_r,r),p(this,Na,e)}async snapshot(r={}){const{interestingOnly:e=!0,root:t=null,includeIframes:i=!1}=r,{nodes:a}=await n(this,_r).environment.client.send("Accessibility.getFullAXTree",{frameId:n(this,Na)});let o;if(t){const{node:w}=await n(this,_r).environment.client.send("DOM.describeNode",{objectId:t.id});o=w.backendNodeId}const c=du.createTree(n(this,_r),a),l=async w=>{var h;if(((h=w.payload.role)==null?void 0:h.value)==="Iframe"){const g={stack:[],error:void 0,hasError:!1};try{if(!w.payload.backendDOMNodeId)return;const S=my(g,await n(this,_r).adoptBackendNode(w.payload.backendDOMNodeId),!1);if(!S||!("contentFrame"in S))return;const m=await S.contentFrame();if(!m)return;const v=await m.accessibility.snapshot(r);w.iframeSnapshot=v??void 0}catch(S){g.error=S,g.hasError=!0}finally{gy(g)}}for(const g of w.children)await l(g)};let u=c;if(!c||(i&&await l(c),o&&(u=c.find(w=>w.payload.backendDOMNodeId===o)),!u))return null;if(!e)return this.serializeTree(u)[0]??null;const f=new Set;return this.collectInterestingNodes(f,c,!1),f.has(u)?this.serializeTree(u,f)[0]??null:null}serializeTree(r,e){const t=[];for(const a of r.children)t.push(...this.serializeTree(a,e));if(e&&!e.has(r))return t;const i=r.serialize();return t.length&&(i.children=t),r.iframeSnapshot&&(i.children||(i.children=[]),i.children.push(r.iframeSnapshot)),[i]}collectInterestingNodes(r,e,t){if((e.isInteresting(t)||e.iframeSnapshot)&&r.add(e),!e.isLeafNode()){t=t||e.isControl();for(const i of e.children)this.collectInterestingNodes(r,i,t)}}}_r=new WeakMap,Na=new WeakMap;var qs,Ka,Ci,$a,Pi,tt,Wa,_i,Ba,gr,gf,yf,hu;const Td=class Td{constructor(r,e){d(this,gr);F(this,"payload");F(this,"children",[]);F(this,"iframeSnapshot");d(this,qs,!1);d(this,Ka,!1);d(this,Ci,!1);d(this,$a,!1);d(this,Pi);d(this,tt);d(this,Wa);d(this,_i);d(this,Ba);this.payload=e,p(this,Pi,this.payload.name?this.payload.name.value:""),p(this,tt,this.payload.role?this.payload.role.value:"Unknown"),p(this,Wa,this.payload.ignored),p(this,Ba,r);for(const t of this.payload.properties||[])t.name==="editable"&&(p(this,qs,t.value.value==="richtext"),p(this,Ka,!0)),t.name==="focusable"&&p(this,Ci,t.value.value),t.name==="hidden"&&p(this,$a,t.value.value)}find(r){if(r(this))return this;for(const e of this.children){const t=e.find(r);if(t)return t}return null}isLeafNode(){if(!this.children.length||b(this,gr,gf).call(this)||b(this,gr,yf).call(this))return!0;switch(n(this,tt)){case"doc-cover":case"graphics-symbol":case"img":case"image":case"Meter":case"scrollbar":case"slider":case"separator":case"progressbar":return!0}return b(this,gr,hu).call(this)?!1:!!(n(this,Ci)&&n(this,Pi)||n(this,tt)==="heading"&&n(this,Pi))}isControl(){switch(n(this,tt)){case"button":case"checkbox":case"ColorWell":case"combobox":case"DisclosureTriangle":case"listbox":case"menu":case"menubar":case"menuitem":case"menuitemcheckbox":case"menuitemradio":case"radio":case"scrollbar":case"searchbox":case"slider":case"spinbutton":case"switch":case"tab":case"textbox":case"tree":case"treeitem":return!0;default:return!1}}isInteresting(r){return n(this,tt)==="Ignored"||n(this,$a)||n(this,Wa)?!1:n(this,Ci)||n(this,qs)||this.isControl()?!0:r?!1:this.isLeafNode()&&!!n(this,Pi)}serialize(){const r=new Map;for(const h of this.payload.properties||[])r.set(h.name.toLowerCase(),h.value.value);this.payload.name&&r.set("name",this.payload.name.value),this.payload.value&&r.set("value",this.payload.value.value),this.payload.description&&r.set("description",this.payload.description.value);const e={role:n(this,tt),elementHandle:async()=>this.payload.backendDOMNodeId?await n(this,Ba).adoptBackendNode(this.payload.backendDOMNodeId):null},t=["name","value","description","keyshortcuts","roledescription","valuetext"],i=h=>r.get(h);for(const h of t)r.has(h)&&(e[h]=i(h));const a=["disabled","expanded","focused","modal","multiline","multiselectable","readonly","required","selected"],o=h=>r.get(h);for(const h of a)h==="focused"&&n(this,tt)==="RootWebArea"||!o(h)||(e[h]=o(h));const c=["checked","pressed"];for(const h of c){if(!r.has(h))continue;const g=r.get(h);e[h]=g==="mixed"?"mixed":g==="true"}const l=["level","valuemax","valuemin"],u=h=>r.get(h);for(const h of l)r.has(h)&&(e[h]=u(h));const f=["autocomplete","haspopup","invalid","orientation"],w=h=>r.get(h);for(const h of f){const g=w(h);!g||g==="false"||(e[h]=w(h))}return e}static createTree(r,e){const t=new Map;for(const i of e)t.set(i.nodeId,new Td(r,i));for(const i of t.values())for(const a of i.payload.childIds||[]){const o=t.get(a);o&&i.children.push(o)}return t.values().next().value??null}};qs=new WeakMap,Ka=new WeakMap,Ci=new WeakMap,$a=new WeakMap,Pi=new WeakMap,tt=new WeakMap,Wa=new WeakMap,_i=new WeakMap,Ba=new WeakMap,gr=new WeakSet,gf=function(){return n(this,qs)?!1:n(this,Ka)?!0:n(this,tt)==="textbox"||n(this,tt)==="searchbox"},yf=function(){const r=n(this,tt);return r==="LineBreak"||r==="text"||r==="InlineTextBox"||r==="StaticText"},hu=function(){var r;if(n(this,_i)===void 0){p(this,_i,!1);for(const e of this.children)if(n(e,Ci)||b(r=e,gr,hu).call(r)){p(this,_i,!0);break}}return n(this,_i)};let du=Td;var wy=function(s,r,e){if(r!=null){if(typeof r!="object"&&typeof r!="function")throw new TypeError("Object expected.");var t,i;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");t=r[Symbol.asyncDispose]}if(t===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");t=r[Symbol.dispose],e&&(i=t)}if(typeof t!="function")throw new TypeError("Object not disposable.");i&&(t=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),s.stack.push({value:r,dispose:t,async:e})}else e&&s.stack.push({async:!0});return r},vy=function(s){return function(r){function e(o){r.error=r.hasError?new s(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,i=0;function a(){for(;t=r.stack.pop();)try{if(!t.async&&i===1)return i=0,r.stack.push(t),Promise.resolve().then(a);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return i|=2,Promise.resolve(o).then(a,function(c){return e(c),a()})}else i|=1}catch(c){e(c)}if(i===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return a()}}(typeof SuppressedError=="function"?SuppressedError:function(s,r,e){var t=new Error(e);return t.name="SuppressedError",t.error=s,t.suppressed=r,t}),er,ja,qa;class nl{constructor(r,e,t){d(this,er);d(this,ja);d(this,qa);p(this,er,r),p(this,ja,e),p(this,qa,t)}get name(){return n(this,er)}get initSource(){return n(this,qa)}async run(r,e,t,i){const a=new qt;try{if(!i){const o={stack:[],error:void 0,hasError:!1};try{const l=await wy(o,await r.evaluateHandle((u,f)=>globalThis[u].args.get(f),n(this,er),e),!1).getProperties();for(const[u,f]of l)if(u in t)switch(f.remoteObject().subtype){case"node":t[+u]=f;break;default:a.use(f)}else a.use(f)}catch(c){o.error=c,o.hasError=!0}finally{vy(o)}}await r.evaluate((o,c,l)=>{const u=globalThis[o].callbacks;u.get(c).resolve(l),u.delete(c)},n(this,er),e,await n(this,ja).call(this,...t));for(const o of t)o instanceof Cs&&a.use(o)}catch(o){Ut(o)?await r.evaluate((c,l,u,f)=>{const w=new Error(u);w.stack=f;const h=globalThis[c].callbacks;h.get(l).reject(w),h.delete(l)},n(this,er),e,o.message,o.stack).catch(B):await r.evaluate((c,l,u)=>{const f=globalThis[c].callbacks;f.get(l).reject(u),f.delete(l)},n(this,er),e,o).catch(B)}}}er=new WeakMap,ja=new WeakMap,qa=new WeakMap;var yh,wh;const Cc=((wh=(yh=globalThis.browser)==null?void 0:yh.runtime)==null?void 0:wh.id)==null?globalThis.chrome:globalThis.browser;/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Ua,Ha,Ga,Us,Hs;class Jd{constructor(r,e,t,i,a){d(this,Ua);d(this,Ha);d(this,Ga);d(this,Us);d(this,Hs);p(this,Ua,r),p(this,Ha,e),p(this,Ga,t),p(this,Us,i),p(this,Hs,a)}type(){return n(this,Ua)}text(){return n(this,Ha)}args(){return n(this,Ga)}location(){return n(this,Us)[0]??(n(this,Hs)?{url:n(this,Hs).url()}:{})}stackTrace(){return n(this,Us)}}Ua=new WeakMap,Ha=new WeakMap,Ga=new WeakMap,Us=new WeakMap,Hs=new WeakMap;/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Gs,Va,Mi;class by{constructor(r,e){d(this,Gs);d(this,Va);d(this,Mi,!1);p(this,Gs,r),p(this,Va,e.mode!=="selectSingle")}isMultiple(){return n(this,Va)}async accept(r){x(!n(this,Mi),"Cannot accept FileChooser which is already handled!"),p(this,Mi,!0),await n(this,Gs).uploadFile(...r)}async cancel(){x(!n(this,Mi),"Cannot cancel FileChooser which is already handled!"),p(this,Mi,!0),await n(this,Gs).evaluate(r=>{r.dispatchEvent(new Event("cancel",{bubbles:!0}))})}}Gs=new WeakMap,Va=new WeakMap,Mi=new WeakMap;/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Me;(function(s){s.Request=Symbol("NetworkManager.Request"),s.RequestServedFromCache=Symbol("NetworkManager.RequestServedFromCache"),s.Response=Symbol("NetworkManager.Response"),s.RequestFailed=Symbol("NetworkManager.RequestFailed"),s.RequestFinished=Symbol("NetworkManager.RequestFinished")})(Me||(Me={}));/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var dt,ml;class wf{constructor(){d(this,dt,new Map);d(this,ml,pf())}create(r,e,t){const i=new Sy(n(this,ml).call(this),r,e);n(this,dt).set(i.id,i);try{t(i.id)}catch(a){throw i.promise.catch(B).finally(()=>{n(this,dt).delete(i.id)}),i.reject(a),a}return i.promise.finally(()=>{n(this,dt).delete(i.id)})}reject(r,e,t){const i=n(this,dt).get(r);i&&this._reject(i,e,t)}rejectRaw(r,e){const t=n(this,dt).get(r);t&&t.reject(e)}_reject(r,e,t){let i,a;e instanceof Gn?(i=e,i.cause=r.error,a=e.message):(i=r.error,a=e),r.reject(Zh(i,`Protocol error (${r.label}): ${a}`,t))}resolve(r,e){const t=n(this,dt).get(r);t&&t.resolve(e)}clear(){for(const r of n(this,dt).values())this._reject(r,new ti("Target closed"));n(this,dt).clear()}getPendingProtocolErrors(){const r=[];for(const e of n(this,dt).values())r.push(new Error(`${e.label} timed out. Trace: ${e.error.stack}`));return r}}dt=new WeakMap,ml=new WeakMap;var za,Ja,Ai,Vs,Xa;class Sy{constructor(r,e,t){d(this,za);d(this,Ja,new Gn);d(this,Ai,ue.create());d(this,Vs);d(this,Xa);p(this,za,r),p(this,Xa,e),t&&p(this,Vs,setTimeout(()=>{n(this,Ai).reject(Zh(n(this,Ja),`${e} timed out. Increase the 'protocolTimeout' setting in launch/connect calls for a higher timeout if needed.`))},t))}resolve(r){clearTimeout(n(this,Vs)),n(this,Ai).resolve(r)}reject(r){clearTimeout(n(this,Vs)),n(this,Ai).reject(r)}get id(){return n(this,za)}get promise(){return n(this,Ai).valueOrThrow()}get error(){return n(this,Ja)}get label(){return n(this,Xa)}}za=new WeakMap,Ja=new WeakMap,Ai=new WeakMap,Vs=new WeakMap,Xa=new WeakMap;/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Ii,zs,tr,rr,Js,Xs,Qa,Qs;class la extends Yl{constructor(e,t,i,a,o){super();d(this,Ii);d(this,zs);d(this,tr,new wf);d(this,rr);d(this,Js);d(this,Xs);d(this,Qa,!1);d(this,Qs,!1);p(this,rr,e),p(this,zs,t),p(this,Ii,i),p(this,Js,a),p(this,Qa,o)}setTarget(e){p(this,Xs,e)}target(){return x(n(this,Xs),"Target must exist"),n(this,Xs)}connection(){return n(this,rr)}get detached(){return n(this,rr)._closed||n(this,Qs)}parentSession(){var t;return n(this,Js)?((t=n(this,rr))==null?void 0:t.session(n(this,Js)))??void 0:this}send(e,t,i){return this.detached?Promise.reject(new ti(`Protocol error (${e}): Session closed. Most likely the ${n(this,zs)} has been closed.`)):n(this,rr)._rawSend(n(this,tr),e,t,n(this,Ii),i)}onMessage(e){e.id?e.error?n(this,Qa)?n(this,tr).rejectRaw(e.id,e.error):n(this,tr).reject(e.id,ef(e),e.error.message):n(this,tr).resolve(e.id,e.result):(x(!e.id),this.emit(e.method,e.params))}async detach(){if(this.detached)throw new Error(`Session already detached. Most likely the ${n(this,zs)} has been closed.`);await n(this,rr).send("Target.detachFromTarget",{sessionId:n(this,Ii)}),p(this,Qs,!0)}onClosed(){n(this,tr).clear(),p(this,Qs,!0),this.emit(fe.Disconnected,void 0)}id(){return n(this,Ii)}getPendingProtocolErrors(){return n(this,tr).getPendingProtocolErrors()}}Ii=new WeakMap,zs=new WeakMap,tr=new WeakMap,rr=new WeakMap,Js=new WeakMap,Xs=new WeakMap,Qa=new WeakMap,Qs=new WeakMap;/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const ky=fd("puppeteer:protocol:SEND "),Ey=fd("puppeteer:protocol:RECV ");var Ya,Ft,Fi,Ys,We,Di,Zs,Dt,en,Za,fu;class vf extends pe{constructor(e,t,i=0,a,o=!1){super();d(this,Za);d(this,Ya);d(this,Ft);d(this,Fi);d(this,Ys);d(this,We,new Map);d(this,Di,!1);d(this,Zs,new Set);d(this,Dt);d(this,en,!1);p(this,en,o),p(this,Dt,new wf),p(this,Ya,e),p(this,Fi,i),p(this,Ys,a??18e4),p(this,Ft,t),n(this,Ft).onmessage=this.onMessage.bind(this),n(this,Ft).onclose=b(this,Za,fu).bind(this)}static fromSession(e){return e.connection()}get delay(){return n(this,Fi)}get timeout(){return n(this,Ys)}get _closed(){return n(this,Di)}get _sessions(){return n(this,We)}_session(e){return n(this,We).get(e)||null}session(e){return this._session(e)}url(){return n(this,Ya)}send(e,t,i){return this._rawSend(n(this,Dt),e,t,void 0,i)}_rawSend(e,t,i,a,o){return n(this,Di)?Promise.reject(new Error("Protocol error: Connection closed.")):e.create(t,(o==null?void 0:o.timeout)??n(this,Ys),c=>{const l=JSON.stringify({method:t,params:i,id:c,sessionId:a});ky(l),n(this,Ft).send(l)})}async closeBrowser(){await this.send("Browser.close")}async onMessage(e){n(this,Fi)&&await new Promise(i=>setTimeout(i,n(this,Fi))),Ey(e);const t=JSON.parse(e);if(t.method==="Target.attachedToTarget"){const i=t.params.sessionId,a=new la(this,t.params.targetInfo.type,i,t.sessionId,n(this,en));n(this,We).set(i,a),this.emit(fe.SessionAttached,a);const o=n(this,We).get(t.sessionId);o&&o.emit(fe.SessionAttached,a)}else if(t.method==="Target.detachedFromTarget"){const i=n(this,We).get(t.params.sessionId);if(i){i.onClosed(),n(this,We).delete(t.params.sessionId),this.emit(fe.SessionDetached,i);const a=n(this,We).get(t.sessionId);a&&a.emit(fe.SessionDetached,i)}}if(t.sessionId){const i=n(this,We).get(t.sessionId);i&&i.onMessage(t)}else t.id?t.error?n(this,en)?n(this,Dt).rejectRaw(t.id,t.error):n(this,Dt).reject(t.id,ef(t),t.error.message):n(this,Dt).resolve(t.id,t.result):this.emit(t.method,t.params)}dispose(){b(this,Za,fu).call(this),n(this,Ft).close()}isAutoAttached(e){return!n(this,Zs).has(e)}async _createSession(e,t=!0){t||n(this,Zs).add(e.targetId);const{sessionId:i}=await this.send("Target.attachToTarget",{targetId:e.targetId,flatten:!0});n(this,Zs).delete(e.targetId);const a=n(this,We).get(i);if(!a)throw new Error("CDPSession creation failed.");return a}async createSession(e){return await this._createSession(e,!1)}getPendingProtocolErrors(){const e=[];e.push(...n(this,Dt).getPendingProtocolErrors());for(const t of n(this,We).values())e.push(...t.getPendingProtocolErrors());return e}}Ya=new WeakMap,Ft=new WeakMap,Fi=new WeakMap,Ys=new WeakMap,We=new WeakMap,Di=new WeakMap,Zs=new WeakMap,Dt=new WeakMap,en=new WeakMap,Za=new WeakSet,fu=function(){if(!n(this,Di)){p(this,Di,!0),n(this,Ft).onmessage=void 0,n(this,Ft).onclose=void 0,n(this,Dt).clear();for(const e of n(this,We).values())e.onClosed();n(this,We).clear(),this.emit(fe.Disconnected,void 0)}};function pu(s){return s instanceof ti}/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Oi,xi;class Ty{constructor(r){d(this,Oi);d(this,xi);p(this,Oi,new Cy(r)),p(this,xi,new Py(r))}updateClient(r){n(this,Oi).updateClient(r),n(this,xi).updateClient(r)}async startJSCoverage(r={}){return await n(this,Oi).start(r)}async stopJSCoverage(){return await n(this,Oi).stop()}async startCSSCoverage(r={}){return await n(this,xi).start(r)}async stopCSSCoverage(){return await n(this,xi).stop()}}Oi=new WeakMap,xi=new WeakMap;var Be,Ri,Li,Ni,tn,eo,rn,sn,Jn,bf,Sf;class Cy{constructor(r){d(this,Jn);d(this,Be);d(this,Ri,!1);d(this,Li,new Map);d(this,Ni,new Map);d(this,tn);d(this,eo,!1);d(this,rn,!1);d(this,sn,!1);p(this,Be,r)}updateClient(r){p(this,Be,r)}async start(r={}){x(!n(this,Ri),"JSCoverage is already enabled");const{resetOnNavigation:e=!0,reportAnonymousScripts:t=!1,includeRawScriptCoverage:i=!1,useBlockCoverage:a=!0}=r;p(this,eo,e),p(this,rn,t),p(this,sn,i),p(this,Ri,!0),n(this,Li).clear(),n(this,Ni).clear(),p(this,tn,new qt);const o=n(this,tn).use(new pe(n(this,Be)));o.on("Debugger.scriptParsed",b(this,Jn,Sf).bind(this)),o.on("Runtime.executionContextsCleared",b(this,Jn,bf).bind(this)),await Promise.all([n(this,Be).send("Profiler.enable"),n(this,Be).send("Profiler.startPreciseCoverage",{callCount:n(this,sn),detailed:a}),n(this,Be).send("Debugger.enable"),n(this,Be).send("Debugger.setSkipAllPauses",{skip:!0})])}async stop(){var i;x(n(this,Ri),"JSCoverage is not enabled"),p(this,Ri,!1);const r=await Promise.all([n(this,Be).send("Profiler.takePreciseCoverage"),n(this,Be).send("Profiler.stopPreciseCoverage"),n(this,Be).send("Profiler.disable"),n(this,Be).send("Debugger.disable")]);(i=n(this,tn))==null||i.dispose();const e=[],t=r[0];for(const a of t.result){let o=n(this,Li).get(a.scriptId);!o&&n(this,rn)&&(o="debugger://VM"+a.scriptId);const c=n(this,Ni).get(a.scriptId);if(c===void 0||o===void 0)continue;const l=[];for(const f of a.functions)l.push(...f.ranges);const u=Tf(l);n(this,sn)?e.push({url:o,ranges:u,text:c,rawScriptCoverage:a}):e.push({url:o,ranges:u,text:c})}return e}}Be=new WeakMap,Ri=new WeakMap,Li=new WeakMap,Ni=new WeakMap,tn=new WeakMap,eo=new WeakMap,rn=new WeakMap,sn=new WeakMap,Jn=new WeakSet,bf=function(){n(this,eo)&&(n(this,Li).clear(),n(this,Ni).clear())},Sf=async function(r){if(!pr.isPuppeteerURL(r.url)&&!(!r.url&&!n(this,rn)))try{const e=await n(this,Be).send("Debugger.getScriptSource",{scriptId:r.scriptId});n(this,Li).set(r.scriptId,r.url),n(this,Ni).set(r.scriptId,e.scriptSource)}catch(e){B(e)}};var rt,Ki,Mr,$i,nn,to,Xn,kf,Ef;class Py{constructor(r){d(this,Xn);d(this,rt);d(this,Ki,!1);d(this,Mr,new Map);d(this,$i,new Map);d(this,nn);d(this,to,!1);p(this,rt,r)}updateClient(r){p(this,rt,r)}async start(r={}){x(!n(this,Ki),"CSSCoverage is already enabled");const{resetOnNavigation:e=!0}=r;p(this,to,e),p(this,Ki,!0),n(this,Mr).clear(),n(this,$i).clear(),p(this,nn,new qt);const t=n(this,nn).use(new pe(n(this,rt)));t.on("CSS.styleSheetAdded",b(this,Xn,Ef).bind(this)),t.on("Runtime.executionContextsCleared",b(this,Xn,kf).bind(this)),await Promise.all([n(this,rt).send("DOM.enable"),n(this,rt).send("CSS.enable"),n(this,rt).send("CSS.startRuleUsageTracking")])}async stop(){var i;x(n(this,Ki),"CSSCoverage is not enabled"),p(this,Ki,!1);const r=await n(this,rt).send("CSS.stopRuleUsageTracking");await Promise.all([n(this,rt).send("CSS.disable"),n(this,rt).send("DOM.disable")]),(i=n(this,nn))==null||i.dispose();const e=new Map;for(const a of r.ruleUsage){let o=e.get(a.styleSheetId);o||(o=[],e.set(a.styleSheetId,o)),o.push({startOffset:a.startOffset,endOffset:a.endOffset,count:a.used?1:0})}const t=[];for(const a of n(this,Mr).keys()){const o=n(this,Mr).get(a);x(typeof o<"u",`Stylesheet URL is undefined (styleSheetId=${a})`);const c=n(this,$i).get(a);x(typeof c<"u",`Stylesheet text is undefined (styleSheetId=${a})`);const l=Tf(e.get(a)||[]);t.push({url:o,ranges:l,text:c})}return t}}rt=new WeakMap,Ki=new WeakMap,Mr=new WeakMap,$i=new WeakMap,nn=new WeakMap,to=new WeakMap,Xn=new WeakSet,kf=function(){n(this,to)&&(n(this,Mr).clear(),n(this,$i).clear())},Ef=async function(r){const e=r.header;if(e.sourceURL)try{const t=await n(this,rt).send("CSS.getStyleSheetText",{styleSheetId:e.styleSheetId});n(this,Mr).set(e.styleSheetId,e.sourceURL),n(this,$i).set(e.styleSheetId,t.text)}catch(t){B(t)}};function Tf(s){const r=[];for(const a of s)r.push({offset:a.startOffset,type:0,range:a}),r.push({offset:a.endOffset,type:1,range:a});r.sort((a,o)=>{if(a.offset!==o.offset)return a.offset-o.offset;if(a.type!==o.type)return o.type-a.type;const c=a.range.endOffset-a.range.startOffset,l=o.range.endOffset-o.range.startOffset;return a.type===0?l-c:c-l});const e=[],t=[];let i=0;for(const a of r){if(e.length&&i<a.offset&&e[e.length-1]>0){const o=t[t.length-1];o&&o.end===i?o.end=a.offset:t.push({start:i,end:a.offset})}i=a.offset,a.type===0?e.push(a.range.count):e.pop()}return t.filter(a=>a.end-a.start>0)}/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var ro;class _y extends gg{constructor(e,t,i,a=""){super(t,i,a);d(this,ro);p(this,ro,e)}async handle(e){await n(this,ro).send("Page.handleJavaScriptDialog",{accept:e.accept,promptText:e.text})}}ro=new WeakMap;var My=function(s,r,e){for(var t=arguments.length>2,i=0;i<r.length;i++)e=t?r[i].call(s,e):r[i].call(s);return t?e:void 0},Ct=function(s,r,e,t,i,a){function o(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var c=t.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!r&&s?t.static?s:s.prototype:null,f=r||(u?Object.getOwnPropertyDescriptor(u,t.name):{}),w,h=!1,g=e.length-1;g>=0;g--){var S={};for(var m in t)S[m]=m==="access"?{}:t[m];for(var m in t.access)S.access[m]=t.access[m];S.addInitializer=function(T){if(h)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(T||null))};var v=(0,e[g])(c==="accessor"?{get:f.get,set:f.set}:f[l],S);if(c==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(w=o(v.get))&&(f.get=w),(w=o(v.set))&&(f.set=w),(w=o(v.init))&&i.unshift(w)}else(w=o(v))&&(c==="field"?i.unshift(w):f[l]=w)}u&&Object.defineProperty(u,t.name,f),h=!0},Pt=function(s,r,e){return typeof r=="symbol"&&(r=r.description?"[".concat(r.description,"]"):""),Object.defineProperty(s,"name",{configurable:!0,value:e?"".concat(e," ",r):r})},Wi,an,io;class _t{constructor(r,e,t){d(this,Wi);d(this,an);d(this,io);p(this,Wi,r),p(this,an,e),p(this,io,t),n(this,an).registerState(this)}async setState(r){p(this,Wi,r),await this.sync()}get state(){return n(this,Wi)}async sync(){await Promise.all(n(this,an).clients().map(r=>n(this,io).call(this,r,n(this,Wi))))}}Wi=new WeakMap,an=new WeakMap,io=new WeakMap;let Ay=(()=>{var U,H,N,G,L,V,De,A,k,K,$,te,ge,q,Ee,j,mu,gu,yu,wu,vu,bu,Su,ku,Eu,Tu,E;let s=[],r,e,t,i,a,o,c,l,u,f,w,h,g,S,m,v,T,D,P,M;return E=class{constructor(_){d(this,j);d(this,U,My(this,s));d(this,H,!1);d(this,N,!1);d(this,G,[]);d(this,L,new _t({active:!1},this,n(this,j,mu)));d(this,V,new _t({active:!1},this,n(this,j,gu)));d(this,De,new _t({active:!1},this,n(this,j,yu)));d(this,A,new _t({active:!1},this,n(this,j,wu)));d(this,k,new _t({active:!1},this,n(this,j,vu)));d(this,K,new _t({active:!1},this,n(this,j,bu)));d(this,$,new _t({active:!1},this,n(this,j,Su)));d(this,te,new _t({active:!1},this,n(this,j,ku)));d(this,ge,new _t({active:!1},this,n(this,j,Eu)));d(this,q,new _t({javaScriptEnabled:!0,active:!1},this,n(this,j,Tu)));d(this,Ee,new Set);p(this,U,_)}updateClient(_){p(this,U,_),n(this,Ee).delete(_)}registerState(_){n(this,G).push(_)}clients(){return[n(this,U),...Array.from(n(this,Ee))]}async registerSpeculativeSession(_){n(this,Ee).add(_),_.once(fe.Disconnected,()=>{n(this,Ee).delete(_)}),Promise.all(n(this,G).map(C=>C.sync().catch(B)))}get javascriptEnabled(){return n(this,q).state.javaScriptEnabled}async emulateViewport(_){const C=n(this,L).state;if(!_&&!C.active)return!1;await n(this,L).setState(_?{viewport:_,active:!0}:{active:!1});const I=(_==null?void 0:_.isMobile)||!1,W=(_==null?void 0:_.hasTouch)||!1,ae=n(this,H)!==I||n(this,N)!==W;return p(this,H,I),p(this,N,W),ae}async emulateIdleState(_){await n(this,V).setState({active:!0,overrides:_})}async emulateTimezone(_){await n(this,De).setState({timezoneId:_,active:!0})}async emulateVisionDeficiency(_){x(!_||new Set(["none","achromatopsia","blurredVision","deuteranopia","protanopia","reducedContrast","tritanopia"]).has(_),`Unsupported vision deficiency: ${_}`),await n(this,A).setState({active:!0,visionDeficiency:_})}async emulateCPUThrottling(_){x(_===null||_>=1,"Throttling rate should be greater or equal to 1"),await n(this,k).setState({active:!0,factor:_??void 0})}async emulateMediaFeatures(_){if(Array.isArray(_))for(const C of _){const I=C.name;x(/^(?:prefers-(?:color-scheme|reduced-motion)|color-gamut)$/.test(I),"Unsupported media feature: "+I)}await n(this,K).setState({active:!0,mediaFeatures:_})}async emulateMediaType(_){x(_==="screen"||_==="print"||(_??void 0)===void 0,"Unsupported media type: "+_),await n(this,$).setState({type:_,active:!0})}async setGeolocation(_){const{longitude:C,latitude:I,accuracy:W=0}=_;if(C<-180||C>180)throw new Error(`Invalid longitude "${C}": precondition -180 <= LONGITUDE <= 180 failed.`);if(I<-90||I>90)throw new Error(`Invalid latitude "${I}": precondition -90 <= LATITUDE <= 90 failed.`);if(W<0)throw new Error(`Invalid accuracy "${W}": precondition 0 <= ACCURACY failed.`);await n(this,te).setState({active:!0,geoLocation:{longitude:C,latitude:I,accuracy:W}})}async resetDefaultBackgroundColor(){await n(this,ge).setState({active:!0,color:void 0})}async setTransparentBackgroundColor(){await n(this,ge).setState({active:!0,color:{r:0,g:0,b:0,a:0}})}async setJavaScriptEnabled(_){await n(this,q).setState({active:!0,javaScriptEnabled:_})}},U=new WeakMap,H=new WeakMap,N=new WeakMap,G=new WeakMap,L=new WeakMap,V=new WeakMap,De=new WeakMap,A=new WeakMap,k=new WeakMap,K=new WeakMap,$=new WeakMap,te=new WeakMap,ge=new WeakMap,q=new WeakMap,Ee=new WeakMap,j=new WeakSet,mu=function(){return e.value},gu=function(){return i.value},yu=function(){return o.value},wu=function(){return l.value},vu=function(){return f.value},bu=function(){return h.value},Su=function(){return S.value},ku=function(){return v.value},Eu=function(){return D.value},Tu=function(){return M.value},(()=>{const _=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;r=[Tt],t=[Tt],a=[Tt],c=[Tt],u=[Tt],w=[Tt],g=[Tt],m=[Tt],T=[Tt],P=[Tt],Ct(E,e={value:Pt(async function(C,I){if(!I.viewport){await Promise.all([C.send("Emulation.clearDeviceMetricsOverride"),C.send("Emulation.setTouchEmulationEnabled",{enabled:!1})]).catch(B);return}const{viewport:W}=I,ae=W.isMobile||!1,Oe=W.width,be=W.height,Vt=W.deviceScaleFactor??1,ct=W.isLandscape?{angle:90,type:"landscapePrimary"}:{angle:0,type:"portraitPrimary"},Et=W.hasTouch||!1;await Promise.all([C.send("Emulation.setDeviceMetricsOverride",{mobile:ae,width:Oe,height:be,deviceScaleFactor:Vt,screenOrientation:ct}).catch(lt=>{if(lt.message.includes("Target does not support metrics override")){B(lt);return}throw lt}),C.send("Emulation.setTouchEmulationEnabled",{enabled:Et})])},"#applyViewport")},r,{kind:"method",name:"#applyViewport",static:!1,private:!0,access:{has:C=>ut(j,C),get:C=>n(C,j,mu)},metadata:_},null,s),Ct(E,i={value:Pt(async function(C,I){I.active&&(I.overrides?await C.send("Emulation.setIdleOverride",{isUserActive:I.overrides.isUserActive,isScreenUnlocked:I.overrides.isScreenUnlocked}):await C.send("Emulation.clearIdleOverride"))},"#emulateIdleState")},t,{kind:"method",name:"#emulateIdleState",static:!1,private:!0,access:{has:C=>ut(j,C),get:C=>n(C,j,gu)},metadata:_},null,s),Ct(E,o={value:Pt(async function(C,I){if(I.active)try{await C.send("Emulation.setTimezoneOverride",{timezoneId:I.timezoneId||""})}catch(W){throw Ut(W)&&W.message.includes("Invalid timezone")?new Error(`Invalid timezone ID: ${I.timezoneId}`):W}},"#emulateTimezone")},a,{kind:"method",name:"#emulateTimezone",static:!1,private:!0,access:{has:C=>ut(j,C),get:C=>n(C,j,yu)},metadata:_},null,s),Ct(E,l={value:Pt(async function(C,I){I.active&&await C.send("Emulation.setEmulatedVisionDeficiency",{type:I.visionDeficiency||"none"})},"#emulateVisionDeficiency")},c,{kind:"method",name:"#emulateVisionDeficiency",static:!1,private:!0,access:{has:C=>ut(j,C),get:C=>n(C,j,wu)},metadata:_},null,s),Ct(E,f={value:Pt(async function(C,I){I.active&&await C.send("Emulation.setCPUThrottlingRate",{rate:I.factor??1})},"#emulateCpuThrottling")},u,{kind:"method",name:"#emulateCpuThrottling",static:!1,private:!0,access:{has:C=>ut(j,C),get:C=>n(C,j,vu)},metadata:_},null,s),Ct(E,h={value:Pt(async function(C,I){I.active&&await C.send("Emulation.setEmulatedMedia",{features:I.mediaFeatures})},"#emulateMediaFeatures")},w,{kind:"method",name:"#emulateMediaFeatures",static:!1,private:!0,access:{has:C=>ut(j,C),get:C=>n(C,j,bu)},metadata:_},null,s),Ct(E,S={value:Pt(async function(C,I){I.active&&await C.send("Emulation.setEmulatedMedia",{media:I.type||""})},"#emulateMediaType")},g,{kind:"method",name:"#emulateMediaType",static:!1,private:!0,access:{has:C=>ut(j,C),get:C=>n(C,j,Su)},metadata:_},null,s),Ct(E,v={value:Pt(async function(C,I){I.active&&await C.send("Emulation.setGeolocationOverride",I.geoLocation?{longitude:I.geoLocation.longitude,latitude:I.geoLocation.latitude,accuracy:I.geoLocation.accuracy}:void 0)},"#setGeolocation")},m,{kind:"method",name:"#setGeolocation",static:!1,private:!0,access:{has:C=>ut(j,C),get:C=>n(C,j,ku)},metadata:_},null,s),Ct(E,D={value:Pt(async function(C,I){I.active&&await C.send("Emulation.setDefaultBackgroundColorOverride",{color:I.color})},"#setDefaultBackgroundColor")},T,{kind:"method",name:"#setDefaultBackgroundColor",static:!1,private:!0,access:{has:C=>ut(j,C),get:C=>n(C,j,Eu)},metadata:_},null,s),Ct(E,M={value:Pt(async function(C,I){I.active&&await C.send("Emulation.setScriptExecutionDisabled",{value:!I.javaScriptEnabled})},"#setJavaScriptEnabled")},P,{kind:"method",name:"#setJavaScriptEnabled",static:!1,private:!0,access:{has:C=>ut(j,C),get:C=>n(C,j,Tu)},metadata:_},null,s),_&&Object.defineProperty(E,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_})})(),E})();/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var so,no,on;class Iy{constructor(r,e,t){d(this,so);d(this,no);d(this,on,new WeakMap);p(this,so,e),p(this,no,t),n(this,on).set(r,e)}get id(){return n(this,so)}get source(){return n(this,no)}getIdForFrame(r){return n(this,on).get(r)}setIdForFrame(r,e){n(this,on).set(r,e)}}so=new WeakMap,no=new WeakMap,on=new WeakMap;/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class Fy{constructor(r,e){F(this,"id");F(this,"name");this.id=r,this.name=e}}var it,ao,Bi,ji,cn,ln,oo,Cu;class Dy{constructor(r,e,t){d(this,oo);d(this,it);d(this,ao);d(this,Bi);d(this,ji,!1);d(this,cn,b(this,oo,Cu).bind(this));d(this,ln,new Set);F(this,"devices",[]);p(this,it,r),p(this,ao,e),p(this,Bi,t.id),n(this,it).on("DeviceAccess.deviceRequestPrompted",n(this,cn)),n(this,it).on("Target.detachedFromTarget",()=>{p(this,it,null)}),b(this,oo,Cu).call(this,t)}async waitForDevice(r,e={}){for(const o of this.devices)if(r(o))return o;const{timeout:t=n(this,ao).timeout()}=e,i=ue.create({message:`Waiting for \`DeviceRequestPromptDevice\` failed: ${t}ms exceeded`,timeout:t});e.signal&&e.signal.addEventListener("abort",()=>{var o;i.reject((o=e.signal)==null?void 0:o.reason)},{once:!0});const a={filter:r,promise:i};n(this,ln).add(a);try{return await i.valueOrThrow()}finally{n(this,ln).delete(a)}}async select(r){return x(n(this,it)!==null,"Cannot select device through detached session!"),x(this.devices.includes(r),"Cannot select unknown device!"),x(!n(this,ji),"Cannot select DeviceRequestPrompt which is already handled!"),n(this,it).off("DeviceAccess.deviceRequestPrompted",n(this,cn)),p(this,ji,!0),await n(this,it).send("DeviceAccess.selectPrompt",{id:n(this,Bi),deviceId:r.id})}async cancel(){return x(n(this,it)!==null,"Cannot cancel prompt through detached session!"),x(!n(this,ji),"Cannot cancel DeviceRequestPrompt which is already handled!"),n(this,it).off("DeviceAccess.deviceRequestPrompted",n(this,cn)),p(this,ji,!0),await n(this,it).send("DeviceAccess.cancelPrompt",{id:n(this,Bi)})}}it=new WeakMap,ao=new WeakMap,Bi=new WeakMap,ji=new WeakMap,cn=new WeakMap,ln=new WeakMap,oo=new WeakSet,Cu=function(r){if(r.id===n(this,Bi))for(const e of r.devices){if(this.devices.some(i=>i.id===e.id))continue;const t=new Fy(e.id,e.name);this.devices.push(t);for(const i of n(this,ln))i.filter(t)&&i.promise.resolve(t)}};var pt,un,ir,gl,Cf;class Oy{constructor(r,e){d(this,gl);d(this,pt);d(this,un);d(this,ir,new Set);p(this,pt,r),p(this,un,e),n(this,pt).on("DeviceAccess.deviceRequestPrompted",t=>{b(this,gl,Cf).call(this,t)}),n(this,pt).on("Target.detachedFromTarget",()=>{p(this,pt,null)})}async waitForDevicePrompt(r={}){x(n(this,pt)!==null,"Cannot wait for device prompt through detached session!");const e=n(this,ir).size===0;let t;e&&(t=n(this,pt).send("DeviceAccess.enable"));const{timeout:i=n(this,un).timeout()}=r,a=ue.create({message:`Waiting for \`DeviceRequestPrompt\` failed: ${i}ms exceeded`,timeout:i});r.signal&&r.signal.addEventListener("abort",()=>{var o;a.reject((o=r.signal)==null?void 0:o.reason)},{once:!0}),n(this,ir).add(a);try{const[o]=await Promise.all([a.valueOrThrow(),t]);return o}finally{n(this,ir).delete(a)}}}pt=new WeakMap,un=new WeakMap,ir=new WeakMap,gl=new WeakSet,Cf=function(r){if(!n(this,ir).size)return;x(n(this,pt)!==null);const e=new Dy(n(this,pt),n(this,un),r);for(const t of n(this,ir))t.resolve(e);n(this,ir).clear()};/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */function Xd(s){let r,e;if(!s.exception)r="Error",e=s.text;else{if((s.exception.type!=="object"||s.exception.subtype!=="error")&&!s.exception.objectId)return hs(s.exception);{const c=Pf(s);r=c.name,e=c.message}}const t=e.split(`
`).length,i=new Error(e);i.name=r;const a=i.stack.split(`
`),o=a.splice(0,t);if(a.shift(),s.stackTrace&&a.length<Error.stackTraceLimit)for(const c of s.stackTrace.callFrames.reverse()){if(pr.isPuppeteerURL(c.url)&&c.url!==pr.INTERNAL_URL){const l=pr.parse(c.url);a.unshift(`    at ${c.functionName||l.functionName} (${l.functionName} at ${l.siteString}, <anonymous>:${c.lineNumber}:${c.columnNumber})`)}else a.push(`    at ${c.functionName||"<anonymous>"} (${c.url}:${c.lineNumber}:${c.columnNumber})`);if(a.length>=Error.stackTraceLimit)break}return i.stack=[...o,...a].join(`
`),i}const Pf=s=>{var a,o,c,l;let r="",e;const t=((o=(a=s.exception)==null?void 0:a.description)==null?void 0:o.split(`
    at `))??[],i=Math.min(((c=s.stackTrace)==null?void 0:c.callFrames.length)??0,t.length-1);return t.splice(-i,i),(l=s.exception)!=null&&l.className&&(r=s.exception.className),e=t.join(`
`),r&&e.startsWith(`${r}: `)&&(e=e.slice(r.length+2)),{message:e,name:r}};function xy(s){let r,e;if(!s.exception)r="Error",e=s.text;else{if((s.exception.type!=="object"||s.exception.subtype!=="error")&&!s.exception.objectId)return hs(s.exception);{const c=Pf(s);r=c.name,e=c.message}}const t=new Error(e);t.name=r;const i=t.message.split(`
`).length,a=t.stack.split(`
`).splice(0,i),o=[];if(s.stackTrace){for(const c of s.stackTrace.callFrames)if(o.push(`    at ${c.functionName||"<anonymous>"} (${c.url}:${c.lineNumber+1}:${c.columnNumber+1})`),o.length>=Error.stackTraceLimit)break}return t.stack=[...a,...o].join(`
`),t}function hs(s){if(x(!s.objectId,"Cannot extract value when objectId is given"),s.unserializableValue){if(s.type==="bigint")return BigInt(s.unserializableValue.replace("n",""));switch(s.unserializableValue){case"-0":return-0;case"NaN":return NaN;case"Infinity":return 1/0;case"-Infinity":return-1/0;default:throw new Error("Unsupported unserializable value: "+s.unserializableValue)}}return s.value}function _f(s,r,e){globalThis[r]||Object.assign(globalThis,{[r](...t){const i=globalThis[r];i.args??(i.args=new Map),i.callbacks??(i.callbacks=new Map);const a=(i.lastSeq??0)+1;return i.lastSeq=a,i.args.set(a,t),globalThis[e+r](JSON.stringify({type:s,name:r,seq:a,args:t,isTrivial:!t.some(o=>o instanceof Node)})),new Promise((o,c)=>{i.callbacks.set(a,{resolve(l){i.args.delete(a),o(l)},reject(l){i.args.delete(a),c(l)}})})}})}const Ps="puppeteer_";function Ry(s,r){return Xh(_f,s,r,Ps)}/**
 * @license
 * Copyright 2019 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var dn,ze,hn;class Al extends Cs{constructor(e,t){super();d(this,dn,!1);d(this,ze);d(this,hn);p(this,hn,e),p(this,ze,t)}get disposed(){return n(this,dn)}get realm(){return n(this,hn)}get client(){return this.realm.environment.client}async jsonValue(){if(!n(this,ze).objectId)return hs(n(this,ze));const e=await this.evaluate(t=>t);if(e===void 0)throw new Error("Could not serialize referenced object");return e}asElement(){return null}async dispose(){n(this,dn)||(p(this,dn,!0),await Mf(this.client,n(this,ze)))}toString(){return n(this,ze).objectId?"JSHandle@"+(n(this,ze).subtype||n(this,ze).type):"JSHandle:"+hs(n(this,ze))}get id(){return n(this,ze).objectId}remoteObject(){return n(this,ze)}async getProperties(){const e=await this.client.send("Runtime.getProperties",{objectId:n(this,ze).objectId,ownProperties:!0}),t=new Map;for(const i of e.result)!i.enumerable||!i.value||t.set(i.name,n(this,hn).createCdpHandle(i.value));return t}}dn=new WeakMap,ze=new WeakMap,hn=new WeakMap;async function Mf(s,r){r.objectId&&await s.send("Runtime.releaseObject",{objectId:r.objectId}).catch(e=>{B(e)})}/**
 * @license
 * Copyright 2019 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Ly=function(s,r,e){for(var t=arguments.length>2,i=0;i<r.length;i++)e=t?r[i].call(s,e):r[i].call(s);return t?e:void 0},Pc=function(s,r,e,t,i,a){function o(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var c=t.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!r&&s?t.static?s:s.prototype:null,f=r||(u?Object.getOwnPropertyDescriptor(u,t.name):{}),w,h=!1,g=e.length-1;g>=0;g--){var S={};for(var m in t)S[m]=m==="access"?{}:t[m];for(var m in t.access)S.access[m]=t.access[m];S.addInitializer=function(T){if(h)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(T||null))};var v=(0,e[g])(c==="accessor"?{get:f.get,set:f.set}:f[l],S);if(c==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(w=o(v.get))&&(f.get=w),(w=o(v.set))&&(f.set=w),(w=o(v.init))&&i.unshift(w)}else(w=o(v))&&(c==="field"?i.unshift(w):f[l]=w)}u&&Object.defineProperty(u,t.name,f),h=!0};const Ny=new Set(["StaticText","InlineTextBox"]);let Af=(()=>{var o,c,If,u;let s=Vg,r=[],e,t,i,a;return u=class extends s{constructor(h,g){super(new Al(h,g));d(this,c);d(this,o,Ly(this,r))}get realm(){return this.handle.realm}get client(){return this.handle.client}remoteObject(){return this.handle.remoteObject()}get frame(){return this.realm.environment}async contentFrame(){const h=await this.client.send("DOM.describeNode",{objectId:this.id});return typeof h.node.frameId!="string"?null:n(this,c,If).frame(h.node.frameId)}async scrollIntoView(){await this.assertConnectedElement();try{await this.client.send("DOM.scrollIntoViewIfNeeded",{objectId:this.id})}catch(h){B(h),await super.scrollIntoView()}}async uploadFile(...h){const g=await this.evaluate(v=>v.multiple);x(h.length<=1||g,"Multiple file uploads only work with <input type=file multiple>");const S=ls.value.path;if(S&&(h=h.map(v=>S.win32.isAbsolute(v)||S.posix.isAbsolute(v)?v:S.resolve(v))),h.length===0){await this.evaluate(v=>{v.files=new DataTransfer().files,v.dispatchEvent(new Event("input",{bubbles:!0,composed:!0})),v.dispatchEvent(new Event("change",{bubbles:!0}))});return}const{node:{backendNodeId:m}}=await this.client.send("DOM.describeNode",{objectId:this.id});await this.client.send("DOM.setFileInputFiles",{objectId:this.id,files:h,backendNodeId:m})}async autofill(h){const S=(await this.client.send("DOM.describeNode",{objectId:this.handle.id})).node.backendNodeId,m=this.frame._id;await this.client.send("Autofill.trigger",{fieldId:S,frameId:m,card:h.creditCard})}async*queryAXTree(h,g){const{nodes:S}=await this.client.send("Accessibility.queryAXTree",{objectId:this.id,accessibleName:h,role:g}),m=S.filter(v=>!(v.ignored||!v.role||Ny.has(v.role.value)));return yield*Ml.map(m,v=>this.realm.adoptBackendNode(v.backendDOMNodeId))}async backendNodeId(){if(n(this,o))return n(this,o);const{node:h}=await this.client.send("DOM.describeNode",{objectId:this.handle.id});return p(this,o,h.backendNodeId),n(this,o)}},o=new WeakMap,c=new WeakSet,If=function(){return this.frame._frameManager},(()=>{const h=typeof Symbol=="function"&&Symbol.metadata?Object.create(s[Symbol.metadata]??null):void 0;e=[Q()],t=[Q(),re],i=[Q(),re],a=[Q()],Pc(u,null,e,{kind:"method",name:"contentFrame",static:!1,private:!1,access:{has:g=>"contentFrame"in g,get:g=>g.contentFrame},metadata:h},null,r),Pc(u,null,t,{kind:"method",name:"scrollIntoView",static:!1,private:!1,access:{has:g=>"scrollIntoView"in g,get:g=>g.scrollIntoView},metadata:h},null,r),Pc(u,null,i,{kind:"method",name:"uploadFile",static:!1,private:!1,access:{has:g=>"uploadFile"in g,get:g=>g.uploadFile},metadata:h},null,r),Pc(u,null,a,{kind:"method",name:"autofill",static:!1,private:!1,access:{has:g=>"autofill"in g,get:g=>g.autofill},metadata:h},null,r),h&&Object.defineProperty(u,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:h})})(),u})();/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Ky=function(s,r,e){if(r!=null){if(typeof r!="object"&&typeof r!="function")throw new TypeError("Object expected.");var t,i;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");t=r[Symbol.asyncDispose]}if(t===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");t=r[Symbol.dispose],e&&(i=t)}if(typeof t!="function")throw new TypeError("Object not disposable.");i&&(t=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),s.stack.push({value:r,dispose:t,async:e})}else e&&s.stack.push({async:!0});return r},$y=function(s){return function(r){function e(o){r.error=r.hasError?new s(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,i=0;function a(){for(;t=r.stack.pop();)try{if(!t.async&&i===1)return i=0,r.stack.push(t),Promise.resolve().then(a);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return i|=2,Promise.resolve(o).then(a,function(c){return e(c),a()})}else i|=1}catch(c){e(c)}if(i===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return a()}}(typeof SuppressedError=="function"?SuppressedError:function(s,r,e){var t=new Error(e);return t.name="SuppressedError",t.error=s,t.suppressed=r,t});const Wy=new nl("__ariaQuerySelector",ga.queryOne,""),By=new nl("__ariaQuerySelectorAll",async(s,r)=>{const e=ga.queryAll(s,r);return await s.realm.evaluateHandle((...t)=>t,...await Ml.collect(e))},"");var Ar,qi,mt,fn,co,Ui,yl,Qe,Df,Of,xf,lo,Ir,Pu,_u;class Ff extends pe{constructor(e,t,i){super();d(this,Qe);d(this,Ar);d(this,qi);d(this,mt);d(this,fn);d(this,co,new qt);d(this,Ui,new Map);d(this,yl,new ma);d(this,lo,!1);d(this,Ir);p(this,Ar,e),p(this,qi,i),p(this,mt,t.id),t.name&&p(this,fn,t.name);const a=n(this,co).use(new pe(n(this,Ar)));a.on("Runtime.bindingCalled",b(this,Qe,Of).bind(this)),a.on("Runtime.executionContextDestroyed",async o=>{o.executionContextId===n(this,mt)&&this[oe]()}),a.on("Runtime.executionContextsCleared",async()=>{this[oe]()}),a.on("Runtime.consoleAPICalled",b(this,Qe,xf).bind(this)),a.on(fe.Disconnected,()=>{this[oe]()})}get id(){return n(this,mt)}get puppeteerUtil(){let e=Promise.resolve();return n(this,lo)||(e=Promise.all([b(this,Qe,Pu).call(this,Wy),b(this,Qe,Pu).call(this,By)]),p(this,lo,!0)),Oc.inject(t=>{n(this,Ir)&&n(this,Ir).then(i=>{i.dispose()}),p(this,Ir,e.then(()=>this.evaluateHandle(t)))},!n(this,Ir)),n(this,Ir)}async evaluate(e,...t){return await b(this,Qe,_u).call(this,!0,e,...t)}async evaluateHandle(e,...t){return await b(this,Qe,_u).call(this,!1,e,...t)}[oe](){n(this,co).dispose(),this.emit("disposed",void 0)}}Ar=new WeakMap,qi=new WeakMap,mt=new WeakMap,fn=new WeakMap,co=new WeakMap,Ui=new WeakMap,yl=new WeakMap,Qe=new WeakSet,Df=async function(e){const t={stack:[],error:void 0,hasError:!1};try{if(n(this,Ui).has(e.name))return;const i=Ky(t,await n(this,yl).acquire(),!1);try{await n(this,Ar).send("Runtime.addBinding",n(this,fn)?{name:Ps+e.name,executionContextName:n(this,fn)}:{name:Ps+e.name,executionContextId:n(this,mt)}),await this.evaluate(_f,"internal",e.name,Ps),n(this,Ui).set(e.name,e)}catch(a){if(a instanceof Error&&(a.message.includes("Execution context was destroyed")||a.message.includes("Cannot find context with specified id")))return;B(a)}}catch(i){t.error=i,t.hasError=!0}finally{$y(t)}},Of=async function(e){if(e.executionContextId!==n(this,mt))return;let t;try{t=JSON.parse(e.payload)}catch{return}const{type:i,name:a,seq:o,args:c,isTrivial:l}=t;if(i!=="internal"){this.emit("bindingcalled",e);return}if(!n(this,Ui).has(a)){this.emit("bindingcalled",e);return}try{const u=n(this,Ui).get(a);await(u==null?void 0:u.run(this,o,c,l))}catch(u){B(u)}},xf=function(e){e.executionContextId===n(this,mt)&&this.emit("consoleapicalled",e)},lo=new WeakMap,Ir=new WeakMap,Pu=async function(e){try{await b(this,Qe,Df).call(this,e)}catch(t){B(t)}},_u=async function(e,t,...i){var g;const a=ug(((g=og(t))==null?void 0:g.toString())??pr.INTERNAL_URL);if(gs(t)){const S=n(this,mt),m=t,v=$d.test(m)?m:`${m}
${a}
`,{exceptionDetails:T,result:D}=await n(this,Ar).send("Runtime.evaluate",{expression:v,contextId:S,returnByValue:e,awaitPromise:!0,userGesture:!0}).catch(Qd);if(T)throw Xd(T);return e?hs(D):n(this,qi).createCdpHandle(D)}const o=ii(t),c=$d.test(o)?o:`${o}
${a}
`;let l;try{l=n(this,Ar).send("Runtime.callFunctionOn",{functionDeclaration:c,executionContextId:n(this,mt),arguments:i.some(S=>S instanceof St)?await Promise.all(i.map(S=>w(this,S))):i.map(S=>h(this,S)),returnByValue:e,awaitPromise:!0,userGesture:!0})}catch(S){throw S instanceof TypeError&&S.message.startsWith("Converting circular structure to JSON")&&(S.message+=" Recursive objects are not allowed."),S}const{exceptionDetails:u,result:f}=await l.catch(Qd);if(u)throw Xd(u);return e?hs(f):n(this,qi).createCdpHandle(f);async function w(S,m){return m instanceof St&&(m=await m.get(S)),h(S,m)}function h(S,m){if(typeof m=="bigint")return{unserializableValue:`${m.toString()}n`};if(Object.is(m,-0))return{unserializableValue:"-0"};if(Object.is(m,1/0))return{unserializableValue:"Infinity"};if(Object.is(m,-1/0))return{unserializableValue:"-Infinity"};if(Object.is(m,NaN))return{unserializableValue:"NaN"};const v=m&&(m instanceof Al||m instanceof Af)?m:null;if(v){if(v.realm!==n(S,qi))throw new Error("JSHandles can be evaluated only in the context they were created!");if(v.disposed)throw new Error("JSHandle is disposed!");return v.remoteObject().unserializableValue?{unserializableValue:v.remoteObject().unserializableValue}:v.remoteObject().objectId?{objectId:v.remoteObject().objectId}:{value:v.remoteObject().value}}return{value:m}}};const Qd=s=>{if(s.message.includes("Object reference chain is too long"))return{result:{type:"undefined"}};if(s.message.includes("Object couldn't be returned by value"))return{result:{type:"undefined"}};throw s.message.endsWith("Cannot find context with specified id")||s.message.endsWith("Inspected target navigated or closed")?new Error("Execution context was destroyed, most likely because of a navigation."):s};/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Ae;(function(s){s.FrameAttached=Symbol("FrameManager.FrameAttached"),s.FrameNavigated=Symbol("FrameManager.FrameNavigated"),s.FrameDetached=Symbol("FrameManager.FrameDetached"),s.FrameSwapped=Symbol("FrameManager.FrameSwapped"),s.LifecycleEvent=Symbol("FrameManager.LifecycleEvent"),s.FrameNavigatedWithinDocument=Symbol("FrameManager.FrameNavigatedWithinDocument"),s.ConsoleApiCalled=Symbol("FrameManager.ConsoleApiCalled"),s.BindingCalled=Symbol("FrameManager.BindingCalled")})(Ae||(Ae={}));/**
 * @license
 * Copyright 2019 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Ot,gt,Fr,$e,Rf,Lf,Nf,Nc,Kc;class Mu extends hy{constructor(e,t){super(t);d(this,$e);d(this,Ot);d(this,gt,new pe);d(this,Fr);p(this,Fr,e)}get environment(){return n(this,Fr)}get client(){return n(this,Fr).client}get emitter(){return n(this,gt)}setContext(e){var t;(t=n(this,Ot))==null||t[oe](),e.once("disposed",b(this,$e,Rf).bind(this)),e.on("consoleapicalled",b(this,$e,Lf).bind(this)),e.on("bindingcalled",b(this,$e,Nf).bind(this)),p(this,Ot,e),n(this,gt).emit("context",e),this.taskManager.rerunAll()}hasContext(){return!!n(this,Ot)}get context(){return n(this,Ot)}async evaluateHandle(e,...t){e=Ie(this.evaluateHandle.name,e);let i=b(this,$e,Nc).call(this);return i||(i=await b(this,$e,Kc).call(this)),await i.evaluateHandle(e,...t)}async evaluate(e,...t){e=Ie(this.evaluate.name,e);let i=b(this,$e,Nc).call(this);return i||(i=await b(this,$e,Kc).call(this)),await i.evaluate(e,...t)}async adoptBackendNode(e){let t=b(this,$e,Nc).call(this);t||(t=await b(this,$e,Kc).call(this));const{object:i}=await this.client.send("DOM.resolveNode",{backendNodeId:e,executionContextId:t.id});return this.createCdpHandle(i)}async adoptHandle(e){if(e.realm===this)return await e.evaluateHandle(i=>i);const t=await this.client.send("DOM.describeNode",{objectId:e.id});return await this.adoptBackendNode(t.node.backendNodeId)}async transferHandle(e){if(e.realm===this||e.remoteObject().objectId===void 0)return e;const t=await this.client.send("DOM.describeNode",{objectId:e.remoteObject().objectId}),i=await this.adoptBackendNode(t.node.backendNodeId);return await e.dispose(),i}createCdpHandle(e){return e.subtype==="node"?new Af(this,e):new Al(this,e)}[oe](){var e;(e=n(this,Ot))==null||e[oe](),n(this,gt).emit("disposed",void 0),super[oe](),n(this,gt).removeAllListeners()}}Ot=new WeakMap,gt=new WeakMap,Fr=new WeakMap,$e=new WeakSet,Rf=function(){p(this,Ot,void 0),"clearDocumentHandle"in n(this,Fr)&&n(this,Fr).clearDocumentHandle()},Lf=function(e){n(this,gt).emit("consoleapicalled",e)},Nf=function(e){n(this,gt).emit("bindingcalled",e)},Nc=function(){if(this.disposed)throw new Error(`Execution context is not available in detached frame or worker "${this.environment.url()}" (are you trying to evaluate?)`);return n(this,Ot)},Kc=async function(){const e=new Error("Execution context was destroyed");return await Je(Se(n(this,gt),"context").pipe(Wt(Se(n(this,gt),"disposed").pipe(Ue(()=>{throw e})),Bt(this.timeoutSettings.timeout()))))};/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const At=Symbol("mainWorld"),$c=Symbol("puppeteerWorld");/**
 * @license
 * Copyright 2019 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const jy=new Map([["load","load"],["domcontentloaded","DOMContentLoaded"],["networkidle0","networkIdle"],["networkidle2","networkAlmostIdle"]]);var uo,Dr,pn,Or,Hi,ho,xr,fo,po,mo,go,yo,sr,he,Kf,$f,Wf,Bf,jf,qf,Wc,ai;class Wl{constructor(r,e,t,i,a){d(this,he);d(this,uo);d(this,Dr);d(this,pn);d(this,Or,null);d(this,Hi,new qt);d(this,ho);d(this,xr);d(this,fo,ue.create());d(this,po,ue.create());d(this,mo,ue.create());d(this,go);d(this,yo);d(this,sr);Array.isArray(t)?t=t.slice():typeof t=="string"&&(t=[t]),p(this,ho,e._loaderId),p(this,uo,t.map(u=>{const f=jy.get(u);return x(f,"Unknown value for options.waitUntil: "+u),f})),a==null||a.addEventListener("abort",()=>{n(this,xr).reject(a.reason)}),p(this,Dr,e),p(this,pn,i),n(this,Hi).use(new pe(e._frameManager)).on(Ae.LifecycleEvent,b(this,he,ai).bind(this));const c=n(this,Hi).use(new pe(e));c.on(xe.FrameNavigatedWithinDocument,b(this,he,jf).bind(this)),c.on(xe.FrameNavigated,b(this,he,qf).bind(this)),c.on(xe.FrameSwapped,b(this,he,Wc).bind(this)),c.on(xe.FrameSwappedByActivation,b(this,he,Wc).bind(this)),c.on(xe.FrameDetached,b(this,he,Bf).bind(this));const l=n(this,Hi).use(new pe(r));l.on(Me.Request,b(this,he,Kf).bind(this)),l.on(Me.Response,b(this,he,Wf).bind(this)),l.on(Me.RequestFailed,b(this,he,$f).bind(this)),p(this,xr,ue.create({timeout:n(this,pn),message:`Navigation timeout of ${n(this,pn)} ms exceeded`})),b(this,he,ai).call(this)}async navigationResponse(){var r;return await((r=n(this,sr))==null?void 0:r.valueOrThrow()),n(this,Or)?n(this,Or).response():null}sameDocumentNavigationPromise(){return n(this,fo).valueOrThrow()}newDocumentNavigationPromise(){return n(this,mo).valueOrThrow()}lifecyclePromise(){return n(this,po).valueOrThrow()}terminationPromise(){return n(this,xr).valueOrThrow()}dispose(){n(this,Hi).dispose(),n(this,xr).resolve(new Error("LifecycleWatcher disposed"))}}uo=new WeakMap,Dr=new WeakMap,pn=new WeakMap,Or=new WeakMap,Hi=new WeakMap,ho=new WeakMap,xr=new WeakMap,fo=new WeakMap,po=new WeakMap,mo=new WeakMap,go=new WeakMap,yo=new WeakMap,sr=new WeakMap,he=new WeakSet,Kf=function(r){var e,t;r.frame()!==n(this,Dr)||!r.isNavigationRequest()||(p(this,Or,r),(e=n(this,sr))==null||e.resolve(),p(this,sr,ue.create()),r.response()!==null&&((t=n(this,sr))==null||t.resolve()))},$f=function(r){var e,t;((e=n(this,Or))==null?void 0:e.id)===r.id&&((t=n(this,sr))==null||t.resolve())},Wf=function(r){var e,t;((e=n(this,Or))==null?void 0:e.id)===r.request().id&&((t=n(this,sr))==null||t.resolve())},Bf=function(r){if(n(this,Dr)===r){n(this,xr).resolve(new Error("Navigating frame was detached"));return}b(this,he,ai).call(this)},jf=function(){p(this,go,!0),b(this,he,ai).call(this)},qf=function(r){if(r==="BackForwardCacheRestore")return b(this,he,Wc).call(this);b(this,he,ai).call(this)},Wc=function(){p(this,yo,!0),b(this,he,ai).call(this)},ai=function(){if(!r(n(this,Dr),n(this,uo)))return;n(this,po).resolve(),n(this,go)&&n(this,fo).resolve(void 0),(n(this,yo)||n(this,Dr)._loaderId!==n(this,ho))&&n(this,mo).resolve(void 0);function r(e,t){for(const i of t)if(!e._lifecycleEvents.has(i))return!1;for(const i of e.childFrames())if(i._hasStartedLoading&&!r(i,t))return!1;return!0}};/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var qy=function(s,r,e){for(var t=arguments.length>2,i=0;i<r.length;i++)e=t?r[i].call(s,e):r[i].call(s);return t?e:void 0},ni=function(s,r,e,t,i,a){function o(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var c=t.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!r&&s?t.static?s:s.prototype:null,f=r||(u?Object.getOwnPropertyDescriptor(u,t.name):{}),w,h=!1,g=e.length-1;g>=0;g--){var S={};for(var m in t)S[m]=m==="access"?{}:t[m];for(var m in t.access)S.access[m]=t.access[m];S.addInitializer=function(T){if(h)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(T||null))};var v=(0,e[g])(c==="accessor"?{get:f.get,set:f.set}:f[l],S);if(c==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(w=o(v.get))&&(f.get=w),(w=o(v.set))&&(f.set=w),(w=o(v.init))&&i.unshift(w)}else(w=o(v))&&(c==="field"?i.unshift(w):f[l]=w)}u&&Object.defineProperty(u,t.name,f),h=!0};let Yd=(()=>{var u,f,w,h,Uf,Hf,Gf,v;let s=Zg,r=[],e,t,i,a,o,c,l;return v=class extends s{constructor(P,M,U,H){super();d(this,h);d(this,u,(qy(this,r),""));d(this,f,!1);d(this,w);F(this,"_frameManager");F(this,"_loaderId","");F(this,"_lifecycleEvents",new Set);F(this,"_id");F(this,"_parentId");F(this,"accessibility");F(this,"worlds");this._frameManager=P,p(this,u,""),this._id=M,this._parentId=U,p(this,f,!1),p(this,w,H),this._loaderId="",this.worlds={[At]:new Mu(this,this._frameManager.timeoutSettings),[$c]:new Mu(this,this._frameManager.timeoutSettings)},this.accessibility=new yy(this.worlds[At],M),this.on(xe.FrameSwappedByActivation,()=>{this._onLoadingStarted(),this._onLoadingStopped()}),this.worlds[At].emitter.on("consoleapicalled",b(this,h,Uf).bind(this)),this.worlds[At].emitter.on("bindingcalled",b(this,h,Hf).bind(this))}_client(){return n(this,w)}updateId(P){this._id=P}updateClient(P){p(this,w,P)}page(){return this._frameManager.page()}async goto(P,M={}){const{referer:U=this._frameManager.networkManager.extraHTTPHeaders().referer,referrerPolicy:H=this._frameManager.networkManager.extraHTTPHeaders()["referer-policy"],waitUntil:N=["load"],timeout:G=this._frameManager.timeoutSettings.navigationTimeout()}=M;let L=!1;const V=new Wl(this._frameManager.networkManager,this,N,G);let De=await ue.race([A(n(this,w),P,U,H,this._id),V.terminationPromise()]);De||(De=await ue.race([V.terminationPromise(),L?V.newDocumentNavigationPromise():V.sameDocumentNavigationPromise()]));try{if(De)throw De;return await V.navigationResponse()}finally{V.dispose()}async function A(k,K,$,te,ge){try{const q=await k.send("Page.navigate",{url:K,referrer:$,frameId:ge,referrerPolicy:te});return L=!!q.loaderId,q.errorText==="net::ERR_HTTP_RESPONSE_CODE_FAILURE"?null:q.errorText?new Error(`${q.errorText} at ${K}`):null}catch(q){if(Ut(q))return q;throw q}}}async waitForNavigation(P={}){const{waitUntil:M=["load"],timeout:U=this._frameManager.timeoutSettings.navigationTimeout(),signal:H}=P,N=new Wl(this._frameManager.networkManager,this,M,U,H),G=await ue.race([N.terminationPromise(),...P.ignoreSameDocumentNavigation?[]:[N.sameDocumentNavigationPromise()],N.newDocumentNavigationPromise()]);try{if(G)throw G;const L=await ue.race([N.terminationPromise(),N.navigationResponse()]);if(L instanceof Error)throw G;return L||null}finally{N.dispose()}}get client(){return n(this,w)}mainRealm(){return this.worlds[At]}isolatedRealm(){return this.worlds[$c]}async setContent(P,M={}){const{waitUntil:U=["load"],timeout:H=this._frameManager.timeoutSettings.navigationTimeout()}=M;await this.setFrameContent(P);const N=new Wl(this._frameManager.networkManager,this,U,H),G=await ue.race([N.terminationPromise(),N.lifecyclePromise()]);if(N.dispose(),G)throw G}url(){return n(this,u)}parentFrame(){return this._frameManager._frameTree.parentFrame(this._id)||null}childFrames(){return this._frameManager._frameTree.childFrames(this._id)}async addPreloadScript(P){const M=this.parentFrame();if(M&&n(this,w)===M.client||P.getIdForFrame(this))return;const{identifier:U}=await n(this,w).send("Page.addScriptToEvaluateOnNewDocument",{source:P.source});P.setIdForFrame(this,U)}async addExposedFunctionBinding(P){this!==this._frameManager.mainFrame()&&!this._hasStartedLoading||await Promise.all([n(this,w).send("Runtime.addBinding",{name:Ps+P.name}),this.evaluate(P.initSource).catch(B)])}async removeExposedFunctionBinding(P){this!==this._frameManager.mainFrame()&&!this._hasStartedLoading||await Promise.all([n(this,w).send("Runtime.removeBinding",{name:Ps+P.name}),this.evaluate(M=>{globalThis[M]=void 0},P.name).catch(B)])}async waitForDevicePrompt(P={}){return await b(this,h,Gf).call(this).waitForDevicePrompt(P)}_navigated(P){this._name=P.name,p(this,u,`${P.url}${P.urlFragment||""}`)}_navigatedWithinDocument(P){p(this,u,P)}_onLifecycleEvent(P,M){M==="init"&&(this._loaderId=P,this._lifecycleEvents.clear()),this._lifecycleEvents.add(M)}_onLoadingStopped(){this._lifecycleEvents.add("DOMContentLoaded"),this._lifecycleEvents.add("load")}_onLoadingStarted(){this._hasStartedLoading=!0}get detached(){return n(this,f)}[(e=[le],t=[le],i=[le],a=[le],o=[le],c=[le],l=[le],oe)](){n(this,f)||(p(this,f,!0),this.worlds[At][oe](),this.worlds[$c][oe]())}exposeFunction(){throw new md}async frameElement(){const P=this.parentFrame();if(!P)return null;const{backendNodeId:M}=await P.client.send("DOM.getFrameOwner",{frameId:this._id});return await P.mainRealm().adoptBackendNode(M)}},u=new WeakMap,f=new WeakMap,w=new WeakMap,h=new WeakSet,Uf=function(P){this._frameManager.emit(Ae.ConsoleApiCalled,[this.worlds[At],P])},Hf=function(P){this._frameManager.emit(Ae.BindingCalled,[this.worlds[At],P])},Gf=function(){return this._frameManager._deviceRequestPromptManager(n(this,w))},(()=>{const P=typeof Symbol=="function"&&Symbol.metadata?Object.create(s[Symbol.metadata]??null):void 0;ni(v,null,e,{kind:"method",name:"goto",static:!1,private:!1,access:{has:M=>"goto"in M,get:M=>M.goto},metadata:P},null,r),ni(v,null,t,{kind:"method",name:"waitForNavigation",static:!1,private:!1,access:{has:M=>"waitForNavigation"in M,get:M=>M.waitForNavigation},metadata:P},null,r),ni(v,null,i,{kind:"method",name:"setContent",static:!1,private:!1,access:{has:M=>"setContent"in M,get:M=>M.setContent},metadata:P},null,r),ni(v,null,a,{kind:"method",name:"addPreloadScript",static:!1,private:!1,access:{has:M=>"addPreloadScript"in M,get:M=>M.addPreloadScript},metadata:P},null,r),ni(v,null,o,{kind:"method",name:"addExposedFunctionBinding",static:!1,private:!1,access:{has:M=>"addExposedFunctionBinding"in M,get:M=>M.addExposedFunctionBinding},metadata:P},null,r),ni(v,null,c,{kind:"method",name:"removeExposedFunctionBinding",static:!1,private:!1,access:{has:M=>"removeExposedFunctionBinding"in M,get:M=>M.removeExposedFunctionBinding},metadata:P},null,r),ni(v,null,l,{kind:"method",name:"waitForDevicePrompt",static:!1,private:!1,access:{has:M=>"waitForDevicePrompt"in M,get:M=>M.waitForDevicePrompt},metadata:P},null,r),P&&Object.defineProperty(v,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:P})})(),v})();/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Gi,mn,Rr,gn,yn,wo;class Uy{constructor(){d(this,Gi,new Map);d(this,mn,new Map);d(this,Rr,new Map);d(this,gn);d(this,yn,!1);d(this,wo,new Map)}getMainFrame(){return n(this,gn)}getById(r){return n(this,Gi).get(r)}waitForFrame(r){const e=this.getById(r);if(e)return Promise.resolve(e);const t=ue.create();return(n(this,wo).get(r)||new Set).add(t),t.valueOrThrow()}frames(){return Array.from(n(this,Gi).values())}addFrame(r){var e;n(this,Gi).set(r._id,r),r._parentId?(n(this,mn).set(r._id,r._parentId),n(this,Rr).has(r._parentId)||n(this,Rr).set(r._parentId,new Set),n(this,Rr).get(r._parentId).add(r._id)):(!n(this,gn)||n(this,yn))&&(p(this,gn,r),p(this,yn,!1)),(e=n(this,wo).get(r._id))==null||e.forEach(t=>t.resolve(r))}removeFrame(r){var e;n(this,Gi).delete(r._id),n(this,mn).delete(r._id),r._parentId?(e=n(this,Rr).get(r._parentId))==null||e.delete(r._id):p(this,yn,!0)}childFrames(r){const e=n(this,Rr).get(r);return e?Array.from(e).map(t=>this.getById(t)).filter(t=>t!==void 0):[]}parentFrame(r){const e=n(this,mn).get(r);return e?this.getById(e):void 0}}Gi=new WeakMap,mn=new WeakMap,Rr=new WeakMap,gn=new WeakMap,yn=new WeakMap,wo=new WeakMap;var xt,vo,bo,So,ko,Eo,To,Co,Po,_o;class Au extends qd{constructor(e,t,i,a,o,c){super();F(this,"id");d(this,xt);d(this,vo);d(this,bo);d(this,So);d(this,ko);d(this,Eo,!1);d(this,To);d(this,Co,{});d(this,Po);d(this,_o);p(this,xt,e),this.id=o.requestId,p(this,vo,o.requestId===o.loaderId&&o.type==="Document"),this._interceptionId=i,p(this,bo,o.request.url+(o.request.urlFragment??"")),p(this,So,(o.type||"other").toLowerCase()),p(this,ko,o.request.method),p(this,To,o.request.postData),p(this,Eo,o.request.hasPostData??!1),p(this,Po,t),this._redirectChain=c,p(this,_o,o.initiator),this.interception.enabled=a;for(const[l,u]of Object.entries(o.request.headers))n(this,Co)[l.toLowerCase()]=u}get client(){return n(this,xt)}set client(e){p(this,xt,e)}url(){return n(this,bo)}resourceType(){return n(this,So)}method(){return n(this,ko)}postData(){return n(this,To)}hasPostData(){return n(this,Eo)}async fetchPostData(){try{return(await n(this,xt).send("Network.getRequestPostData",{requestId:this.id})).postData}catch(e){B(e);return}}headers(){return n(this,Co)}response(){return this._response}frame(){return n(this,Po)}isNavigationRequest(){return n(this,vo)}initiator(){return n(this,_o)}redirectChain(){return this._redirectChain.slice()}failure(){return this._failureText?{errorText:this._failureText}:null}async _continue(e={}){const{url:t,method:i,postData:a,headers:o}=e;this.interception.handled=!0;const c=a?tg(a):void 0;if(this._interceptionId===void 0)throw new Error("HTTPRequest is missing _interceptionId needed for Fetch.continueRequest");await n(this,xt).send("Fetch.continueRequest",{requestId:this._interceptionId,url:t,method:i,postData:c,headers:o?Ud(o):void 0}).catch(l=>(this.interception.handled=!1,Kl(l)))}async _respond(e){this.interception.handled=!0;let t;e.body&&(t=qd.getResponse(e.body));const i={};if(e.headers)for(const o of Object.keys(e.headers)){const c=e.headers[o];i[o.toLowerCase()]=Array.isArray(c)?c.map(l=>String(l)):String(c)}e.contentType&&(i["content-type"]=e.contentType),t!=null&&t.contentLength&&!("content-length"in i)&&(i["content-length"]=String(t.contentLength));const a=e.status||200;if(this._interceptionId===void 0)throw new Error("HTTPRequest is missing _interceptionId needed for Fetch.fulfillRequest");await n(this,xt).send("Fetch.fulfillRequest",{requestId:this._interceptionId,responseCode:a,responsePhrase:ey[a],responseHeaders:Ud(i),body:t==null?void 0:t.base64}).catch(o=>(this.interception.handled=!1,Kl(o)))}async _abort(e){if(this.interception.handled=!0,this._interceptionId===void 0)throw new Error("HTTPRequest is missing _interceptionId needed for Fetch.failRequest");await n(this,xt).send("Fetch.failRequest",{requestId:this._interceptionId,errorReason:e||"Failed"}).catch(Kl)}}xt=new WeakMap,vo=new WeakMap,bo=new WeakMap,So=new WeakMap,ko=new WeakMap,Eo=new WeakMap,To=new WeakMap,Co=new WeakMap,Po=new WeakMap,_o=new WeakMap;/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Mo,Ao,Io,Fo,Do,Oo;class Hy{constructor(r){d(this,Mo);d(this,Ao);d(this,Io);d(this,Fo);d(this,Do);d(this,Oo);p(this,Mo,r.subjectName),p(this,Ao,r.issuer),p(this,Io,r.validFrom),p(this,Fo,r.validTo),p(this,Do,r.protocol),p(this,Oo,r.sanList)}issuer(){return n(this,Ao)}validFrom(){return n(this,Io)}validTo(){return n(this,Fo)}protocol(){return n(this,Do)}subjectName(){return n(this,Mo)}subjectAlternativeNames(){return n(this,Oo)}}Mo=new WeakMap,Ao=new WeakMap,Io=new WeakMap,Fo=new WeakMap,Do=new WeakMap,Oo=new WeakMap;var Rt,wn,vn,xo,Ro,Lo,No,Ko,$o,Wo,Bo,wl,Vf;class Zd extends ry{constructor(e,t,i){super();d(this,wl);d(this,Rt);d(this,wn,null);d(this,vn,ue.create());d(this,xo);d(this,Ro);d(this,Lo);d(this,No);d(this,Ko);d(this,$o,{});d(this,Wo);d(this,Bo);p(this,Rt,e),p(this,xo,{ip:t.remoteIPAddress,port:t.remotePort}),p(this,Lo,b(this,wl,Vf).call(this,i)||t.statusText),p(this,No,!!t.fromDiskCache),p(this,Ko,!!t.fromServiceWorker),p(this,Ro,i?i.statusCode:t.status);const a=i?i.headers:t.headers;for(const[o,c]of Object.entries(a))n(this,$o)[o.toLowerCase()]=c;p(this,Wo,t.securityDetails?new Hy(t.securityDetails):null),p(this,Bo,t.timing||null)}_resolveBody(e){return e?n(this,vn).reject(e):n(this,vn).resolve()}remoteAddress(){return n(this,xo)}url(){return n(this,Rt).url()}status(){return n(this,Ro)}statusText(){return n(this,Lo)}headers(){return n(this,$o)}securityDetails(){return n(this,Wo)}timing(){return n(this,Bo)}content(){return n(this,wn)||p(this,wn,n(this,vn).valueOrThrow().then(async()=>{try{const e=await n(this,Rt).client.send("Network.getResponseBody",{requestId:n(this,Rt).id});return Vh(e.body,e.base64Encoded)}catch(e){throw e instanceof Gn&&e.originalMessage==="No resource with given identifier found"?new Gn("Could not load body for this request. This might happen if the request is a preflight request."):e}})),n(this,wn)}request(){return n(this,Rt)}fromCache(){return n(this,No)||n(this,Rt)._fromMemoryCache}fromServiceWorker(){return n(this,Ko)}frame(){return n(this,Rt).frame()}}Rt=new WeakMap,wn=new WeakMap,vn=new WeakMap,xo=new WeakMap,Ro=new WeakMap,Lo=new WeakMap,No=new WeakMap,Ko=new WeakMap,$o=new WeakMap,Wo=new WeakMap,Bo=new WeakMap,wl=new WeakSet,Vf=function(e){if(!e||!e.headersText)return;const t=e.headersText.split("\r",1)[0];if(!t||t.length>1e3)return;const i=t.match(/[^ ]* [^ ]* (.*)/);if(!i)return;const a=i[1];if(a)return a};/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Lr,Nr,Kr,$r,Vi,zi;class Gy{constructor(){d(this,Lr,new Map);d(this,Nr,new Map);d(this,Kr,new Map);d(this,$r,new Map);d(this,Vi,new Map);d(this,zi,new Map)}forget(r){n(this,Lr).delete(r),n(this,Nr).delete(r),n(this,zi).delete(r),n(this,Vi).delete(r),n(this,$r).delete(r)}responseExtraInfo(r){return n(this,$r).has(r)||n(this,$r).set(r,[]),n(this,$r).get(r)}queuedRedirectInfo(r){return n(this,Vi).has(r)||n(this,Vi).set(r,[]),n(this,Vi).get(r)}queueRedirectInfo(r,e){this.queuedRedirectInfo(r).push(e)}takeQueuedRedirectInfo(r){return this.queuedRedirectInfo(r).shift()}inFlightRequestsCount(){let r=0;for(const e of n(this,Kr).values())e.response()||r++;return r}storeRequestWillBeSent(r,e){n(this,Lr).set(r,e)}getRequestWillBeSent(r){return n(this,Lr).get(r)}forgetRequestWillBeSent(r){n(this,Lr).delete(r)}getRequestPaused(r){return n(this,Nr).get(r)}forgetRequestPaused(r){n(this,Nr).delete(r)}storeRequestPaused(r,e){n(this,Nr).set(r,e)}getRequest(r){return n(this,Kr).get(r)}storeRequest(r,e){n(this,Kr).set(r,e)}forgetRequest(r){n(this,Kr).delete(r)}getQueuedEventGroup(r){return n(this,zi).get(r)}queueEventGroup(r,e){n(this,zi).set(r,e)}forgetQueuedEventGroup(r){n(this,zi).delete(r)}printState(){function r(e,t){return t instanceof Map?{dataType:"Map",value:Array.from(t.entries())}:t instanceof Au?{dataType:"CdpHTTPRequest",value:`${t.id}: ${t.url()}`}:t}console.log("httpRequestsMap",JSON.stringify(n(this,Kr),r,2)),console.log("requestWillBeSentMap",JSON.stringify(n(this,Lr),r,2)),console.log("requestWillBeSentMap",JSON.stringify(n(this,$r),r,2)),console.log("requestWillBeSentMap",JSON.stringify(n(this,Nr),r,2))}}Lr=new WeakMap,Nr=new WeakMap,Kr=new WeakMap,$r=new WeakMap,Vi=new WeakMap,zi=new WeakMap;/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var bn,ee,Ji,Wr,Sn,Lt,nr,Br,Ke,kn,jo,vl,jr,R,zf,Iu,br,Bc,Fu,jc,aa,Jf,Xf,Qf,Du,Yf,ws,Zf,ep,Ou,tp,rp,qc,ip,xu,sp,Ru,Lu;class Vy extends pe{constructor(e){super();d(this,R);d(this,bn);d(this,ee,new Gy);d(this,Ji);d(this,Wr,null);d(this,Sn,new Set);d(this,Lt,!1);d(this,nr,!1);d(this,Br);d(this,Ke);d(this,kn);d(this,jo);d(this,vl,[["Fetch.requestPaused",b(this,R,Qf)],["Fetch.authRequired",b(this,R,Xf)],["Network.requestWillBeSent",b(this,R,Jf)],["Network.requestServedFromCache",b(this,R,Zf)],["Network.responseReceived",b(this,R,tp)],["Network.loadingFinished",b(this,R,ip)],["Network.loadingFailed",b(this,R,sp)],["Network.responseReceivedExtraInfo",b(this,R,rp)],[fe.Disconnected,b(this,R,zf)]]);d(this,jr,new Map);p(this,bn,e)}async addClient(e){if(n(this,jr).has(e))return;const t=new qt;n(this,jr).set(e,t);const i=t.use(new pe(e));for(const[a,o]of n(this,vl))i.on(a,c=>o.bind(this)(e,c));await Promise.all([e.send("Network.enable"),b(this,R,Iu).call(this,e),b(this,R,Bc).call(this,e),b(this,R,aa).call(this,e),b(this,R,jc).call(this,e),b(this,R,Fu).call(this,e)])}async authenticate(e){p(this,Wr,e);const t=n(this,Lt)||!!n(this,Wr);t!==n(this,nr)&&(p(this,nr,t),await b(this,R,br).call(this,b(this,R,jc).bind(this)))}async setExtraHTTPHeaders(e){const t={};for(const[i,a]of Object.entries(e))x(gs(a),`Expected value of header "${i}" to be String, but "${typeof a}" is found.`),t[i.toLowerCase()]=a;p(this,Ji,t),await b(this,R,br).call(this,b(this,R,Iu).bind(this))}extraHTTPHeaders(){return Object.assign({},n(this,Ji))}inFlightRequestsCount(){return n(this,ee).inFlightRequestsCount()}async setOfflineMode(e){n(this,Ke)||p(this,Ke,{offline:!1,upload:-1,download:-1,latency:0}),n(this,Ke).offline=e,await b(this,R,br).call(this,b(this,R,Bc).bind(this))}async emulateNetworkConditions(e){n(this,Ke)||p(this,Ke,{offline:!1,upload:-1,download:-1,latency:0}),n(this,Ke).upload=e?e.upload:-1,n(this,Ke).download=e?e.download:-1,n(this,Ke).latency=e?e.latency:0,await b(this,R,br).call(this,b(this,R,Bc).bind(this))}async setUserAgent(e,t){p(this,kn,e),p(this,jo,t),await b(this,R,br).call(this,b(this,R,Fu).bind(this))}async setCacheEnabled(e){p(this,Br,!e),await b(this,R,br).call(this,b(this,R,aa).bind(this))}async setRequestInterception(e){p(this,Lt,e);const t=n(this,Lt)||!!n(this,Wr);t!==n(this,nr)&&(p(this,nr,t),await b(this,R,br).call(this,b(this,R,jc).bind(this)))}}bn=new WeakMap,ee=new WeakMap,Ji=new WeakMap,Wr=new WeakMap,Sn=new WeakMap,Lt=new WeakMap,nr=new WeakMap,Br=new WeakMap,Ke=new WeakMap,kn=new WeakMap,jo=new WeakMap,vl=new WeakMap,jr=new WeakMap,R=new WeakSet,zf=async function(e){var t;(t=n(this,jr).get(e))==null||t.dispose(),n(this,jr).delete(e)},Iu=async function(e){n(this,Ji)!==void 0&&await e.send("Network.setExtraHTTPHeaders",{headers:n(this,Ji)})},br=async function(e){await Promise.all(Array.from(n(this,jr).keys()).map(t=>e(t)))},Bc=async function(e){n(this,Ke)!==void 0&&await e.send("Network.emulateNetworkConditions",{offline:n(this,Ke).offline,latency:n(this,Ke).latency,uploadThroughput:n(this,Ke).upload,downloadThroughput:n(this,Ke).download})},Fu=async function(e){n(this,kn)!==void 0&&await e.send("Network.setUserAgentOverride",{userAgent:n(this,kn),userAgentMetadata:n(this,jo)})},jc=async function(e){n(this,Br)===void 0&&p(this,Br,!1),n(this,nr)?await Promise.all([b(this,R,aa).call(this,e),e.send("Fetch.enable",{handleAuthRequests:!0,patterns:[{urlPattern:"*"}]})]):await Promise.all([b(this,R,aa).call(this,e),e.send("Fetch.disable")])},aa=async function(e){n(this,Br)!==void 0&&await e.send("Network.setCacheDisabled",{cacheDisabled:n(this,Br)})},Jf=function(e,t){if(n(this,Lt)&&!t.request.url.startsWith("data:")){const{requestId:i}=t;n(this,ee).storeRequestWillBeSent(i,t);const a=n(this,ee).getRequestPaused(i);if(a){const{requestId:o}=a;b(this,R,Du).call(this,t,a),b(this,R,ws).call(this,e,t,o),n(this,ee).forgetRequestPaused(i)}return}b(this,R,ws).call(this,e,t,void 0)},Xf=function(e,t){let i="Default";n(this,Sn).has(t.requestId)?i="CancelAuth":n(this,Wr)&&(i="ProvideCredentials",n(this,Sn).add(t.requestId));const{username:a,password:o}=n(this,Wr)||{username:void 0,password:void 0};e.send("Fetch.continueWithAuth",{requestId:t.requestId,authChallengeResponse:{response:i,username:a,password:o}}).catch(B)},Qf=function(e,t){!n(this,Lt)&&n(this,nr)&&e.send("Fetch.continueRequest",{requestId:t.requestId}).catch(B);const{networkId:i,requestId:a}=t;if(!i){b(this,R,Yf).call(this,e,t);return}const o=(()=>{const c=n(this,ee).getRequestWillBeSent(i);if(c&&(c.request.url!==t.request.url||c.request.method!==t.request.method)){n(this,ee).forgetRequestWillBeSent(i);return}return c})();o?(b(this,R,Du).call(this,o,t),b(this,R,ws).call(this,e,o,a)):n(this,ee).storeRequestPaused(i,t)},Du=function(e,t){e.request.headers={...e.request.headers,...t.request.headers}},Yf=function(e,t){const i=t.frameId?n(this,bn).frame(t.frameId):null,a=new Au(e,i,t.requestId,n(this,Lt),t,[]);this.emit(Me.Request,a),a.finalizeInterceptions()},ws=function(e,t,i,a=!1){let o=[];if(t.redirectResponse){let u=null;if(t.redirectHasExtraInfo&&(u=n(this,ee).responseExtraInfo(t.requestId).shift(),!u)){n(this,ee).queueRedirectInfo(t.requestId,{event:t,fetchRequestId:i});return}const f=n(this,ee).getRequest(t.requestId);f&&(b(this,R,ep).call(this,e,f,t.redirectResponse,u),o=f._redirectChain)}const c=t.frameId?n(this,bn).frame(t.frameId):null,l=new Au(e,c,i,n(this,Lt),t,o);l._fromMemoryCache=a,n(this,ee).storeRequest(t.requestId,l),this.emit(Me.Request,l),l.finalizeInterceptions()},Zf=function(e,t){const i=n(this,ee).getRequestWillBeSent(t.requestId);let a=n(this,ee).getRequest(t.requestId);if(a&&(a._fromMemoryCache=!0),!a&&i&&(b(this,R,ws).call(this,e,i,void 0,!0),a=n(this,ee).getRequest(t.requestId)),!a){B(new Error(`Request ${t.requestId} was served from cache but we could not find the corresponding request object`));return}this.emit(Me.RequestServedFromCache,a)},ep=function(e,t,i,a){const o=new Zd(t,i,a);t._response=o,t._redirectChain.push(t),o._resolveBody(new Error("Response body is unavailable for redirect responses")),b(this,R,qc).call(this,t,!1),this.emit(Me.Response,o),this.emit(Me.RequestFinished,t)},Ou=function(e,t,i){const a=n(this,ee).getRequest(t.requestId);if(!a)return;n(this,ee).responseExtraInfo(t.requestId).length&&B(new Error("Unexpected extraInfo events for request "+t.requestId)),t.response.fromDiskCache&&(i=null);const c=new Zd(a,t.response,i);a._response=c,this.emit(Me.Response,c)},tp=function(e,t){const i=n(this,ee).getRequest(t.requestId);let a=null;if(i&&!i._fromMemoryCache&&t.hasExtraInfo&&(a=n(this,ee).responseExtraInfo(t.requestId).shift(),!a)){n(this,ee).queueEventGroup(t.requestId,{responseReceivedEvent:t});return}b(this,R,Ou).call(this,e,t,a)},rp=function(e,t){const i=n(this,ee).takeQueuedRedirectInfo(t.requestId);if(i){n(this,ee).responseExtraInfo(t.requestId).push(t),b(this,R,ws).call(this,e,i.event,i.fetchRequestId);return}const a=n(this,ee).getQueuedEventGroup(t.requestId);if(a){n(this,ee).forgetQueuedEventGroup(t.requestId),b(this,R,Ou).call(this,e,a.responseReceivedEvent,t),a.loadingFinishedEvent&&b(this,R,xu).call(this,e,a.loadingFinishedEvent),a.loadingFailedEvent&&b(this,R,Ru).call(this,e,a.loadingFailedEvent);return}n(this,ee).responseExtraInfo(t.requestId).push(t)},qc=function(e,t){const i=e.id,a=e._interceptionId;n(this,ee).forgetRequest(i),a!==void 0&&n(this,Sn).delete(a),t&&n(this,ee).forget(i)},ip=function(e,t){const i=n(this,ee).getQueuedEventGroup(t.requestId);i?i.loadingFinishedEvent=t:b(this,R,xu).call(this,e,t)},xu=function(e,t){var a;const i=n(this,ee).getRequest(t.requestId);i&&(b(this,R,Lu).call(this,e,i),i.response()&&((a=i.response())==null||a._resolveBody()),b(this,R,qc).call(this,i,!0),this.emit(Me.RequestFinished,i))},sp=function(e,t){const i=n(this,ee).getQueuedEventGroup(t.requestId);i?i.loadingFailedEvent=t:b(this,R,Ru).call(this,e,t)},Ru=function(e,t){const i=n(this,ee).getRequest(t.requestId);if(!i)return;b(this,R,Lu).call(this,e,i),i._failureText=t.errorText;const a=i.response();a&&a._resolveBody(),b(this,R,qc).call(this,i,!0),this.emit(Me.RequestFailed,i)},Lu=function(e,t){e!==t.client&&t.isNavigationRequest()&&(t.client=e)};/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const zy=100;var En,qr,Tn,qo,yt,Xi,Cn,Qi,Uo,je,Y,Nu,np,ap,op,Ku,$u,Wu,cp,lp,up,dp,oi;class Jy extends pe{constructor(e,t,i){super();d(this,Y);d(this,En);d(this,qr);d(this,Tn);d(this,qo,new Set);d(this,yt);d(this,Xi,new Map);d(this,Cn,new Set);F(this,"_frameTree",new Uy);d(this,Qi,new Set);d(this,Uo,new WeakMap);d(this,je);p(this,yt,e),p(this,En,t),p(this,qr,new Vy(this)),p(this,Tn,i),this.setupEventListeners(n(this,yt)),e.once(fe.Disconnected,()=>{b(this,Y,Nu).call(this).catch(B)})}get timeoutSettings(){return n(this,Tn)}get networkManager(){return n(this,qr)}get client(){return n(this,yt)}async swapFrameTree(e){p(this,yt,e);const t=this._frameTree.getMainFrame();t&&(n(this,Qi).add(n(this,yt).target()._targetId),this._frameTree.removeFrame(t),t.updateId(n(this,yt).target()._targetId),this._frameTree.addFrame(t),t.updateClient(e)),this.setupEventListeners(e),e.once(fe.Disconnected,()=>{b(this,Y,Nu).call(this).catch(B)}),await this.initialize(e,t),await n(this,qr).addClient(e),t&&t.emit(xe.FrameSwappedByActivation,void 0)}async registerSpeculativeSession(e){await n(this,qr).addClient(e)}setupEventListeners(e){e.on("Page.frameAttached",async t=>{var i;await((i=n(this,je))==null?void 0:i.valueOrThrow()),b(this,Y,$u).call(this,e,t.frameId,t.parentFrameId)}),e.on("Page.frameNavigated",async t=>{var i;n(this,Qi).add(t.frame.id),await((i=n(this,je))==null?void 0:i.valueOrThrow()),b(this,Y,Wu).call(this,t.frame,t.type)}),e.on("Page.navigatedWithinDocument",async t=>{var i;await((i=n(this,je))==null?void 0:i.valueOrThrow()),b(this,Y,lp).call(this,t.frameId,t.url)}),e.on("Page.frameDetached",async t=>{var i;await((i=n(this,je))==null?void 0:i.valueOrThrow()),b(this,Y,up).call(this,t.frameId,t.reason)}),e.on("Page.frameStartedLoading",async t=>{var i;await((i=n(this,je))==null?void 0:i.valueOrThrow()),b(this,Y,ap).call(this,t.frameId)}),e.on("Page.frameStoppedLoading",async t=>{var i;await((i=n(this,je))==null?void 0:i.valueOrThrow()),b(this,Y,op).call(this,t.frameId)}),e.on("Runtime.executionContextCreated",async t=>{var i;await((i=n(this,je))==null?void 0:i.valueOrThrow()),b(this,Y,dp).call(this,t.context,e)}),e.on("Page.lifecycleEvent",async t=>{var i;await((i=n(this,je))==null?void 0:i.valueOrThrow()),b(this,Y,np).call(this,t)})}async initialize(e,t){var i,a;try{(i=n(this,je))==null||i.resolve(),p(this,je,ue.create()),await Promise.all([n(this,qr).addClient(e),e.send("Page.enable"),e.send("Page.getFrameTree").then(({frameTree:o})=>{var c;b(this,Y,Ku).call(this,e,o),(c=n(this,je))==null||c.resolve()}),e.send("Page.setLifecycleEventsEnabled",{enabled:!0}),e.send("Runtime.enable").then(()=>b(this,Y,cp).call(this,e,Kd)),...(t?Array.from(n(this,Xi).values()):[]).map(o=>t==null?void 0:t.addPreloadScript(o)),...(t?Array.from(n(this,Cn).values()):[]).map(o=>t==null?void 0:t.addExposedFunctionBinding(o))])}catch(o){if((a=n(this,je))==null||a.resolve(),Ut(o)&&pu(o))return;throw o}}page(){return n(this,En)}mainFrame(){const e=this._frameTree.getMainFrame();return x(e,"Requesting main frame too early!"),e}frames(){return Array.from(this._frameTree.frames())}frame(e){return this._frameTree.getById(e)||null}async addExposedFunctionBinding(e){n(this,Cn).add(e),await Promise.all(this.frames().map(async t=>await t.addExposedFunctionBinding(e)))}async removeExposedFunctionBinding(e){n(this,Cn).delete(e),await Promise.all(this.frames().map(async t=>await t.removeExposedFunctionBinding(e)))}async evaluateOnNewDocument(e){const{identifier:t}=await this.mainFrame()._client().send("Page.addScriptToEvaluateOnNewDocument",{source:e}),i=new Iy(this.mainFrame(),t,e);return n(this,Xi).set(t,i),await Promise.all(this.frames().map(async a=>await a.addPreloadScript(i))),{identifier:t}}async removeScriptToEvaluateOnNewDocument(e){const t=n(this,Xi).get(e);if(!t)throw new Error(`Script to evaluate on new document with id ${e} not found`);n(this,Xi).delete(e),await Promise.all(this.frames().map(i=>{const a=t.getIdForFrame(i);if(a)return i._client().send("Page.removeScriptToEvaluateOnNewDocument",{identifier:a}).catch(B)}))}onAttachedToTarget(e){if(e._getTargetInfo().type!=="iframe")return;const t=this.frame(e._getTargetInfo().targetId);t&&t.updateClient(e._session()),this.setupEventListeners(e._session()),this.initialize(e._session(),t)}_deviceRequestPromptManager(e){let t=n(this,Uo).get(e);return t===void 0&&(t=new Oy(e,n(this,Tn)),n(this,Uo).set(e,t)),t}}En=new WeakMap,qr=new WeakMap,Tn=new WeakMap,qo=new WeakMap,yt=new WeakMap,Xi=new WeakMap,Cn=new WeakMap,Qi=new WeakMap,Uo=new WeakMap,je=new WeakMap,Y=new WeakSet,Nu=async function(){const e=this._frameTree.getMainFrame();if(!e)return;if(!n(this,En).browser().connected){b(this,Y,oi).call(this,e);return}for(const i of e.childFrames())b(this,Y,oi).call(this,i);const t=ue.create({timeout:zy,message:"Frame was not swapped"});e.once(xe.FrameSwappedByActivation,()=>{t.resolve()});try{await t.valueOrThrow()}catch{b(this,Y,oi).call(this,e)}},np=function(e){const t=this.frame(e.frameId);t&&(t._onLifecycleEvent(e.loaderId,e.name),this.emit(Ae.LifecycleEvent,t),t.emit(xe.LifecycleEvent,void 0))},ap=function(e){const t=this.frame(e);t&&t._onLoadingStarted()},op=function(e){const t=this.frame(e);t&&(t._onLoadingStopped(),this.emit(Ae.LifecycleEvent,t),t.emit(xe.LifecycleEvent,void 0))},Ku=function(e,t){if(t.frame.parentId&&b(this,Y,$u).call(this,e,t.frame.id,t.frame.parentId),n(this,Qi).has(t.frame.id)?n(this,Qi).delete(t.frame.id):b(this,Y,Wu).call(this,t.frame,"Navigation"),!!t.childFrames)for(const i of t.childFrames)b(this,Y,Ku).call(this,e,i)},$u=function(e,t,i){let a=this.frame(t);if(a){const o=this.frame(i);e&&o&&a.client!==(o==null?void 0:o.client)&&a.updateClient(e);return}a=new Yd(this,t,i,e),this._frameTree.addFrame(a),this.emit(Ae.FrameAttached,a)},Wu=async function(e,t){const i=e.id,a=!e.parentId;let o=this._frameTree.getById(i);if(o)for(const c of o.childFrames())b(this,Y,oi).call(this,c);a&&(o?(this._frameTree.removeFrame(o),o._id=i):o=new Yd(this,i,void 0,n(this,yt)),this._frameTree.addFrame(o)),o=await this._frameTree.waitForFrame(i),o._navigated(e),this.emit(Ae.FrameNavigated,o),o.emit(xe.FrameNavigated,t)},cp=async function(e,t){const i=`${e.id()}:${t}`;n(this,qo).has(i)||(await e.send("Page.addScriptToEvaluateOnNewDocument",{source:`//# sourceURL=${pr.INTERNAL_URL}`,worldName:t}),await Promise.all(this.frames().filter(a=>a.client===e).map(a=>e.send("Page.createIsolatedWorld",{frameId:a._id,worldName:t,grantUniveralAccess:!0}).catch(B))),n(this,qo).add(i))},lp=function(e,t){const i=this.frame(e);i&&(i._navigatedWithinDocument(t),this.emit(Ae.FrameNavigatedWithinDocument,i),i.emit(xe.FrameNavigatedWithinDocument,void 0),this.emit(Ae.FrameNavigated,i),i.emit(xe.FrameNavigated,"Navigation"))},up=function(e,t){const i=this.frame(e);if(i)switch(t){case"remove":b(this,Y,oi).call(this,i);break;case"swap":this.emit(Ae.FrameSwapped,i),i.emit(xe.FrameSwapped,void 0);break}},dp=function(e,t){const i=e.auxData,a=i&&i.frameId,o=typeof a=="string"?this.frame(a):void 0;let c;if(o){if(o.client!==t)return;e.auxData&&e.auxData.isDefault?c=o.worlds[At]:e.name===Kd&&(c=o.worlds[$c])}if(!c)return;const l=new Ff((o==null?void 0:o.client)||n(this,yt),e,c);c.setContext(l)},oi=function(e){for(const t of e.childFrames())b(this,Y,oi).call(this,t);e[oe](),this._frameTree.removeFrame(e),this.emit(Ae.FrameDetached,e),e.emit(xe.FrameDetached,e)};/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const eh={0:{keyCode:48,key:"0",code:"Digit0"},1:{keyCode:49,key:"1",code:"Digit1"},2:{keyCode:50,key:"2",code:"Digit2"},3:{keyCode:51,key:"3",code:"Digit3"},4:{keyCode:52,key:"4",code:"Digit4"},5:{keyCode:53,key:"5",code:"Digit5"},6:{keyCode:54,key:"6",code:"Digit6"},7:{keyCode:55,key:"7",code:"Digit7"},8:{keyCode:56,key:"8",code:"Digit8"},9:{keyCode:57,key:"9",code:"Digit9"},Power:{key:"Power",code:"Power"},Eject:{key:"Eject",code:"Eject"},Abort:{keyCode:3,code:"Abort",key:"Cancel"},Help:{keyCode:6,code:"Help",key:"Help"},Backspace:{keyCode:8,code:"Backspace",key:"Backspace"},Tab:{keyCode:9,code:"Tab",key:"Tab"},Numpad5:{keyCode:12,shiftKeyCode:101,key:"Clear",code:"Numpad5",shiftKey:"5",location:3},NumpadEnter:{keyCode:13,code:"NumpadEnter",key:"Enter",text:"\r",location:3},Enter:{keyCode:13,code:"Enter",key:"Enter",text:"\r"},"\r":{keyCode:13,code:"Enter",key:"Enter",text:"\r"},"\n":{keyCode:13,code:"Enter",key:"Enter",text:"\r"},ShiftLeft:{keyCode:16,code:"ShiftLeft",key:"Shift",location:1},ShiftRight:{keyCode:16,code:"ShiftRight",key:"Shift",location:2},ControlLeft:{keyCode:17,code:"ControlLeft",key:"Control",location:1},ControlRight:{keyCode:17,code:"ControlRight",key:"Control",location:2},AltLeft:{keyCode:18,code:"AltLeft",key:"Alt",location:1},AltRight:{keyCode:18,code:"AltRight",key:"Alt",location:2},Pause:{keyCode:19,code:"Pause",key:"Pause"},CapsLock:{keyCode:20,code:"CapsLock",key:"CapsLock"},Escape:{keyCode:27,code:"Escape",key:"Escape"},Convert:{keyCode:28,code:"Convert",key:"Convert"},NonConvert:{keyCode:29,code:"NonConvert",key:"NonConvert"},Space:{keyCode:32,code:"Space",key:" "},Numpad9:{keyCode:33,shiftKeyCode:105,key:"PageUp",code:"Numpad9",shiftKey:"9",location:3},PageUp:{keyCode:33,code:"PageUp",key:"PageUp"},Numpad3:{keyCode:34,shiftKeyCode:99,key:"PageDown",code:"Numpad3",shiftKey:"3",location:3},PageDown:{keyCode:34,code:"PageDown",key:"PageDown"},End:{keyCode:35,code:"End",key:"End"},Numpad1:{keyCode:35,shiftKeyCode:97,key:"End",code:"Numpad1",shiftKey:"1",location:3},Home:{keyCode:36,code:"Home",key:"Home"},Numpad7:{keyCode:36,shiftKeyCode:103,key:"Home",code:"Numpad7",shiftKey:"7",location:3},ArrowLeft:{keyCode:37,code:"ArrowLeft",key:"ArrowLeft"},Numpad4:{keyCode:37,shiftKeyCode:100,key:"ArrowLeft",code:"Numpad4",shiftKey:"4",location:3},Numpad8:{keyCode:38,shiftKeyCode:104,key:"ArrowUp",code:"Numpad8",shiftKey:"8",location:3},ArrowUp:{keyCode:38,code:"ArrowUp",key:"ArrowUp"},ArrowRight:{keyCode:39,code:"ArrowRight",key:"ArrowRight"},Numpad6:{keyCode:39,shiftKeyCode:102,key:"ArrowRight",code:"Numpad6",shiftKey:"6",location:3},Numpad2:{keyCode:40,shiftKeyCode:98,key:"ArrowDown",code:"Numpad2",shiftKey:"2",location:3},ArrowDown:{keyCode:40,code:"ArrowDown",key:"ArrowDown"},Select:{keyCode:41,code:"Select",key:"Select"},Open:{keyCode:43,code:"Open",key:"Execute"},PrintScreen:{keyCode:44,code:"PrintScreen",key:"PrintScreen"},Insert:{keyCode:45,code:"Insert",key:"Insert"},Numpad0:{keyCode:45,shiftKeyCode:96,key:"Insert",code:"Numpad0",shiftKey:"0",location:3},Delete:{keyCode:46,code:"Delete",key:"Delete"},NumpadDecimal:{keyCode:46,shiftKeyCode:110,code:"NumpadDecimal",key:"\0",shiftKey:".",location:3},Digit0:{keyCode:48,code:"Digit0",shiftKey:")",key:"0"},Digit1:{keyCode:49,code:"Digit1",shiftKey:"!",key:"1"},Digit2:{keyCode:50,code:"Digit2",shiftKey:"@",key:"2"},Digit3:{keyCode:51,code:"Digit3",shiftKey:"#",key:"3"},Digit4:{keyCode:52,code:"Digit4",shiftKey:"$",key:"4"},Digit5:{keyCode:53,code:"Digit5",shiftKey:"%",key:"5"},Digit6:{keyCode:54,code:"Digit6",shiftKey:"^",key:"6"},Digit7:{keyCode:55,code:"Digit7",shiftKey:"&",key:"7"},Digit8:{keyCode:56,code:"Digit8",shiftKey:"*",key:"8"},Digit9:{keyCode:57,code:"Digit9",shiftKey:"(",key:"9"},KeyA:{keyCode:65,code:"KeyA",shiftKey:"A",key:"a"},KeyB:{keyCode:66,code:"KeyB",shiftKey:"B",key:"b"},KeyC:{keyCode:67,code:"KeyC",shiftKey:"C",key:"c"},KeyD:{keyCode:68,code:"KeyD",shiftKey:"D",key:"d"},KeyE:{keyCode:69,code:"KeyE",shiftKey:"E",key:"e"},KeyF:{keyCode:70,code:"KeyF",shiftKey:"F",key:"f"},KeyG:{keyCode:71,code:"KeyG",shiftKey:"G",key:"g"},KeyH:{keyCode:72,code:"KeyH",shiftKey:"H",key:"h"},KeyI:{keyCode:73,code:"KeyI",shiftKey:"I",key:"i"},KeyJ:{keyCode:74,code:"KeyJ",shiftKey:"J",key:"j"},KeyK:{keyCode:75,code:"KeyK",shiftKey:"K",key:"k"},KeyL:{keyCode:76,code:"KeyL",shiftKey:"L",key:"l"},KeyM:{keyCode:77,code:"KeyM",shiftKey:"M",key:"m"},KeyN:{keyCode:78,code:"KeyN",shiftKey:"N",key:"n"},KeyO:{keyCode:79,code:"KeyO",shiftKey:"O",key:"o"},KeyP:{keyCode:80,code:"KeyP",shiftKey:"P",key:"p"},KeyQ:{keyCode:81,code:"KeyQ",shiftKey:"Q",key:"q"},KeyR:{keyCode:82,code:"KeyR",shiftKey:"R",key:"r"},KeyS:{keyCode:83,code:"KeyS",shiftKey:"S",key:"s"},KeyT:{keyCode:84,code:"KeyT",shiftKey:"T",key:"t"},KeyU:{keyCode:85,code:"KeyU",shiftKey:"U",key:"u"},KeyV:{keyCode:86,code:"KeyV",shiftKey:"V",key:"v"},KeyW:{keyCode:87,code:"KeyW",shiftKey:"W",key:"w"},KeyX:{keyCode:88,code:"KeyX",shiftKey:"X",key:"x"},KeyY:{keyCode:89,code:"KeyY",shiftKey:"Y",key:"y"},KeyZ:{keyCode:90,code:"KeyZ",shiftKey:"Z",key:"z"},MetaLeft:{keyCode:91,code:"MetaLeft",key:"Meta",location:1},MetaRight:{keyCode:92,code:"MetaRight",key:"Meta",location:2},ContextMenu:{keyCode:93,code:"ContextMenu",key:"ContextMenu"},NumpadMultiply:{keyCode:106,code:"NumpadMultiply",key:"*",location:3},NumpadAdd:{keyCode:107,code:"NumpadAdd",key:"+",location:3},NumpadSubtract:{keyCode:109,code:"NumpadSubtract",key:"-",location:3},NumpadDivide:{keyCode:111,code:"NumpadDivide",key:"/",location:3},F1:{keyCode:112,code:"F1",key:"F1"},F2:{keyCode:113,code:"F2",key:"F2"},F3:{keyCode:114,code:"F3",key:"F3"},F4:{keyCode:115,code:"F4",key:"F4"},F5:{keyCode:116,code:"F5",key:"F5"},F6:{keyCode:117,code:"F6",key:"F6"},F7:{keyCode:118,code:"F7",key:"F7"},F8:{keyCode:119,code:"F8",key:"F8"},F9:{keyCode:120,code:"F9",key:"F9"},F10:{keyCode:121,code:"F10",key:"F10"},F11:{keyCode:122,code:"F11",key:"F11"},F12:{keyCode:123,code:"F12",key:"F12"},F13:{keyCode:124,code:"F13",key:"F13"},F14:{keyCode:125,code:"F14",key:"F14"},F15:{keyCode:126,code:"F15",key:"F15"},F16:{keyCode:127,code:"F16",key:"F16"},F17:{keyCode:128,code:"F17",key:"F17"},F18:{keyCode:129,code:"F18",key:"F18"},F19:{keyCode:130,code:"F19",key:"F19"},F20:{keyCode:131,code:"F20",key:"F20"},F21:{keyCode:132,code:"F21",key:"F21"},F22:{keyCode:133,code:"F22",key:"F22"},F23:{keyCode:134,code:"F23",key:"F23"},F24:{keyCode:135,code:"F24",key:"F24"},NumLock:{keyCode:144,code:"NumLock",key:"NumLock"},ScrollLock:{keyCode:145,code:"ScrollLock",key:"ScrollLock"},AudioVolumeMute:{keyCode:173,code:"AudioVolumeMute",key:"AudioVolumeMute"},AudioVolumeDown:{keyCode:174,code:"AudioVolumeDown",key:"AudioVolumeDown"},AudioVolumeUp:{keyCode:175,code:"AudioVolumeUp",key:"AudioVolumeUp"},MediaTrackNext:{keyCode:176,code:"MediaTrackNext",key:"MediaTrackNext"},MediaTrackPrevious:{keyCode:177,code:"MediaTrackPrevious",key:"MediaTrackPrevious"},MediaStop:{keyCode:178,code:"MediaStop",key:"MediaStop"},MediaPlayPause:{keyCode:179,code:"MediaPlayPause",key:"MediaPlayPause"},Semicolon:{keyCode:186,code:"Semicolon",shiftKey:":",key:";"},Equal:{keyCode:187,code:"Equal",shiftKey:"+",key:"="},NumpadEqual:{keyCode:187,code:"NumpadEqual",key:"=",location:3},Comma:{keyCode:188,code:"Comma",shiftKey:"<",key:","},Minus:{keyCode:189,code:"Minus",shiftKey:"_",key:"-"},Period:{keyCode:190,code:"Period",shiftKey:">",key:"."},Slash:{keyCode:191,code:"Slash",shiftKey:"?",key:"/"},Backquote:{keyCode:192,code:"Backquote",shiftKey:"~",key:"`"},BracketLeft:{keyCode:219,code:"BracketLeft",shiftKey:"{",key:"["},Backslash:{keyCode:220,code:"Backslash",shiftKey:"|",key:"\\"},BracketRight:{keyCode:221,code:"BracketRight",shiftKey:"}",key:"]"},Quote:{keyCode:222,code:"Quote",shiftKey:'"',key:"'"},AltGraph:{keyCode:225,code:"AltGraph",key:"AltGraph"},Props:{keyCode:247,code:"Props",key:"CrSel"},Cancel:{keyCode:3,key:"Cancel",code:"Abort"},Clear:{keyCode:12,key:"Clear",code:"Numpad5",location:3},Shift:{keyCode:16,key:"Shift",code:"ShiftLeft",location:1},Control:{keyCode:17,key:"Control",code:"ControlLeft",location:1},Alt:{keyCode:18,key:"Alt",code:"AltLeft",location:1},Accept:{keyCode:30,key:"Accept"},ModeChange:{keyCode:31,key:"ModeChange"}," ":{keyCode:32,key:" ",code:"Space"},Print:{keyCode:42,key:"Print"},Execute:{keyCode:43,key:"Execute",code:"Open"},"\0":{keyCode:46,key:"\0",code:"NumpadDecimal",location:3},a:{keyCode:65,key:"a",code:"KeyA"},b:{keyCode:66,key:"b",code:"KeyB"},c:{keyCode:67,key:"c",code:"KeyC"},d:{keyCode:68,key:"d",code:"KeyD"},e:{keyCode:69,key:"e",code:"KeyE"},f:{keyCode:70,key:"f",code:"KeyF"},g:{keyCode:71,key:"g",code:"KeyG"},h:{keyCode:72,key:"h",code:"KeyH"},i:{keyCode:73,key:"i",code:"KeyI"},j:{keyCode:74,key:"j",code:"KeyJ"},k:{keyCode:75,key:"k",code:"KeyK"},l:{keyCode:76,key:"l",code:"KeyL"},m:{keyCode:77,key:"m",code:"KeyM"},n:{keyCode:78,key:"n",code:"KeyN"},o:{keyCode:79,key:"o",code:"KeyO"},p:{keyCode:80,key:"p",code:"KeyP"},q:{keyCode:81,key:"q",code:"KeyQ"},r:{keyCode:82,key:"r",code:"KeyR"},s:{keyCode:83,key:"s",code:"KeyS"},t:{keyCode:84,key:"t",code:"KeyT"},u:{keyCode:85,key:"u",code:"KeyU"},v:{keyCode:86,key:"v",code:"KeyV"},w:{keyCode:87,key:"w",code:"KeyW"},x:{keyCode:88,key:"x",code:"KeyX"},y:{keyCode:89,key:"y",code:"KeyY"},z:{keyCode:90,key:"z",code:"KeyZ"},Meta:{keyCode:91,key:"Meta",code:"MetaLeft",location:1},"*":{keyCode:106,key:"*",code:"NumpadMultiply",location:3},"+":{keyCode:107,key:"+",code:"NumpadAdd",location:3},"-":{keyCode:109,key:"-",code:"NumpadSubtract",location:3},"/":{keyCode:111,key:"/",code:"NumpadDivide",location:3},";":{keyCode:186,key:";",code:"Semicolon"},"=":{keyCode:187,key:"=",code:"Equal"},",":{keyCode:188,key:",",code:"Comma"},".":{keyCode:190,key:".",code:"Period"},"`":{keyCode:192,key:"`",code:"Backquote"},"[":{keyCode:219,key:"[",code:"BracketLeft"},"\\":{keyCode:220,key:"\\",code:"Backslash"},"]":{keyCode:221,key:"]",code:"BracketRight"},"'":{keyCode:222,key:"'",code:"Quote"},Attn:{keyCode:246,key:"Attn"},CrSel:{keyCode:247,key:"CrSel",code:"Props"},ExSel:{keyCode:248,key:"ExSel"},EraseEof:{keyCode:249,key:"EraseEof"},Play:{keyCode:250,key:"Play"},ZoomOut:{keyCode:251,key:"ZoomOut"},")":{keyCode:48,key:")",code:"Digit0"},"!":{keyCode:49,key:"!",code:"Digit1"},"@":{keyCode:50,key:"@",code:"Digit2"},"#":{keyCode:51,key:"#",code:"Digit3"},$:{keyCode:52,key:"$",code:"Digit4"},"%":{keyCode:53,key:"%",code:"Digit5"},"^":{keyCode:54,key:"^",code:"Digit6"},"&":{keyCode:55,key:"&",code:"Digit7"},"(":{keyCode:57,key:"(",code:"Digit9"},A:{keyCode:65,key:"A",code:"KeyA"},B:{keyCode:66,key:"B",code:"KeyB"},C:{keyCode:67,key:"C",code:"KeyC"},D:{keyCode:68,key:"D",code:"KeyD"},E:{keyCode:69,key:"E",code:"KeyE"},F:{keyCode:70,key:"F",code:"KeyF"},G:{keyCode:71,key:"G",code:"KeyG"},H:{keyCode:72,key:"H",code:"KeyH"},I:{keyCode:73,key:"I",code:"KeyI"},J:{keyCode:74,key:"J",code:"KeyJ"},K:{keyCode:75,key:"K",code:"KeyK"},L:{keyCode:76,key:"L",code:"KeyL"},M:{keyCode:77,key:"M",code:"KeyM"},N:{keyCode:78,key:"N",code:"KeyN"},O:{keyCode:79,key:"O",code:"KeyO"},P:{keyCode:80,key:"P",code:"KeyP"},Q:{keyCode:81,key:"Q",code:"KeyQ"},R:{keyCode:82,key:"R",code:"KeyR"},S:{keyCode:83,key:"S",code:"KeyS"},T:{keyCode:84,key:"T",code:"KeyT"},U:{keyCode:85,key:"U",code:"KeyU"},V:{keyCode:86,key:"V",code:"KeyV"},W:{keyCode:87,key:"W",code:"KeyW"},X:{keyCode:88,key:"X",code:"KeyX"},Y:{keyCode:89,key:"Y",code:"KeyY"},Z:{keyCode:90,key:"Z",code:"KeyZ"},":":{keyCode:186,key:":",code:"Semicolon"},"<":{keyCode:188,key:"<",code:"Comma"},_:{keyCode:189,key:"_",code:"Minus"},">":{keyCode:190,key:">",code:"Period"},"?":{keyCode:191,key:"?",code:"Slash"},"~":{keyCode:192,key:"~",code:"Backquote"},"{":{keyCode:219,key:"{",code:"BracketLeft"},"|":{keyCode:220,key:"|",code:"Backslash"},"}":{keyCode:221,key:"}",code:"BracketRight"},'"':{keyCode:222,key:'"',code:"Quote"},SoftLeft:{key:"SoftLeft",code:"SoftLeft",location:4},SoftRight:{key:"SoftRight",code:"SoftRight",location:4},Camera:{keyCode:44,key:"Camera",code:"Camera",location:4},Call:{key:"Call",code:"Call",location:4},EndCall:{keyCode:95,key:"EndCall",code:"EndCall",location:4},VolumeDown:{keyCode:182,key:"VolumeDown",code:"VolumeDown",location:4},VolumeUp:{keyCode:183,key:"VolumeUp",code:"VolumeUp",location:4}};/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Ur,Pn,si,Bu,ju;class Xy extends iy{constructor(e){super();d(this,si);d(this,Ur);d(this,Pn,new Set);F(this,"_modifiers",0);p(this,Ur,e)}updateClient(e){p(this,Ur,e)}async down(e,t={text:void 0,commands:[]}){const i=b(this,si,ju).call(this,e),a=n(this,Pn).has(i.code);n(this,Pn).add(i.code),this._modifiers|=b(this,si,Bu).call(this,i.key);const o=t.text===void 0?i.text:t.text;await n(this,Ur).send("Input.dispatchKeyEvent",{type:o?"keyDown":"rawKeyDown",modifiers:this._modifiers,windowsVirtualKeyCode:i.keyCode,code:i.code,key:i.key,text:o,unmodifiedText:o,autoRepeat:a,location:i.location,isKeypad:i.location===3,commands:t.commands})}async up(e){const t=b(this,si,ju).call(this,e);this._modifiers&=~b(this,si,Bu).call(this,t.key),n(this,Pn).delete(t.code),await n(this,Ur).send("Input.dispatchKeyEvent",{type:"keyUp",modifiers:this._modifiers,key:t.key,windowsVirtualKeyCode:t.keyCode,code:t.code,location:t.location})}async sendCharacter(e){await n(this,Ur).send("Input.insertText",{text:e})}charIsKey(e){return!!eh[e]}async type(e,t={}){const i=t.delay||void 0;for(const a of e)this.charIsKey(a)?await this.press(a,{delay:i}):(i&&await new Promise(o=>setTimeout(o,i)),await this.sendCharacter(a))}async press(e,t={}){const{delay:i=null}=t;await this.down(e,t),i&&await new Promise(a=>setTimeout(a,t.delay)),await this.up(e)}}Ur=new WeakMap,Pn=new WeakMap,si=new WeakSet,Bu=function(e){return e==="Alt"?1:e==="Control"?2:e==="Meta"?4:e==="Shift"?8:0},ju=function(e){const t=this._modifiers&8,i={key:"",keyCode:0,code:"",text:"",location:0},a=eh[e];return x(a,`Unknown key: "${e}"`),a.key&&(i.key=a.key),t&&a.shiftKey&&(i.key=a.shiftKey),a.keyCode&&(i.keyCode=a.keyCode),t&&a.shiftKeyCode&&(i.keyCode=a.shiftKeyCode),a.code&&(i.code=a.code),a.location&&(i.location=a.location),i.key.length===1&&(i.text=i.key),a.text&&(i.text=a.text),t&&a.shiftText&&(i.text=a.shiftText),this._modifiers&-9&&(i.text=""),i};const th=s=>{switch(s){case Re.Left:return 1;case Re.Right:return 2;case Re.Middle:return 4;case Re.Back:return 8;case Re.Forward:return 16}},Qy=s=>s&1?Re.Left:s&2?Re.Right:s&4?Re.Middle:s&8?Re.Back:s&16?Re.Forward:"none";var st,wt,_n,me,Ye,Yi,hp,Uc;class Yy extends sy{constructor(e,t){super();d(this,me);d(this,st);d(this,wt);d(this,_n,{position:{x:0,y:0},buttons:0});d(this,Yi,[]);p(this,st,e),p(this,wt,t)}updateClient(e){p(this,st,e)}async reset(){const e=[];for(const[t,i]of[[1,Re.Left],[4,Re.Middle],[2,Re.Right],[16,Re.Forward],[8,Re.Back]])n(this,me,Ye).buttons&t&&e.push(this.up({button:i}));(n(this,me,Ye).position.x!==0||n(this,me,Ye).position.y!==0)&&e.push(this.move(0,0)),await Promise.all(e)}async move(e,t,i={}){const{steps:a=1}=i,o=n(this,me,Ye).position,c={x:e,y:t};for(let l=1;l<=a;l++)await b(this,me,Uc).call(this,u=>{u({position:{x:o.x+(c.x-o.x)*(l/a),y:o.y+(c.y-o.y)*(l/a)}});const{buttons:f,position:w}=n(this,me,Ye);return n(this,st).send("Input.dispatchMouseEvent",{type:"mouseMoved",modifiers:n(this,wt)._modifiers,buttons:f,button:Qy(f),...w})})}async down(e={}){const{button:t=Re.Left,clickCount:i=1}=e,a=th(t);if(!a)throw new Error(`Unsupported mouse button: ${t}`);if(n(this,me,Ye).buttons&a)throw new Error(`'${t}' is already pressed.`);await b(this,me,Uc).call(this,o=>{o({buttons:n(this,me,Ye).buttons|a});const{buttons:c,position:l}=n(this,me,Ye);return n(this,st).send("Input.dispatchMouseEvent",{type:"mousePressed",modifiers:n(this,wt)._modifiers,clickCount:i,buttons:c,button:t,...l})})}async up(e={}){const{button:t=Re.Left,clickCount:i=1}=e,a=th(t);if(!a)throw new Error(`Unsupported mouse button: ${t}`);if(!(n(this,me,Ye).buttons&a))throw new Error(`'${t}' is not pressed.`);await b(this,me,Uc).call(this,o=>{o({buttons:n(this,me,Ye).buttons&~a});const{buttons:c,position:l}=n(this,me,Ye);return n(this,st).send("Input.dispatchMouseEvent",{type:"mouseReleased",modifiers:n(this,wt)._modifiers,clickCount:i,buttons:c,button:t,...l})})}async click(e,t,i={}){const{delay:a,count:o=1,clickCount:c=o}=i;if(o<1)throw new Error("Click must occur a positive number of times.");const l=[this.move(e,t)];if(c===o)for(let u=1;u<o;++u)l.push(this.down({...i,clickCount:u}),this.up({...i,clickCount:u}));l.push(this.down({...i,clickCount:c})),typeof a=="number"&&(await Promise.all(l),l.length=0,await new Promise(u=>{setTimeout(u,a)})),l.push(this.up({...i,clickCount:c})),await Promise.all(l)}async wheel(e={}){const{deltaX:t=0,deltaY:i=0}=e,{position:a,buttons:o}=n(this,me,Ye);await n(this,st).send("Input.dispatchMouseEvent",{type:"mouseWheel",pointerType:"mouse",modifiers:n(this,wt)._modifiers,deltaY:i,deltaX:t,buttons:o,...a})}async drag(e,t){const i=new Promise(a=>{n(this,st).once("Input.dragIntercepted",o=>a(o.data))});return await this.move(e.x,e.y),await this.down(),await this.move(t.x,t.y),await i}async dragEnter(e,t){await n(this,st).send("Input.dispatchDragEvent",{type:"dragEnter",x:e.x,y:e.y,modifiers:n(this,wt)._modifiers,data:t})}async dragOver(e,t){await n(this,st).send("Input.dispatchDragEvent",{type:"dragOver",x:e.x,y:e.y,modifiers:n(this,wt)._modifiers,data:t})}async drop(e,t){await n(this,st).send("Input.dispatchDragEvent",{type:"drop",x:e.x,y:e.y,modifiers:n(this,wt)._modifiers,data:t})}async dragAndDrop(e,t,i={}){const{delay:a=null}=i,o=await this.drag(e,t);await this.dragEnter(t,o),await this.dragOver(t,o),a&&await new Promise(c=>setTimeout(c,a)),await this.drop(t,o),await this.up()}}st=new WeakMap,wt=new WeakMap,_n=new WeakMap,me=new WeakSet,Ye=function(){return Object.assign({...n(this,_n)},...n(this,Yi))},Yi=new WeakMap,hp=function(){const e={};n(this,Yi).push(e);const t=()=>{n(this,Yi).splice(n(this,Yi).indexOf(e),1)};return{update:i=>{Object.assign(e,i)},commit:()=>{p(this,_n,{...n(this,_n),...e}),t()},rollback:t}},Uc=async function(e){const{update:t,commit:i,rollback:a}=b(this,me,hp).call(this);try{await e(t),i()}catch(o){throw a(),o}};var Ho,Go,ar,Hr,Zi;class Zy{constructor(r,e,t,i){d(this,Ho,!1);d(this,Go);d(this,ar);d(this,Hr);d(this,Zi);p(this,Hr,r),p(this,Go,e),p(this,Zi,t),p(this,ar,i)}updateClient(r){p(this,Hr,r)}async start(){if(n(this,Ho))throw new Xl("Touch has already started");await n(this,Hr).send("Input.dispatchTouchEvent",{type:"touchStart",touchPoints:[n(this,ar)],modifiers:n(this,Zi)._modifiers}),p(this,Ho,!0)}move(r,e){return n(this,ar).x=Math.round(r),n(this,ar).y=Math.round(e),n(this,Hr).send("Input.dispatchTouchEvent",{type:"touchMove",touchPoints:[n(this,ar)],modifiers:n(this,Zi)._modifiers})}async end(){await n(this,Hr).send("Input.dispatchTouchEvent",{type:"touchEnd",touchPoints:[n(this,ar)],modifiers:n(this,Zi)._modifiers}),n(this,Go).removeHandle(this)}}Ho=new WeakMap,Go=new WeakMap,ar=new WeakMap,Hr=new WeakMap,Zi=new WeakMap;var Mn,Vo;class ew extends ny{constructor(e,t){super();d(this,Mn);d(this,Vo);p(this,Mn,e),p(this,Vo,t)}updateClient(e){p(this,Mn,e),this.touches.forEach(t=>{t.updateClient(e)})}async touchStart(e,t){const i=this.idGenerator(),a={x:Math.round(e),y:Math.round(t),radiusX:.5,radiusY:.5,force:.5,id:i},o=new Zy(n(this,Mn),this,n(this,Vo),a);return await o.start(),this.touches.push(o),o}}Mn=new WeakMap,Vo=new WeakMap;var or,An,zo;class tw{constructor(r){d(this,or);d(this,An,!1);d(this,zo);p(this,or,r)}updateClient(r){p(this,or,r)}async start(r={}){x(!n(this,An),"Cannot start recording trace while already recording trace.");const e=["-*","devtools.timeline","v8.execute","disabled-by-default-devtools.timeline","disabled-by-default-devtools.timeline.frame","toplevel","blink.console","blink.user_timing","latencyInfo","disabled-by-default-devtools.timeline.stack","disabled-by-default-v8.cpu_profiler"],{path:t,screenshots:i=!1,categories:a=e}=r;i&&a.push("disabled-by-default-devtools.screenshot");const o=a.filter(l=>l.startsWith("-")).map(l=>l.slice(1)),c=a.filter(l=>!l.startsWith("-"));p(this,zo,t),p(this,An,!0),await n(this,or).send("Tracing.start",{transferMode:"ReturnAsStream",traceConfig:{excludedCategories:o,includedCategories:c}})}async stop(){const r=ue.create();return n(this,or).once("Tracing.tracingComplete",async e=>{try{x(e.stream,'Missing "stream"');const t=await Yh(n(this,or),e.stream),i=await Qh(t,n(this,zo));r.resolve(i??void 0)}catch(t){Ut(t)?r.reject(t):r.reject(new Error(`Unknown error: ${t}`))}}),await n(this,or).send("Tracing.end"),p(this,An,!1),await r.valueOrThrow()}}or=new WeakMap,An=new WeakMap,zo=new WeakMap;var Nt,cr,Jo,Xo;class fp extends py{constructor(e,t,i,a,o,c){super(t);d(this,Nt);d(this,cr);d(this,Jo);d(this,Xo);p(this,Jo,i),p(this,cr,e),p(this,Xo,a),p(this,Nt,new Mu(this,new gd)),n(this,cr).once("Runtime.executionContextCreated",async l=>{n(this,Nt).setContext(new Ff(e,l.context,n(this,Nt)))}),n(this,Nt).emitter.on("consoleapicalled",async l=>{try{return o(l.type,l.args.map(u=>new Al(n(this,Nt),u)),l.stackTrace)}catch(u){B(u)}}),n(this,cr).on("Runtime.exceptionThrown",c),n(this,cr).once(fe.Disconnected,()=>{n(this,Nt).dispose()}),n(this,cr).send("Runtime.enable").catch(B)}mainRealm(){return n(this,Nt)}get client(){return n(this,cr)}async close(){var e,t;switch(n(this,Xo)){case at.SERVICE_WORKER:case at.SHARED_WORKER:{await((e=this.client.connection())==null?void 0:e.send("Target.closeTarget",{targetId:n(this,Jo)})),await((t=this.client.connection())==null?void 0:t.send("Target.detachFromTarget",{sessionId:this.client.id()}));break}default:await this.evaluate(()=>{self.close()})}}}Nt=new WeakMap,cr=new WeakMap,Jo=new WeakMap,Xo=new WeakMap;/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Bl=function(s,r,e){if(r!=null){if(typeof r!="object"&&typeof r!="function")throw new TypeError("Object expected.");var t,i;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");t=r[Symbol.asyncDispose]}if(t===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");t=r[Symbol.dispose],e&&(i=t)}if(typeof t!="function")throw new TypeError("Object not disposable.");i&&(t=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),s.stack.push({value:r,dispose:t,async:e})}else e&&s.stack.push({async:!0});return r},jl=function(s){return function(r){function e(o){r.error=r.hasError?new s(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,i=0;function a(){for(;t=r.stack.pop();)try{if(!t.async&&i===1)return i=0,r.stack.push(t),Promise.resolve().then(a);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return i|=2,Promise.resolve(o).then(a,function(c){return e(c),a()})}else i|=1}catch(c){e(c)}if(i===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return a()}}(typeof SuppressedError=="function"?SuppressedError:function(s,r,e){var t=new Error(e);return t.name="SuppressedError",t.error=s,t.suppressed=r,t});function ql(s){switch(s){case"warning":return"warn";default:return s}}var Qo,Gr,ne,vt,Vr,es,zr,In,Fn,de,we,Dn,Jr,On,xn,Rn,ts,lr,bl,Yo,Zo,X,pp,mp,gp,qu,ec,Ln,yp,wp,vp,bp,Sp,Uu,Hu,kp,Ep,Gu,Tp,Vu;const Cd=class Cd extends ly{constructor(e,t){super();d(this,X);d(this,Qo,!1);d(this,Gr);d(this,ne);d(this,vt);d(this,Vr);d(this,es);d(this,zr);d(this,In);d(this,Fn);d(this,de);d(this,we);d(this,Dn);d(this,Jr,new Map);d(this,On,new Map);d(this,xn);d(this,Rn);d(this,ts,new Map);d(this,lr,new Set);d(this,bl,ue.create());d(this,Yo,!1);d(this,Zo,!1);d(this,ec,e=>{var a;const t=(a=e._session())==null?void 0:a.id(),i=n(this,ts).get(t);i&&(n(this,ts).delete(t),this.emit("workerdestroyed",i))});d(this,Ln,e=>{if(x(e instanceof la),n(this,de).onAttachedToTarget(e.target()),e.target()._getTargetInfo().type==="worker"){const t=new fp(e,e.target().url(),e.target()._targetId,e.target().type(),b(this,X,Gu).bind(this),b(this,X,Hu).bind(this));n(this,ts).set(e.id(),t),this.emit("workercreated",t)}e.on(fe.Ready,n(this,Ln))});p(this,ne,e),p(this,Vr,e.parentSession()),x(n(this,Vr),"Tab target session is not defined."),p(this,es,n(this,Vr).target()),x(n(this,es),"Tab target is not defined."),p(this,vt,t),p(this,Gr,t._targetManager()),p(this,zr,new Xy(e)),p(this,In,new Yy(e,n(this,zr))),p(this,Fn,new ew(e,n(this,zr))),p(this,de,new Jy(e,this,this._timeoutSettings)),p(this,we,new Ay(e)),p(this,Dn,new tw(e)),p(this,xn,new Ty(e)),p(this,Rn,null);const i=new pe(n(this,de));i.on(Ae.FrameAttached,o=>{this.emit("frameattached",o)}),i.on(Ae.FrameDetached,o=>{this.emit("framedetached",o)}),i.on(Ae.FrameNavigated,o=>{this.emit("framenavigated",o)}),i.on(Ae.ConsoleApiCalled,([o,c])=>{b(this,X,kp).call(this,o,c)}),i.on(Ae.BindingCalled,([o,c])=>{b(this,X,Ep).call(this,o,c)});const a=new pe(n(this,de).networkManager);a.on(Me.Request,o=>{this.emit("request",o)}),a.on(Me.RequestServedFromCache,o=>{this.emit("requestservedfromcache",o)}),a.on(Me.Response,o=>{this.emit("response",o)}),a.on(Me.RequestFailed,o=>{this.emit("requestfailed",o)}),a.on(Me.RequestFinished,o=>{this.emit("requestfinished",o)}),n(this,Vr).on(fe.Swapped,b(this,X,mp).bind(this)),n(this,Vr).on(fe.Ready,b(this,X,gp).bind(this)),n(this,Gr).on("targetGone",n(this,ec)),n(this,es)._isClosedDeferred.valueOrThrow().then(()=>{n(this,Gr).off("targetGone",n(this,ec)),this.emit("close",void 0),p(this,Qo,!0)}).catch(B),b(this,X,qu).call(this),b(this,X,pp).call(this)}static async _create(e,t,i){var o;const a=new Cd(e,t);if(await b(o=a,X,yp).call(o),i)try{await a.setViewport(i)}catch(c){if(Ut(c)&&pu(c))B(c);else throw c}return a}_client(){return n(this,ne)}isServiceWorkerBypassed(){return n(this,Yo)}isDragInterceptionEnabled(){return n(this,Zo)}isJavaScriptEnabled(){return n(this,we).javascriptEnabled}async waitForFileChooser(e={}){const t=n(this,lr).size===0,{timeout:i=this._timeoutSettings.timeout()}=e,a=ue.create({message:`Waiting for \`FileChooser\` failed: ${i}ms exceeded`,timeout:i});e.signal&&e.signal.addEventListener("abort",()=>{var c;a.reject((c=e.signal)==null?void 0:c.reason)},{once:!0}),n(this,lr).add(a);let o;t&&(o=n(this,ne).send("Page.setInterceptFileChooserDialog",{enabled:!0}));try{const[c]=await Promise.all([a.valueOrThrow(),o]);return c}catch(c){throw n(this,lr).delete(a),c}}async setGeolocation(e){return await n(this,we).setGeolocation(e)}target(){return n(this,vt)}browser(){return n(this,vt).browser()}browserContext(){return n(this,vt).browserContext()}mainFrame(){return n(this,de).mainFrame()}get keyboard(){return n(this,zr)}get touchscreen(){return n(this,Fn)}get coverage(){return n(this,xn)}get tracing(){return n(this,Dn)}frames(){return n(this,de).frames()}workers(){return Array.from(n(this,ts).values())}async setRequestInterception(e){return await n(this,de).networkManager.setRequestInterception(e)}async setBypassServiceWorker(e){return p(this,Yo,e),await n(this,ne).send("Network.setBypassServiceWorker",{bypass:e})}async setDragInterception(e){return p(this,Zo,e),await n(this,ne).send("Input.setInterceptDrags",{enabled:e})}async setOfflineMode(e){return await n(this,de).networkManager.setOfflineMode(e)}async emulateNetworkConditions(e){return await n(this,de).networkManager.emulateNetworkConditions(e)}setDefaultNavigationTimeout(e){this._timeoutSettings.setDefaultNavigationTimeout(e)}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e)}getDefaultTimeout(){return this._timeoutSettings.timeout()}getDefaultNavigationTimeout(){return this._timeoutSettings.navigationTimeout()}async queryObjects(e){x(!e.disposed,"Prototype JSHandle is disposed!"),x(e.id,"Prototype JSHandle must not be referencing primitive value");const t=await this.mainFrame().client.send("Runtime.queryObjects",{prototypeObjectId:e.id});return this.mainFrame().mainRealm().createCdpHandle(t.objects)}async cookies(...e){const t=(await n(this,ne).send("Network.getCookies",{urls:e.length?e:[this.url()]})).cookies,i=["sourcePort"],a=o=>{for(const c of i)delete o[c];return o};return t.map(a).map(o=>({...o,partitionKey:o.partitionKey?o.partitionKey.topLevelSite:void 0}))}async deleteCookie(...e){const t=this.url();for(const i of e){const a={...i,partitionKey:zu(i.partitionKey)};if(!i.url&&t.startsWith("http")&&(a.url=t),await n(this,ne).send("Network.deleteCookies",a),t.startsWith("http")&&!a.partitionKey){const o=new URL(t);await n(this,ne).send("Network.deleteCookies",{...a,partitionKey:{topLevelSite:o.origin.replace(`:${o.port}`,""),hasCrossSiteAncestor:!1}})}}}async setCookie(...e){const t=this.url(),i=t.startsWith("http"),a=e.map(o=>{const c=Object.assign({},o);return!c.url&&i&&(c.url=t),x(c.url!=="about:blank",`Blank page can not have cookie "${c.name}"`),x(!String.prototype.startsWith.call(c.url||"","data:"),`Data URL page can not have cookie "${c.name}"`),c});await this.deleteCookie(...a),a.length&&await n(this,ne).send("Network.setCookies",{cookies:a.map(o=>({...o,partitionKey:zu(o.partitionKey)}))})}async exposeFunction(e,t){if(n(this,Jr).has(e))throw new Error(`Failed to add page binding with name ${e}: window['${e}'] already exists!`);const i=Ry("exposedFun",e);let a;switch(typeof t){case"function":a=new nl(e,t,i);break;default:a=new nl(e,t.default,i);break}n(this,Jr).set(e,a);const[{identifier:o}]=await Promise.all([n(this,de).evaluateOnNewDocument(i),n(this,de).addExposedFunctionBinding(a)]);n(this,On).set(e,o)}async removeExposedFunction(e){const t=n(this,On).get(e);if(!t)throw new Error(`Function with name "${e}" does not exist`);const i=n(this,Jr).get(e);n(this,On).delete(e),n(this,Jr).delete(e),await Promise.all([n(this,de).removeScriptToEvaluateOnNewDocument(t),n(this,de).removeExposedFunctionBinding(i)])}async authenticate(e){return await n(this,de).networkManager.authenticate(e)}async setExtraHTTPHeaders(e){return await n(this,de).networkManager.setExtraHTTPHeaders(e)}async setUserAgent(e,t){return await n(this,de).networkManager.setUserAgent(e,t)}async metrics(){const e=await n(this,ne).send("Performance.getMetrics");return b(this,X,Uu).call(this,e.metrics)}async reload(e){const[t]=await Promise.all([this.waitForNavigation({...e,ignoreSameDocumentNavigation:!0}),n(this,ne).send("Page.reload")]);return t}async createCDPSession(){return await this.target().createCDPSession()}async goBack(e={}){return await b(this,X,Vu).call(this,-1,e)}async goForward(e={}){return await b(this,X,Vu).call(this,1,e)}async bringToFront(){await n(this,ne).send("Page.bringToFront")}async setJavaScriptEnabled(e){return await n(this,we).setJavaScriptEnabled(e)}async setBypassCSP(e){await n(this,ne).send("Page.setBypassCSP",{enabled:e})}async emulateMediaType(e){return await n(this,we).emulateMediaType(e)}async emulateCPUThrottling(e){return await n(this,we).emulateCPUThrottling(e)}async emulateMediaFeatures(e){return await n(this,we).emulateMediaFeatures(e)}async emulateTimezone(e){return await n(this,we).emulateTimezone(e)}async emulateIdleState(e){return await n(this,we).emulateIdleState(e)}async emulateVisionDeficiency(e){return await n(this,we).emulateVisionDeficiency(e)}async setViewport(e){const t=await n(this,we).emulateViewport(e);p(this,Rn,e),t&&await this.reload()}viewport(){return n(this,Rn)}async evaluateOnNewDocument(e,...t){const i=Xh(e,...t);return await n(this,de).evaluateOnNewDocument(i)}async removeScriptToEvaluateOnNewDocument(e){return await n(this,de).removeScriptToEvaluateOnNewDocument(e)}async setCacheEnabled(e=!0){await n(this,de).networkManager.setCacheEnabled(e)}async _screenshot(e){const t={stack:[],error:void 0,hasError:!1};try{const{fromSurface:i,omitBackground:a,optimizeForSpeed:o,quality:c,clip:l,type:u,captureBeyondViewport:f}=e,w=Bl(t,new Qc,!0);a&&(u==="png"||u==="webp")&&(await n(this,we).setTransparentBackgroundColor(),w.defer(async()=>{await n(this,we).resetDefaultBackgroundColor().catch(B)}));let h=l;if(h&&!f){const S=await this.mainFrame().isolatedRealm().evaluate(()=>{const{height:m,pageLeft:v,pageTop:T,width:D}=window.visualViewport;return{x:v,y:T,height:m,width:D}});h=iw(h,S)}const{data:g}=await n(this,ne).send("Page.captureScreenshot",{format:u,optimizeForSpeed:o,fromSurface:i,...c!==void 0?{quality:Math.round(c)}:{},...h?{clip:{...h,scale:h.scale??1}}:{},captureBeyondViewport:f});return g}catch(i){t.error=i,t.hasError=!0}finally{const i=jl(t);i&&await i}}async createPDFStream(e={}){const{timeout:t=this._timeoutSettings.timeout()}=e,{landscape:i,displayHeaderFooter:a,headerTemplate:o,footerTemplate:c,printBackground:l,scale:u,width:f,height:w,margin:h,pageRanges:g,preferCSSPageSize:S,omitBackground:m,tagged:v,outline:T,waitForFonts:D}=hg(e);m&&await n(this,we).setTransparentBackgroundColor(),D&&await Je(se(this.mainFrame().isolatedRealm().evaluate(()=>document.fonts.ready)).pipe(Wt(Bt(t))));const P=n(this,ne).send("Page.printToPDF",{transferMode:"ReturnAsStream",landscape:i,displayHeaderFooter:a,headerTemplate:o,footerTemplate:c,printBackground:l,scale:u,paperWidth:f,paperHeight:w,marginTop:h.top,marginBottom:h.bottom,marginLeft:h.left,marginRight:h.right,pageRanges:g,preferCSSPageSize:S,generateTaggedPDF:v,generateDocumentOutline:T}),M=await Je(se(P).pipe(Wt(Bt(t))));return m&&await n(this,we).resetDefaultBackgroundColor(),x(M.stream,"`stream` is missing from `Page.printToPDF"),await Yh(n(this,ne),M.stream)}async pdf(e={}){const{path:t=void 0}=e,i=await this.createPDFStream(e),a=await Qh(i,t);return x(a,"Could not create typed array"),a}async close(e={runBeforeUnload:void 0}){const t={stack:[],error:void 0,hasError:!1};try{const i=Bl(t,await this.browserContext().waitForScreenshotOperations(),!1),a=n(this,ne).connection();x(a,"Protocol error: Connection closed. Most likely the page has been closed."),!!e.runBeforeUnload?await n(this,ne).send("Page.close"):(await a.send("Target.closeTarget",{targetId:n(this,vt)._targetId}),await n(this,es)._isClosedDeferred.valueOrThrow())}catch(i){t.error=i,t.hasError=!0}finally{jl(t)}}isClosed(){return n(this,Qo)}get mouse(){return n(this,In)}async waitForDevicePrompt(e={}){return await this.mainFrame().waitForDevicePrompt(e)}};Qo=new WeakMap,Gr=new WeakMap,ne=new WeakMap,vt=new WeakMap,Vr=new WeakMap,es=new WeakMap,zr=new WeakMap,In=new WeakMap,Fn=new WeakMap,de=new WeakMap,we=new WeakMap,Dn=new WeakMap,Jr=new WeakMap,On=new WeakMap,xn=new WeakMap,Rn=new WeakMap,ts=new WeakMap,lr=new WeakMap,bl=new WeakMap,Yo=new WeakMap,Zo=new WeakMap,X=new WeakSet,pp=function(){const e=[];for(const i of n(this,Gr).getChildTargets(n(this,vt)))e.push(i);let t=0;for(;t<e.length;){const i=e[t];t++;const a=i._session();a&&n(this,Ln).call(this,a);for(const o of n(this,Gr).getChildTargets(i))e.push(o)}},mp=async function(e){x(e instanceof la,"CDPSession is not instance of CdpCDPSession"),p(this,ne,e),p(this,vt,e.target()),x(n(this,vt),"Missing target on swap"),n(this,zr).updateClient(e),n(this,In).updateClient(e),n(this,Fn).updateClient(e),n(this,we).updateClient(e),n(this,Dn).updateClient(e),n(this,xn).updateClient(e),await n(this,de).swapFrameTree(e),b(this,X,qu).call(this)},gp=async function(e){x(e instanceof la),e.target()._subtype()==="prerender"&&(n(this,de).registerSpeculativeSession(e).catch(B),n(this,we).registerSpeculativeSession(e).catch(B))},qu=function(){const e=new pe(n(this,ne));e.on(fe.Ready,n(this,Ln)),e.on(fe.Disconnected,()=>{n(this,bl).reject(new ti("Target closed"))}),e.on("Page.domContentEventFired",()=>{this.emit("domcontentloaded",void 0)}),e.on("Page.loadEventFired",()=>{this.emit("load",void 0)}),e.on("Page.javascriptDialogOpening",b(this,X,Tp).bind(this)),e.on("Runtime.exceptionThrown",b(this,X,Hu).bind(this)),e.on("Inspector.targetCrashed",b(this,X,vp).bind(this)),e.on("Performance.metrics",b(this,X,Sp).bind(this)),e.on("Log.entryAdded",b(this,X,bp).bind(this)),e.on("Page.fileChooserOpened",b(this,X,wp).bind(this))},ec=new WeakMap,Ln=new WeakMap,yp=async function(){try{await Promise.all([n(this,de).initialize(n(this,ne)),n(this,ne).send("Performance.enable"),n(this,ne).send("Log.enable")])}catch(e){if(Ut(e)&&pu(e))B(e);else throw e}},wp=async function(e){const t={stack:[],error:void 0,hasError:!1};try{if(!n(this,lr).size)return;const i=n(this,de).frame(e.frameId);x(i,"This should never happen.");const a=Bl(t,await i.worlds[At].adoptBackendNode(e.backendNodeId),!1),o=new by(a.move(),e);for(const c of n(this,lr))c.resolve(o);n(this,lr).clear()}catch(i){t.error=i,t.hasError=!0}finally{jl(t)}},vp=function(){this.emit("error",new Error("Page crashed!"))},bp=function(e){const{level:t,text:i,args:a,source:o,url:c,lineNumber:l}=e.entry;a&&a.map(u=>{Mf(n(this,ne),u)}),o!=="worker"&&this.emit("console",new Jd(ql(t),i,[],[{url:c,lineNumber:l}]))},Sp=function(e){this.emit("metrics",{title:e.title,metrics:b(this,X,Uu).call(this,e.metrics)})},Uu=function(e){const t={};for(const i of e||[])rw.has(i.name)&&(t[i.name]=i.value);return t},Hu=function(e){this.emit("pageerror",xy(e.exceptionDetails))},kp=function(e,t){const i=t.args.map(a=>e.createCdpHandle(a));b(this,X,Gu).call(this,ql(t.type),i,t.stackTrace)},Ep=async function(e,t){let i;try{i=JSON.parse(t.payload)}catch{return}const{type:a,name:o,seq:c,args:l,isTrivial:u}=i;if(a!=="exposedFun")return;const f=e.context;if(!f)return;const w=n(this,Jr).get(o);await(w==null?void 0:w.run(f,c,l,u))},Gu=function(e,t,i){if(!this.listenerCount("console")){t.forEach(l=>l.dispose());return}const a=[];for(const l of t){const u=l.remoteObject();u.objectId?a.push(l.toString()):a.push(hs(u))}const o=[];if(i)for(const l of i.callFrames)o.push({url:l.url,lineNumber:l.lineNumber,columnNumber:l.columnNumber});const c=new Jd(ql(e),a.join(" "),t,o);this.emit("console",c)},Tp=function(e){const t=lg(e.type),i=new _y(n(this,ne),t,e.message,e.defaultPrompt);this.emit("dialog",i)},Vu=async function(e,t){const i=await n(this,ne).send("Page.getNavigationHistory"),a=i.entries[i.currentIndex+e];return a?(await Promise.all([this.waitForNavigation(t),n(this,ne).send("Page.navigateToHistoryEntry",{entryId:a.id})]))[0]:null};let ya=Cd;const rw=new Set(["Timestamp","Documents","Frames","JSEventListeners","Nodes","LayoutCount","RecalcStyleCount","LayoutDuration","RecalcStyleDuration","ScriptDuration","TaskDuration","JSHeapUsedSize","JSHeapTotalSize"]);function iw(s,r){const e=Math.max(s.x,r.x),t=Math.max(s.y,r.y);return{x:e,y:t,width:Math.max(Math.min(s.x+s.width,r.x+r.width)-e,0),height:Math.max(Math.min(s.y+s.height,r.y+r.height)-t,0)}}function zu(s){if(s!==void 0)return typeof s=="string"?{topLevelSite:s,hasCrossSiteAncestor:!1}:{topLevelSite:s.sourceOrigin,hasCrossSiteAncestor:s.hasCrossSiteAncestor??!1}}/**
 * @license
 * Copyright 2024 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var sw=function(s,r,e){if(r!=null){if(typeof r!="object"&&typeof r!="function")throw new TypeError("Object expected.");var t,i;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");t=r[Symbol.asyncDispose]}if(t===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");t=r[Symbol.dispose],e&&(i=t)}if(typeof t!="function")throw new TypeError("Object not disposable.");i&&(t=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),s.stack.push({value:r,dispose:t,async:e})}else e&&s.stack.push({async:!0});return r},nw=function(s){return function(r){function e(o){r.error=r.hasError?new s(o,r.error,"An error was suppressed during disposal."):o,r.hasError=!0}var t,i=0;function a(){for(;t=r.stack.pop();)try{if(!t.async&&i===1)return i=0,r.stack.push(t),Promise.resolve().then(a);if(t.dispose){var o=t.dispose.call(t.value);if(t.async)return i|=2,Promise.resolve(o).then(a,function(c){return e(c),a()})}else i|=1}catch(c){e(c)}if(i===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return a()}}(typeof SuppressedError=="function"?SuppressedError:function(s,r,e){var t=new Error(e);return t.name="SuppressedError",t.error=s,t.suppressed=r,t}),ur,dr,nt;class Ul extends mg{constructor(e,t,i){super();d(this,ur);d(this,dr);d(this,nt);p(this,ur,e),p(this,dr,t),p(this,nt,i)}get id(){return n(this,nt)}targets(){return n(this,dr).targets().filter(e=>e.browserContext()===this)}async pages(){return(await Promise.all(this.targets().filter(t=>{var i;return t.type()==="page"||t.type()==="other"&&((i=n(this,dr)._getIsPageTargetCallback())==null?void 0:i(t))}).map(t=>t.page()))).filter(t=>!!t)}async overridePermissions(e,t){const i=t.map(a=>{const o=fg.get(a);if(!o)throw new Error("Unknown permission: "+a);return o});await n(this,ur).send("Browser.grantPermissions",{origin:e,browserContextId:n(this,nt)||void 0,permissions:i})}async clearPermissionOverrides(){await n(this,ur).send("Browser.resetPermissions",{browserContextId:n(this,nt)||void 0})}async newPage(){const e={stack:[],error:void 0,hasError:!1};try{const t=sw(e,await this.waitForScreenshotOperations(),!1);return await n(this,dr)._createPageInContext(n(this,nt))}catch(t){e.error=t,e.hasError=!0}finally{nw(e)}}browser(){return n(this,dr)}async close(){x(n(this,nt),"Default BrowserContext cannot be closed!"),await n(this,dr)._disposeContext(n(this,nt))}async cookies(){const{cookies:e}=await n(this,ur).send("Storage.getCookies",{browserContextId:n(this,nt)});return e.map(t=>({...t,partitionKey:t.partitionKey?{sourceOrigin:t.partitionKey.topLevelSite,hasCrossSiteAncestor:t.partitionKey.hasCrossSiteAncestor}:void 0}))}async setCookie(...e){return await n(this,ur).send("Storage.setCookies",{browserContextId:n(this,nt),cookies:e.map(t=>({...t,partitionKey:zu(t.partitionKey)}))})}async setDownloadBehavior(e){await n(this,ur).send("Browser.setDownloadBehavior",{behavior:e.policy,downloadPath:e.downloadPath,browserContextId:n(this,nt)})}}ur=new WeakMap,dr=new WeakMap,nt=new WeakMap;var ht;(function(s){s.SUCCESS="success",s.ABORTED="aborted"})(ht||(ht={}));var Xr,rs,Kt,Nn,Qr,Kn;class Il extends fy{constructor(e,t,i,a,o){super();d(this,Xr);d(this,rs);d(this,Kt);d(this,Nn);d(this,Qr);d(this,Kn,new Set);F(this,"_initializedDeferred",ue.create());F(this,"_isClosedDeferred",ue.create());F(this,"_targetId");p(this,rs,t),p(this,Nn,a),p(this,Kt,e),p(this,Xr,i),this._targetId=e.targetId,p(this,Qr,o),n(this,rs)&&n(this,rs).setTarget(this)}async asPage(){const e=this._session();return e?await ya._create(e,this,null):await this.createCDPSession().then(t=>ya._create(t,this,null))}_subtype(){return n(this,Kt).subtype}_session(){return n(this,rs)}_addChildTarget(e){n(this,Kn).add(e)}_removeChildTarget(e){n(this,Kn).delete(e)}_childTargets(){return n(this,Kn)}_sessionFactory(){if(!n(this,Qr))throw new Error("sessionFactory is not initialized");return n(this,Qr)}createCDPSession(){if(!n(this,Qr))throw new Error("sessionFactory is not initialized");return n(this,Qr).call(this,!1).then(e=>(e.setTarget(this),e))}url(){return n(this,Kt).url}type(){switch(n(this,Kt).type){case"page":return at.PAGE;case"background_page":return at.BACKGROUND_PAGE;case"service_worker":return at.SERVICE_WORKER;case"shared_worker":return at.SHARED_WORKER;case"browser":return at.BROWSER;case"webview":return at.WEBVIEW;case"tab":return at.TAB;default:return at.OTHER}}_targetManager(){if(!n(this,Nn))throw new Error("targetManager is not initialized");return n(this,Nn)}_getTargetInfo(){return n(this,Kt)}browser(){if(!n(this,Xr))throw new Error("browserContext is not initialized");return n(this,Xr).browser()}browserContext(){if(!n(this,Xr))throw new Error("browserContext is not initialized");return n(this,Xr)}opener(){const{openerId:e}=n(this,Kt);if(e)return this.browser().targets().find(t=>t._targetId===e)}_targetInfoChanged(e){p(this,Kt,e),this._checkIfInitialized()}_initialize(){this._initializedDeferred.resolve(ht.SUCCESS)}_isTargetExposed(){return this.type()!==at.TAB&&!this._subtype()}_checkIfInitialized(){this._initializedDeferred.resolved()||this._initializedDeferred.resolve(ht.SUCCESS)}}Xr=new WeakMap,rs=new WeakMap,Kt=new WeakMap,Nn=new WeakMap,Qr=new WeakMap,Kn=new WeakMap;var tc;const Pd=class Pd extends Il{constructor(e,t,i,a,o,c){super(e,t,i,a,o);d(this,tc);F(this,"pagePromise");p(this,tc,c??void 0)}_initialize(){this._initializedDeferred.valueOrThrow().then(async e=>{if(e===ht.ABORTED)return;const t=this.opener();if(!(t instanceof Pd))return;if(!t||!t.pagePromise||this.type()!=="page")return!0;const i=await t.pagePromise;if(!i.listenerCount("popup"))return!0;const a=await this.page();return i.emit("popup",a),!0}).catch(B),this._checkIfInitialized()}async page(){if(!this.pagePromise){const e=this._session();this.pagePromise=(e?Promise.resolve(e):this._sessionFactory()(!1)).then(t=>ya._create(t,this,n(this,tc)??null))}return await this.pagePromise??null}_checkIfInitialized(){this._initializedDeferred.resolved()||this._getTargetInfo().url!==""&&this._initializedDeferred.resolve(ht.SUCCESS)}};tc=new WeakMap;let al=Pd;class aw extends al{}var $n;class ow extends Il{constructor(){super(...arguments);d(this,$n)}async worker(){if(!n(this,$n)){const e=this._session();p(this,$n,(e?Promise.resolve(e):this._sessionFactory()(!1)).then(t=>new fp(t,this._getTargetInfo().url,this._targetId,this.type(),()=>{},()=>{})))}return await n(this,$n)}}$n=new WeakMap;class cw extends Il{}/**
 * @license
 * Copyright 2022 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */function lw(s,r){return!!s._subtype()&&!r.subtype}var Te,Yr,Ce,is,rc,Zr,ss,ns,ei,ic,as,sc,Wn,Sl,Xe,Ju,Xu,nc,ac,oc,cc,kl,vs,El;class uw extends pe{constructor(e,t,i,a=!0){super();d(this,Xe);d(this,Te);d(this,Yr,new Map);d(this,Ce,new Map);d(this,is,new Map);d(this,rc,new Set);d(this,Zr);d(this,ss);d(this,ns,new WeakMap);d(this,ei,new WeakMap);d(this,ic,ue.create());d(this,as,new Set);d(this,sc,!0);d(this,Wn,[{}]);d(this,Sl,()=>{if(n(this,sc))for(const[e,t]of n(this,Yr).entries()){const i=new Il(t,void 0,void 0,this,void 0),a=t.type==="page"||t.type==="iframe",o=t.url.startsWith("chrome-extension://");(!n(this,Zr)||n(this,Zr).call(this,i))&&a&&!o&&n(this,as).add(e)}});d(this,nc,e=>{b(this,Xe,Xu).call(this,e)});d(this,ac,async e=>{if(n(this,Yr).set(e.targetInfo.targetId,e.targetInfo),this.emit("targetDiscovered",e.targetInfo),e.targetInfo.type==="browser"&&e.targetInfo.attached){if(n(this,Ce).has(e.targetInfo.targetId))return;const t=n(this,ss).call(this,e.targetInfo,void 0);t._initialize(),n(this,Ce).set(e.targetInfo.targetId,t)}});d(this,oc,e=>{const t=n(this,Yr).get(e.targetId);if(n(this,Yr).delete(e.targetId),b(this,Xe,vs).call(this,e.targetId),(t==null?void 0:t.type)==="service_worker"&&n(this,Ce).has(e.targetId)){const i=n(this,Ce).get(e.targetId);i&&(this.emit("targetGone",i),n(this,Ce).delete(e.targetId))}});d(this,cc,e=>{var o;if(n(this,Yr).set(e.targetInfo.targetId,e.targetInfo),n(this,rc).has(e.targetInfo.targetId)||!n(this,Ce).has(e.targetInfo.targetId)||!e.targetInfo.attached)return;const t=n(this,Ce).get(e.targetInfo.targetId);if(!t)return;const i=t.url(),a=t._initializedDeferred.value()===ht.SUCCESS;if(lw(t,e.targetInfo)){const c=t==null?void 0:t._session();x(c,"Target that is being activated is missing a CDPSession."),(o=c.parentSession())==null||o.emit(fe.Swapped,c)}t._targetInfoChanged(e.targetInfo),a&&i!==t.url()&&this.emit("targetChanged",{target:t,wasInitialized:a,previousURL:i})});d(this,kl,async(e,t)=>{const i=t.targetInfo,a=n(this,Te)._session(t.sessionId);if(!a)throw new Error(`Session ${t.sessionId} was not created.`);const o=async()=>{await a.send("Runtime.runIfWaitingForDebugger").catch(B),await e.send("Target.detachFromTarget",{sessionId:a.id()}).catch(B)};if(!n(this,Te).isAutoAttached(i.targetId))return;if(i.type==="service_worker"){if(b(this,Xe,vs).call(this,i.targetId),await o(),n(this,Ce).has(i.targetId))return;const f=n(this,ss).call(this,i);f._initialize(),n(this,Ce).set(i.targetId,f),this.emit("targetAvailable",f);return}const c=n(this,Ce).has(i.targetId),l=c?n(this,Ce).get(i.targetId):n(this,ss).call(this,i,a,e instanceof la?e:void 0);if(n(this,Zr)&&!n(this,Zr).call(this,l)){n(this,rc).add(i.targetId),b(this,Xe,vs).call(this,i.targetId),await o();return}b(this,Xe,Ju).call(this,a),c?(a.setTarget(l),n(this,is).set(a.id(),n(this,Ce).get(i.targetId))):(l._initialize(),n(this,Ce).set(i.targetId,l),n(this,is).set(a.id(),l));const u=e instanceof Yl?e.target():null;u==null||u._addChildTarget(l),e.emit(fe.Ready,a),n(this,as).delete(l._targetId),c||this.emit("targetAvailable",l),b(this,Xe,vs).call(this),await Promise.all([a.send("Target.setAutoAttach",{waitForDebuggerOnStart:!0,flatten:!0,autoAttach:!0,filter:n(this,Wn)}),a.send("Runtime.runIfWaitingForDebugger")]).catch(B)});d(this,El,(e,t)=>{const i=n(this,is).get(t.sessionId);n(this,is).delete(t.sessionId),i&&(e instanceof Yl&&e.target()._removeChildTarget(i),n(this,Ce).delete(i._targetId),this.emit("targetGone",i))});p(this,Te,e),p(this,Zr,i),p(this,ss,t),p(this,sc,a),n(this,Te).on("Target.targetCreated",n(this,ac)),n(this,Te).on("Target.targetDestroyed",n(this,oc)),n(this,Te).on("Target.targetInfoChanged",n(this,cc)),n(this,Te).on(fe.SessionDetached,n(this,nc)),b(this,Xe,Ju).call(this,n(this,Te))}async initialize(){await n(this,Te).send("Target.setDiscoverTargets",{discover:!0,filter:n(this,Wn)}),n(this,Sl).call(this),await n(this,Te).send("Target.setAutoAttach",{waitForDebuggerOnStart:!0,flatten:!0,autoAttach:!0,filter:[{type:"page",exclude:!0},...n(this,Wn)]}),b(this,Xe,vs).call(this),await n(this,ic).valueOrThrow()}getChildTargets(e){return e._childTargets()}dispose(){n(this,Te).off("Target.targetCreated",n(this,ac)),n(this,Te).off("Target.targetDestroyed",n(this,oc)),n(this,Te).off("Target.targetInfoChanged",n(this,cc)),n(this,Te).off(fe.SessionDetached,n(this,nc)),b(this,Xe,Xu).call(this,n(this,Te))}getAvailableTargets(){return n(this,Ce)}}Te=new WeakMap,Yr=new WeakMap,Ce=new WeakMap,is=new WeakMap,rc=new WeakMap,Zr=new WeakMap,ss=new WeakMap,ns=new WeakMap,ei=new WeakMap,ic=new WeakMap,as=new WeakMap,sc=new WeakMap,Wn=new WeakMap,Sl=new WeakMap,Xe=new WeakSet,Ju=function(e){const t=a=>{n(this,kl).call(this,e,a)};x(!n(this,ns).has(e)),n(this,ns).set(e,t),e.on("Target.attachedToTarget",t);const i=a=>n(this,El).call(this,e,a);x(!n(this,ei).has(e)),n(this,ei).set(e,i),e.on("Target.detachedFromTarget",i)},Xu=function(e){const t=n(this,ns).get(e);t&&(e.off("Target.attachedToTarget",t),n(this,ns).delete(e)),n(this,ei).has(e)&&(e.off("Target.detachedFromTarget",n(this,ei).get(e)),n(this,ei).delete(e))},nc=new WeakMap,ac=new WeakMap,oc=new WeakMap,cc=new WeakMap,kl=new WeakMap,vs=function(e){e!==void 0&&n(this,as).delete(e),n(this,as).size===0&&n(this,ic).resolve()},El=new WeakMap;/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */var Bn,lc,Pe,uc,dc,jn,hr,fr,ve,hc,ms,Cp,Tl,fc,pc,mc,gc,Yu;const _d=class _d extends pg{constructor(e,t,i,a,o,c,l,u=!0){super();d(this,ms);F(this,"protocol","cdp");d(this,Bn);d(this,lc);d(this,Pe);d(this,uc);d(this,dc);d(this,jn);d(this,hr);d(this,fr,new Map);d(this,ve);d(this,hc,()=>{this.emit("disconnected",void 0)});d(this,Tl,(e,t)=>{var l;const{browserContextId:i}=e,a=i&&n(this,fr).has(i)?n(this,fr).get(i):n(this,hr);if(!a)throw new Error("Missing browser context");const o=u=>n(this,Pe)._createSession(e,u),c=new cw(e,t,a,n(this,ve),o);return(l=e.url)!=null&&l.startsWith("devtools://")?new aw(e,t,a,n(this,ve),o,n(this,Bn)??null):n(this,jn).call(this,c)?new al(e,t,a,n(this,ve),o,n(this,Bn)??null):e.type==="service_worker"||e.type==="shared_worker"?new ow(e,t,a,n(this,ve),o):c});d(this,fc,async e=>{e._isTargetExposed()&&await e._initializedDeferred.valueOrThrow()===ht.SUCCESS&&(this.emit("targetcreated",e),e.browserContext().emit("targetcreated",e))});d(this,pc,async e=>{e._initializedDeferred.resolve(ht.ABORTED),e._isClosedDeferred.resolve(),e._isTargetExposed()&&await e._initializedDeferred.valueOrThrow()===ht.SUCCESS&&(this.emit("targetdestroyed",e),e.browserContext().emit("targetdestroyed",e))});d(this,mc,({target:e})=>{this.emit("targetchanged",e),e.browserContext().emit("targetchanged",e)});d(this,gc,e=>{this.emit("targetdiscovered",e)});p(this,Bn,i),p(this,lc,a),p(this,Pe,e),p(this,uc,o||(()=>{})),p(this,dc,c||(()=>!0)),b(this,ms,Cp).call(this,l),p(this,ve,new uw(e,n(this,Tl),n(this,dc),u)),p(this,hr,new Ul(n(this,Pe),this));for(const f of t)n(this,fr).set(f,new Ul(n(this,Pe),this,f))}static async _create(e,t,i,a,o,c,l,u,f,w=!0){const h=new _d(e,t,a,c,l,u,f,w);return i&&await e.send("Security.setIgnoreCertificateErrors",{ignore:!0}),await h._attach(o),h}async _attach(e){n(this,Pe).on(fe.Disconnected,n(this,hc)),e&&await n(this,hr).setDownloadBehavior(e),n(this,ve).on("targetAvailable",n(this,fc)),n(this,ve).on("targetGone",n(this,pc)),n(this,ve).on("targetChanged",n(this,mc)),n(this,ve).on("targetDiscovered",n(this,gc)),await n(this,ve).initialize()}_detach(){n(this,Pe).off(fe.Disconnected,n(this,hc)),n(this,ve).off("targetAvailable",n(this,fc)),n(this,ve).off("targetGone",n(this,pc)),n(this,ve).off("targetChanged",n(this,mc)),n(this,ve).off("targetDiscovered",n(this,gc))}process(){return n(this,lc)??null}_targetManager(){return n(this,ve)}_getIsPageTargetCallback(){return n(this,jn)}async createBrowserContext(e={}){const{proxyServer:t,proxyBypassList:i,downloadBehavior:a}=e,{browserContextId:o}=await n(this,Pe).send("Target.createBrowserContext",{proxyServer:t,proxyBypassList:i&&i.join(",")}),c=new Ul(n(this,Pe),this,o);return a&&await c.setDownloadBehavior(a),n(this,fr).set(o,c),c}browserContexts(){return[n(this,hr),...Array.from(n(this,fr).values())]}defaultBrowserContext(){return n(this,hr)}async _disposeContext(e){e&&(await n(this,Pe).send("Target.disposeBrowserContext",{browserContextId:e}),n(this,fr).delete(e))}wsEndpoint(){return n(this,Pe).url()}async newPage(){return await n(this,hr).newPage()}async _createPageInContext(e){const{targetId:t}=await n(this,Pe).send("Target.createTarget",{url:"about:blank",browserContextId:e||void 0}),i=await this.waitForTarget(c=>c._targetId===t);if(!i)throw new Error(`Missing target for page (id = ${t})`);if(!(await i._initializedDeferred.valueOrThrow()===ht.SUCCESS))throw new Error(`Failed to create target for page (id = ${t})`);const o=await i.page();if(!o)throw new Error(`Failed to create a page for context (id = ${e})`);return o}targets(){return Array.from(n(this,ve).getAvailableTargets().values()).filter(e=>e._isTargetExposed()&&e._initializedDeferred.value()===ht.SUCCESS)}target(){const e=this.targets().find(t=>t.type()==="browser");if(!e)throw new Error("Browser target is not found");return e}async version(){return(await b(this,ms,Yu).call(this)).product}async userAgent(){return(await b(this,ms,Yu).call(this)).userAgent}async close(){await n(this,uc).call(null),await this.disconnect()}disconnect(){return n(this,ve).dispose(),n(this,Pe).dispose(),this._detach(),Promise.resolve()}get connected(){return!n(this,Pe)._closed}get debugInfo(){return{pendingProtocolErrors:n(this,Pe).getPendingProtocolErrors()}}};Bn=new WeakMap,lc=new WeakMap,Pe=new WeakMap,uc=new WeakMap,dc=new WeakMap,jn=new WeakMap,hr=new WeakMap,fr=new WeakMap,ve=new WeakMap,hc=new WeakMap,ms=new WeakSet,Cp=function(e){p(this,jn,e||(t=>t.type()==="page"||t.type()==="background_page"||t.type()==="webview"))},Tl=new WeakMap,fc=new WeakMap,pc=new WeakMap,mc=new WeakMap,gc=new WeakMap,Yu=function(){return n(this,Pe).send("Browser.getVersion")};let Qu=_d;/**
 * @license
 * Copyright 2020 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */async function dw(s,r,e){const{acceptInsecureCerts:t=!1,defaultViewport:i=Jh,downloadBehavior:a,targetFilter:o,_isPageTarget:c,slowMo:l=0,protocolTimeout:u}=e,f=new vf(r,s,l,u),{browserContextIds:w}=await f.send("Target.getBrowserContexts");return await Qu._create(f,w,t,i,a,void 0,()=>f.send("Browser.close").catch(B),o,c)}const rh={targetId:"tabTargetId",type:"tab",title:"tab",url:"about:blank",attached:!1,canAccessOpener:!1},ih={targetId:"pageTargetId",type:"page",title:"page",url:"about:blank",attached:!1,canAccessOpener:!1};var os,yc,qe,Ze;const Md=class Md{constructor(r){d(this,qe);F(this,"onmessage");F(this,"onclose");d(this,os);d(this,yc,(r,e,t)=>{r.tabId===n(this,os)&&b(this,qe,Ze).call(this,{sessionId:r.sessionId??"pageTargetSessionId",method:e,params:t})});p(this,os,r),chrome.debugger.onEvent.addListener(n(this,yc))}static async connectTab(r){return await chrome.debugger.attach({tabId:r},"1.3"),new Md(r)}send(r){const e=JSON.parse(r);switch(e.method){case"Browser.getVersion":{b(this,qe,Ze).call(this,{id:e.id,sessionId:e.sessionId,method:e.method,result:{protocolVersion:"1.3",product:"chrome",revision:"unknown",userAgent:"chrome",jsVersion:"unknown"}});return}case"Target.getBrowserContexts":{b(this,qe,Ze).call(this,{id:e.id,sessionId:e.sessionId,method:e.method,result:{browserContextIds:[]}});return}case"Target.setDiscoverTargets":{b(this,qe,Ze).call(this,{method:"Target.targetCreated",params:{targetInfo:rh}}),b(this,qe,Ze).call(this,{method:"Target.targetCreated",params:{targetInfo:ih}}),b(this,qe,Ze).call(this,{id:e.id,sessionId:e.sessionId,method:e.method,result:{}});return}case"Target.setAutoAttach":if(e.sessionId==="tabTargetSessionId"){b(this,qe,Ze).call(this,{method:"Target.attachedToTarget",params:{targetInfo:ih,sessionId:"pageTargetSessionId"}}),b(this,qe,Ze).call(this,{id:e.id,sessionId:e.sessionId,method:e.method,result:{}});return}else if(!e.sessionId){b(this,qe,Ze).call(this,{method:"Target.attachedToTarget",params:{targetInfo:rh,sessionId:"tabTargetSessionId"}}),b(this,qe,Ze).call(this,{id:e.id,sessionId:e.sessionId,method:e.method,result:{}});return}}e.sessionId==="pageTargetSessionId"&&delete e.sessionId,chrome.debugger.sendCommand({tabId:n(this,os),sessionId:e.sessionId},e.method,e.params).then(t=>{b(this,qe,Ze).call(this,{id:e.id,sessionId:e.sessionId??"pageTargetSessionId",method:e.method,result:t})}).catch(t=>{b(this,qe,Ze).call(this,{id:e.id,sessionId:e.sessionId??"pageTargetSessionId",method:e.method,error:{code:t==null?void 0:t.code,data:t==null?void 0:t.data,message:(t==null?void 0:t.message)??"CDP error had no message"}})})}close(){chrome.debugger.onEvent.removeListener(n(this,yc)),chrome.debugger.detach({tabId:n(this,os)})}};os=new WeakMap,yc=new WeakMap,qe=new WeakSet,Ze=function(r){var e;(e=this.onmessage)==null||e.call(this,JSON.stringify(r))};let Zu=Md;/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const hw=[{name:"Blackberry PlayBook",userAgent:"Mozilla/5.0 (PlayBook; U; RIM Tablet OS 2.1.0; en-US) AppleWebKit/536.2+ (KHTML like Gecko) Version/7.2.1.0 Safari/536.2+",viewport:{width:600,height:1024,deviceScaleFactor:1,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Blackberry PlayBook landscape",userAgent:"Mozilla/5.0 (PlayBook; U; RIM Tablet OS 2.1.0; en-US) AppleWebKit/536.2+ (KHTML like Gecko) Version/7.2.1.0 Safari/536.2+",viewport:{width:1024,height:600,deviceScaleFactor:1,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"BlackBerry Z30",userAgent:"Mozilla/5.0 (BB10; Touch) AppleWebKit/537.10+ (KHTML, like Gecko) Version/10.0.9.2372 Mobile Safari/537.10+",viewport:{width:360,height:640,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"BlackBerry Z30 landscape",userAgent:"Mozilla/5.0 (BB10; Touch) AppleWebKit/537.10+ (KHTML, like Gecko) Version/10.0.9.2372 Mobile Safari/537.10+",viewport:{width:640,height:360,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Galaxy Note 3",userAgent:"Mozilla/5.0 (Linux; U; Android 4.3; en-us; SM-N900T Build/JSS15J) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",viewport:{width:360,height:640,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Galaxy Note 3 landscape",userAgent:"Mozilla/5.0 (Linux; U; Android 4.3; en-us; SM-N900T Build/JSS15J) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",viewport:{width:640,height:360,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Galaxy Note II",userAgent:"Mozilla/5.0 (Linux; U; Android 4.1; en-us; GT-N7100 Build/JRO03C) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",viewport:{width:360,height:640,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Galaxy Note II landscape",userAgent:"Mozilla/5.0 (Linux; U; Android 4.1; en-us; GT-N7100 Build/JRO03C) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",viewport:{width:640,height:360,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Galaxy S III",userAgent:"Mozilla/5.0 (Linux; U; Android 4.0; en-us; GT-I9300 Build/IMM76D) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",viewport:{width:360,height:640,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Galaxy S III landscape",userAgent:"Mozilla/5.0 (Linux; U; Android 4.0; en-us; GT-I9300 Build/IMM76D) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30",viewport:{width:640,height:360,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Galaxy S5",userAgent:"Mozilla/5.0 (Linux; Android 5.0; SM-G900P Build/LRX21T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:360,height:640,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Galaxy S5 landscape",userAgent:"Mozilla/5.0 (Linux; Android 5.0; SM-G900P Build/LRX21T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:640,height:360,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Galaxy S8",userAgent:"Mozilla/5.0 (Linux; Android 7.0; SM-G950U Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.84 Mobile Safari/537.36",viewport:{width:360,height:740,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Galaxy S8 landscape",userAgent:"Mozilla/5.0 (Linux; Android 7.0; SM-G950U Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.84 Mobile Safari/537.36",viewport:{width:740,height:360,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Galaxy S9+",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; SM-G965U Build/R16NW) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.111 Mobile Safari/537.36",viewport:{width:320,height:658,deviceScaleFactor:4.5,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Galaxy S9+ landscape",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; SM-G965U Build/R16NW) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.111 Mobile Safari/537.36",viewport:{width:658,height:320,deviceScaleFactor:4.5,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Galaxy Tab S4",userAgent:"Mozilla/5.0 (Linux; Android 8.1.0; SM-T837A) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.80 Safari/537.36",viewport:{width:712,height:1138,deviceScaleFactor:2.25,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Galaxy Tab S4 landscape",userAgent:"Mozilla/5.0 (Linux; Android 8.1.0; SM-T837A) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.80 Safari/537.36",viewport:{width:1138,height:712,deviceScaleFactor:2.25,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPad",userAgent:"Mozilla/5.0 (iPad; CPU OS 11_0 like Mac OS X) AppleWebKit/604.1.34 (KHTML, like Gecko) Version/11.0 Mobile/15A5341f Safari/604.1",viewport:{width:768,height:1024,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPad landscape",userAgent:"Mozilla/5.0 (iPad; CPU OS 11_0 like Mac OS X) AppleWebKit/604.1.34 (KHTML, like Gecko) Version/11.0 Mobile/15A5341f Safari/604.1",viewport:{width:1024,height:768,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPad (gen 6)",userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:768,height:1024,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPad (gen 6) landscape",userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:1024,height:768,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPad (gen 7)",userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:810,height:1080,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPad (gen 7) landscape",userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:1080,height:810,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPad Mini",userAgent:"Mozilla/5.0 (iPad; CPU OS 11_0 like Mac OS X) AppleWebKit/604.1.34 (KHTML, like Gecko) Version/11.0 Mobile/15A5341f Safari/604.1",viewport:{width:768,height:1024,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPad Mini landscape",userAgent:"Mozilla/5.0 (iPad; CPU OS 11_0 like Mac OS X) AppleWebKit/604.1.34 (KHTML, like Gecko) Version/11.0 Mobile/15A5341f Safari/604.1",viewport:{width:1024,height:768,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPad Pro",userAgent:"Mozilla/5.0 (iPad; CPU OS 11_0 like Mac OS X) AppleWebKit/604.1.34 (KHTML, like Gecko) Version/11.0 Mobile/15A5341f Safari/604.1",viewport:{width:1024,height:1366,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPad Pro landscape",userAgent:"Mozilla/5.0 (iPad; CPU OS 11_0 like Mac OS X) AppleWebKit/604.1.34 (KHTML, like Gecko) Version/11.0 Mobile/15A5341f Safari/604.1",viewport:{width:1366,height:1024,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPad Pro 11",userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:834,height:1194,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPad Pro 11 landscape",userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:1194,height:834,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 4",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 7_1_2 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) Version/7.0 Mobile/11D257 Safari/9537.53",viewport:{width:320,height:480,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 4 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 7_1_2 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) Version/7.0 Mobile/11D257 Safari/9537.53",viewport:{width:480,height:320,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 5",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/10.0 Mobile/14E304 Safari/602.1",viewport:{width:320,height:568,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 5 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/10.0 Mobile/14E304 Safari/602.1",viewport:{width:568,height:320,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 6",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:375,height:667,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 6 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:667,height:375,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 6 Plus",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:414,height:736,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 6 Plus landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:736,height:414,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 7",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:375,height:667,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 7 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:667,height:375,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 7 Plus",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:414,height:736,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 7 Plus landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:736,height:414,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 8",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:375,height:667,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 8 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:667,height:375,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 8 Plus",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:414,height:736,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 8 Plus landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:736,height:414,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone SE",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/10.0 Mobile/14E304 Safari/602.1",viewport:{width:320,height:568,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone SE landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/10.0 Mobile/14E304 Safari/602.1",viewport:{width:568,height:320,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone X",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:375,height:812,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone X landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",viewport:{width:812,height:375,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone XR",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0 Mobile/15E148 Safari/604.1",viewport:{width:414,height:896,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone XR landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0 Mobile/15E148 Safari/604.1",viewport:{width:896,height:414,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 11",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_7 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Mobile/15E148 Safari/604.1",viewport:{width:414,height:828,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 11 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_7 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Mobile/15E148 Safari/604.1",viewport:{width:828,height:414,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 11 Pro",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_7 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Mobile/15E148 Safari/604.1",viewport:{width:375,height:812,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 11 Pro landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_7 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Mobile/15E148 Safari/604.1",viewport:{width:812,height:375,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 11 Pro Max",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_7 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Mobile/15E148 Safari/604.1",viewport:{width:414,height:896,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 11 Pro Max landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_7 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1 Mobile/15E148 Safari/604.1",viewport:{width:896,height:414,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 12",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:390,height:844,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 12 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:844,height:390,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 12 Pro",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:390,height:844,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 12 Pro landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:844,height:390,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 12 Pro Max",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:428,height:926,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 12 Pro Max landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:926,height:428,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 12 Mini",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:375,height:812,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 12 Mini landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:812,height:375,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 13",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:390,height:844,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 13 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:844,height:390,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 13 Pro",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:390,height:844,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 13 Pro landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:844,height:390,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 13 Pro Max",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:428,height:926,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 13 Pro Max landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:926,height:428,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 13 Mini",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:375,height:812,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 13 Mini landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:812,height:375,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 14",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:390,height:663,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 14 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:750,height:340,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 14 Plus",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:428,height:745,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 14 Plus landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:832,height:378,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 14 Pro",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:393,height:659,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 14 Pro landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:734,height:343,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 14 Pro Max",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:430,height:739,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 14 Pro Max landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Mobile/15E148 Safari/604.1",viewport:{width:814,height:380,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 15",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:393,height:659,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 15 landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:734,height:343,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 15 Plus",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:430,height:739,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 15 Plus landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:814,height:380,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 15 Pro",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:393,height:659,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 15 Pro landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:734,height:343,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"iPhone 15 Pro Max",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:430,height:739,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"iPhone 15 Pro Max landscape",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 17_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.5 Mobile/15E148 Safari/604.1",viewport:{width:814,height:380,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"JioPhone 2",userAgent:"Mozilla/5.0 (Mobile; LYF/F300B/LYF-F300B-001-01-15-130718-i;Android; rv:48.0) Gecko/48.0 Firefox/48.0 KAIOS/2.5",viewport:{width:240,height:320,deviceScaleFactor:1,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"JioPhone 2 landscape",userAgent:"Mozilla/5.0 (Mobile; LYF/F300B/LYF-F300B-001-01-15-130718-i;Android; rv:48.0) Gecko/48.0 Firefox/48.0 KAIOS/2.5",viewport:{width:320,height:240,deviceScaleFactor:1,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Kindle Fire HDX",userAgent:"Mozilla/5.0 (Linux; U; en-us; KFAPWI Build/JDQ39) AppleWebKit/535.19 (KHTML, like Gecko) Silk/3.13 Safari/535.19 Silk-Accelerated=true",viewport:{width:800,height:1280,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Kindle Fire HDX landscape",userAgent:"Mozilla/5.0 (Linux; U; en-us; KFAPWI Build/JDQ39) AppleWebKit/535.19 (KHTML, like Gecko) Silk/3.13 Safari/535.19 Silk-Accelerated=true",viewport:{width:1280,height:800,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"LG Optimus L70",userAgent:"Mozilla/5.0 (Linux; U; Android 4.4.2; en-us; LGMS323 Build/KOT49I.MS32310c) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:384,height:640,deviceScaleFactor:1.25,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"LG Optimus L70 landscape",userAgent:"Mozilla/5.0 (Linux; U; Android 4.4.2; en-us; LGMS323 Build/KOT49I.MS32310c) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:640,height:384,deviceScaleFactor:1.25,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Microsoft Lumia 550",userAgent:"Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; Lumia 550) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Mobile Safari/537.36 Edge/14.14263",viewport:{width:640,height:360,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Microsoft Lumia 950",userAgent:"Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; Lumia 950) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Mobile Safari/537.36 Edge/14.14263",viewport:{width:360,height:640,deviceScaleFactor:4,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Microsoft Lumia 950 landscape",userAgent:"Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; Lumia 950) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Mobile Safari/537.36 Edge/14.14263",viewport:{width:640,height:360,deviceScaleFactor:4,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nexus 10",userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 10 Build/MOB31T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Safari/537.36",viewport:{width:800,height:1280,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nexus 10 landscape",userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 10 Build/MOB31T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Safari/537.36",viewport:{width:1280,height:800,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nexus 4",userAgent:"Mozilla/5.0 (Linux; Android 4.4.2; Nexus 4 Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:384,height:640,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nexus 4 landscape",userAgent:"Mozilla/5.0 (Linux; Android 4.4.2; Nexus 4 Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:640,height:384,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nexus 5",userAgent:"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:360,height:640,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nexus 5 landscape",userAgent:"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:640,height:360,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nexus 5X",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 5X Build/OPR4.170623.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:412,height:732,deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nexus 5X landscape",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 5X Build/OPR4.170623.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:732,height:412,deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nexus 6",userAgent:"Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F26U) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:412,height:732,deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nexus 6 landscape",userAgent:"Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F26U) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:732,height:412,deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nexus 6P",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 6P Build/OPP3.170518.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:412,height:732,deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nexus 6P landscape",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 6P Build/OPP3.170518.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:732,height:412,deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nexus 7",userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 7 Build/MOB30X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Safari/537.36",viewport:{width:600,height:960,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nexus 7 landscape",userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 7 Build/MOB30X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Safari/537.36",viewport:{width:960,height:600,deviceScaleFactor:2,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nokia Lumia 520",userAgent:"Mozilla/5.0 (compatible; MSIE 10.0; Windows Phone 8.0; Trident/6.0; IEMobile/10.0; ARM; Touch; NOKIA; Lumia 520)",viewport:{width:320,height:533,deviceScaleFactor:1.5,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nokia Lumia 520 landscape",userAgent:"Mozilla/5.0 (compatible; MSIE 10.0; Windows Phone 8.0; Trident/6.0; IEMobile/10.0; ARM; Touch; NOKIA; Lumia 520)",viewport:{width:533,height:320,deviceScaleFactor:1.5,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Nokia N9",userAgent:"Mozilla/5.0 (MeeGo; NokiaN9) AppleWebKit/534.13 (KHTML, like Gecko) NokiaBrowser/8.5.0 Mobile Safari/534.13",viewport:{width:480,height:854,deviceScaleFactor:1,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Nokia N9 landscape",userAgent:"Mozilla/5.0 (MeeGo; NokiaN9) AppleWebKit/534.13 (KHTML, like Gecko) NokiaBrowser/8.5.0 Mobile Safari/534.13",viewport:{width:854,height:480,deviceScaleFactor:1,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Pixel 2",userAgent:"Mozilla/5.0 (Linux; Android 8.0; Pixel 2 Build/OPD3.170816.012) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:411,height:731,deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Pixel 2 landscape",userAgent:"Mozilla/5.0 (Linux; Android 8.0; Pixel 2 Build/OPD3.170816.012) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:731,height:411,deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Pixel 2 XL",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Pixel 2 XL Build/OPD1.170816.004) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:411,height:823,deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Pixel 2 XL landscape",userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Pixel 2 XL Build/OPD1.170816.004) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3765.0 Mobile Safari/537.36",viewport:{width:823,height:411,deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Pixel 3",userAgent:"Mozilla/5.0 (Linux; Android 9; Pixel 3 Build/PQ1A.181105.017.A1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.158 Mobile Safari/537.36",viewport:{width:393,height:786,deviceScaleFactor:2.75,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Pixel 3 landscape",userAgent:"Mozilla/5.0 (Linux; Android 9; Pixel 3 Build/PQ1A.181105.017.A1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.158 Mobile Safari/537.36",viewport:{width:786,height:393,deviceScaleFactor:2.75,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Pixel 4",userAgent:"Mozilla/5.0 (Linux; Android 10; Pixel 4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Mobile Safari/537.36",viewport:{width:353,height:745,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Pixel 4 landscape",userAgent:"Mozilla/5.0 (Linux; Android 10; Pixel 4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Mobile Safari/537.36",viewport:{width:745,height:353,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Pixel 4a (5G)",userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 4a (5G)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4812.0 Mobile Safari/537.36",viewport:{width:353,height:745,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Pixel 4a (5G) landscape",userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 4a (5G)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4812.0 Mobile Safari/537.36",viewport:{width:745,height:353,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Pixel 5",userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4812.0 Mobile Safari/537.36",viewport:{width:393,height:851,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Pixel 5 landscape",userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4812.0 Mobile Safari/537.36",viewport:{width:851,height:393,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}},{name:"Moto G4",userAgent:"Mozilla/5.0 (Linux; Android 7.0; Moto G (4)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4812.0 Mobile Safari/537.36",viewport:{width:360,height:640,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!1}},{name:"Moto G4 landscape",userAgent:"Mozilla/5.0 (Linux; Android 7.0; Moto G (4)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4812.0 Mobile Safari/537.36",viewport:{width:640,height:360,deviceScaleFactor:3,isMobile:!0,hasTouch:!0,isLandscape:!0}}],Pp={};for(const s of hw)Pp[s.name]=s;Object.freeze(Pp);async function fw(s,r,e){const{acceptInsecureCerts:t=!1,defaultViewport:i=Jh}=e,{bidiConnection:a,cdpConnection:o,closeCallback:c}=await pw(s,r,e);return await(await pa(()=>import("./chunks/bidi-CW5FCHXd.js"),__vite__mapDeps([0,1,2,3]))).BidiBrowser.create({connection:a,cdpConnection:o,closeCallback:c,process:void 0,defaultViewport:i,acceptInsecureCerts:t,capabilities:e.capabilities})}async function pw(s,r,e){const t=await pa(()=>import("./chunks/bidi-CW5FCHXd.js"),__vite__mapDeps([0,1,2,3])),{slowMo:i=0,protocolTimeout:a}=e,o=new t.BidiConnection(r,s,i,a);try{const f=await o.send("session.status",{});if("type"in f&&f.type==="success")return{bidiConnection:o,closeCallback:async()=>{await o.send("browser.close",{}).catch(B)}}}catch(f){if(!(f instanceof Gn))throw f}o.unbind();const c=new vf(r,s,i,a,!0);if((await c.send("Browser.getVersion")).product.toLowerCase().includes("firefox"))throw new md("Firefox is not supported in BiDi over CDP mode.");const u=await t.connectBidiOverCdp(c);return{cdpConnection:c,bidiConnection:u,closeCallback:async()=>{await c.send("Browser.close").catch(B)}}}const sh=async()=>Gh?(await pa(async()=>{const{NodeWebSocketTransport:s}=await import("./chunks/NodeWebSocketTransport-DkR-FYoZ.js");return{NodeWebSocketTransport:s}},__vite__mapDeps([4,2,3,1]))).NodeWebSocketTransport:(await pa(()=>import("./chunks/BrowserWebSocketTransport-pn5h6vkO.js"),[])).BrowserWebSocketTransport;async function mw(s){const{connectionTransport:r,endpointUrl:e}=await gw(s);return s.protocol==="webDriverBiDi"?await fw(r,e,s):await dw(r,e,s)}async function gw(s){const{browserWSEndpoint:r,browserURL:e,transport:t,headers:i={}}=s;if(x(+!!r+ +!!e+ +!!t==1,"Exactly one of browserWSEndpoint, browserURL or transport must be passed to puppeteer.connect"),t)return{connectionTransport:t,endpointUrl:""};if(r)return{connectionTransport:await(await sh()).create(r,i),endpointUrl:r};if(e){const a=await yw(e);return{connectionTransport:await(await sh()).create(a),endpointUrl:a}}throw new Error("Invalid connection options")}async function yw(s){const r=new URL("/json/version",s);try{const e=await globalThis.fetch(r.toString(),{method:"GET"});if(!e.ok)throw new Error(`HTTP ${e.statusText}`);return(await e.json()).webSocketDebuggerUrl}catch(e){throw Ut(e)&&(e.message=`Failed to fetch browser webSocket URL from ${r}: `+e.message),e}}/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */class _p{constructor(r){F(this,"_isPuppeteerCore");F(this,"_changedBrowsers",!1);this._isPuppeteerCore=r.isPuppeteerCore,this.connect=this.connect.bind(this)}static registerCustomQueryHandler(r,e){return this.customQueryHandlers.register(r,e)}static unregisterCustomQueryHandler(r){return this.customQueryHandlers.unregister(r)}static customQueryHandlerNames(){return this.customQueryHandlers.names()}static clearCustomQueryHandlers(){return this.customQueryHandlers.clear()}connect(r){return mw(r)}}F(_p,"customQueryHandlers",tu);/**
 * @license
 * Copyright 2017 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */const ww=new _p({isPuppeteerCore:!0}),{connect:vw}=ww,yd={POPUP:"POPUP",BACKGROUND:"BACKGROUND"},ot={PLATFORM_SETTINGS_CHANGED:"PLATFORM_SETTINGS_CHANGED",TWITTER_FEED:"TWITTER_FEED",REDDIT_FEED:"REDDIT_FEED",EXTRACT_TWEETS_FROM_API:"EXTRACT_TWEETS_FROM_API",RUN_PUPPETEER:"RUN_PUPPETEER",CONNECT_WEBSOCKET:"CONNECT_WEBSOCKET",DISCONNECT_WEBSOCKET:"DISCONNECT_WEBSOCKET",CHECK_WEBSOCKET_STATUS:"CHECK_WEBSOCKET_STATUS",CONNECT_JOB_WEBSOCKET:"CONNECT_JOB_WEBSOCKET",DISCONNECT_JOB_WEBSOCKET:"DISCONNECT_JOB_WEBSOCKET",CHECK_JOB_WEBSOCKET_STATUS:"CHECK_JOB_WEBSOCKET_STATUS",SUBMIT_JOB_RESULT:"SUBMIT_JOB_RESULT",NEW_JOB_NOTIFICATION:"NEW_JOB_NOTIFICATION",ACTIVE_TWEETS_RESULT:"ACTIVE_TWEETS_RESULT",ACTIVE_PROFILES_RESULT:"ACTIVE_PROFILES_RESULT",REDDIT_ACTIVE_RESULT:"REDDIT_ACTIVE_RESULT",REDDIT_PROFILES_RESULT:"REDDIT_PROFILES_RESULT",GATHERING_HOURS:"GATHERING_HOURS",GET_CURRENT_TAB:"GET_CURRENT_TAB",UPDATE_BADGE_COUNT:"UPDATE_BADGE_COUNT",GET_COUNTDOWN_AND_POINTS:"GET_COUNTDOWN_AND_POINTS",GET_LATEST_POINTS:"GET_LATEST_POINTS",CHECK_WEB_APP_SESSION:"CHECK_WEB_APP_SESSION",CLEAR_LOCAL_STORAGE:"CLEAR_LOCAL_STORAGE",SYNC_GATHERED_DATA:"SYNC_GATHERED_DATA",SYNC_FULL_CONFIG:"SYNC_FULL_CONFIG"};let Hl=null;function bw(s,r,e){var h,g;const t=s.filter(S=>{var m,v;return(v=(m=S.metadata)==null?void 0:m.jobAssociations)==null?void 0:v.some(T=>T.jobId===r&&T.gatherType==="active")}),i=["-post","-tweet","-video","-comment"],a=["-profile","-user","-channel"],o=t.filter(S=>{if(!(e!=null&&e.filters))return!0;const m=e.filters,v=S.data||{},T=i.some(P=>S.configId.endsWith(P)),D=a.some(P=>S.configId.endsWith(P));return!(T&&(m.minLikes&&(v.likes??0)<m.minLikes||m.minRetweets&&(v.reposts??0)<m.minRetweets||m.minReplies&&(v.replies??0)<m.minReplies||m.minUpvotes&&(v.upvotes??0)<m.minUpvotes||m.minComments&&(v.comments??0)<m.minComments)||D&&(m.minFollowers&&(v.followerCount??0)<m.minFollowers||m.minFollowing&&(v.followingCount??0)<m.minFollowing))});o.sort((S,m)=>(m.data.timestamp?new Date(m.data.timestamp).getTime():0)-(S.data.timestamp?new Date(S.data.timestamp).getTime():0));const c=(h=e==null?void 0:e.filters)==null?void 0:h.postLimit,l=(g=e==null?void 0:e.filters)==null?void 0:g.profileLimit;let u=0,f=0;const w=[];for(const S of o){const m=i.some(T=>S.configId.endsWith(T)),v=a.some(T=>S.configId.endsWith(T));if(m&&(!c||u<c)?(w.push(S),u++):v&&(!l||f<l)&&(w.push(S),f++),c&&u>=c&&l&&f>=l)break}return w}async function Sw(s){var S;const{job_id:r,user_id:e}=s;console.log(`Finalizing and submitting result for job ${r}`);const t=await chrome.storage.local.get(["gatheredData","jobRequirements","jobNotifications"]);let i=null;const a=(S=t.jobRequirements)==null?void 0:S[r];if(a)try{i=typeof a=="string"?JSON.parse(a):a}catch(m){console.error(`Failed to parse job requirements for ${r}:`,m)}const o=(i==null?void 0:i.platform)||"x",l=(t.gatheredData||{})[o]||[],f=bw(l,r,i).map(m=>{var T,D;const v=(D=(T=m.metadata)==null?void 0:T.jobAssociations)==null?void 0:D.find(P=>P.jobId===r);return{...m,metadata:v?{jobAssociations:[v]}:void 0}}),w={job_id:r,user_id:e,result:JSON.stringify({items:f})};console.log(`Submitting final result for job ${r}:`,{itemCount:f.length});const g=(t.jobNotifications||[]).map(m=>m.job_id===r?{...m,status:"completed",resultSummary:{itemCount:f.length,submittedAt:new Date().toISOString()},result:JSON.stringify(w)}:m);await chrome.storage.local.set({jobNotifications:g}),console.warn(`Job WebSocket not open. Cannot submit result for job ${r}.`),chrome.runtime.sendMessage({target:yd.POPUP,type:"JOB_RESULT_SUBMITTED",data:{jobId:r,summary:{itemCount:f.length},isWebSocketOpen:(Hl==null?void 0:Hl.readyState)===WebSocket.OPEN}}).catch(()=>{})}chrome.storage.onChanged.addListener((s,r)=>{r==="local"&&s.gatheringHours&&s.gatheringHours.newValue});const Ve=class Ve{constructor(){F(this,"platforms",new Map);F(this,"activeBrowser",null);F(this,"activePage",null);F(this,"activeJobContext",null);F(this,"activeTabId",null);F(this,"activeJobRequirements",null);F(this,"activeScrollAttempts",0);F(this,"isActiveGatheringRunning",!1);F(this,"maxScrollAttempts",10)}initializeWindowTracking(){Ve.isListening||(chrome.windows.getAll({windowTypes:["normal"]}).then(r=>{r.forEach(e=>{e.id!==void 0&&Ve.windowRegistry.set(e.id,e)})}),chrome.windows.onCreated.addListener(r=>{r.id!==void 0&&Ve.windowRegistry.set(r.id,r)}),chrome.windows.onRemoved.addListener(r=>{Ve.windowRegistry.delete(r)}),chrome.windows.onFocusChanged.addListener(async r=>{if(r!==chrome.windows.WINDOW_ID_NONE)for(const[e,t]of Ve.windowRegistry.entries())Ve.windowRegistry.set(e,{...t,focused:e===r})}),Ve.isListening=!0)}async findOrCreateGatherWindow(){this.initializeWindowTracking();const r=Array.from(Ve.windowRegistry.values());if(r.length<=1){const i=await chrome.windows.create({focused:!0,state:"normal"});if(i.id===void 0)throw new Error("Failed to create window: ID undefined.");return await new Promise(a=>setTimeout(a,500)),i.id}const e=r.find(i=>!i.focused&&i.id!==chrome.windows.WINDOW_ID_CURRENT&&i.type==="normal"&&i.id!==void 0);if(e!=null&&e.id)return await chrome.windows.update(e.id,{focused:!0,state:"normal"}),e.id;const t=await chrome.windows.create({focused:!0,state:"normal"});if(t.id===void 0)throw new Error("Failed to create fallback window: ID undefined.");return await new Promise(i=>setTimeout(i,500)),t.id}cleanup(){console.log("[PF] Cleaning up window tracking."),Ve.windowRegistry.clear(),Ve.isListening=!1}getByPath(r,e){return String(e).split(".").reduce((i,a)=>{if(i==null)return;const o=a.match(/^\[(\d+)\]$/),c=a.match(/^(.+)\[(\d+)\]$/);if(o){const l=parseInt(o[1],10);return Array.isArray(i)?i[l]:void 0}else if(c){const l=c[1],u=parseInt(c[2],10),f=i[l];return Array.isArray(f)?f[u]:void 0}else if(a.endsWith("[]")){const l=a.slice(0,-2);return i[l]||[]}else return typeof i=="object"&&i!==null&&a in i?i[a]:void 0},r)}registerPlatform(r){this.validatePlatformDefinition(r),this.platforms.set(r.id,r),console.log(`[PF] Platform ${r.id} (v${r.version}) registered.`)}getPlatformDefinition(r){return this.platforms.get(r)}getPlatformByHostname(r){for(const[,e]of this.platforms)if(e.hostnames.some(t=>r.includes(t)))return e;return null}matchesPathPattern(r,e){const t=new URL(r).pathname;return e.paths.some(i=>{const a=i.replace(/:[a-zA-Z]+/g,"[^/]+");try{return new RegExp(`^${a}$`).test(t)}catch(o){return console.error(`[PF] Invalid regex path pattern "${i}" for ${e.id}:`,o),!1}})}async checkPlatformAvailability(r){const e=this.getPlatformDefinition(r);if(!e)return{canAcceptJobs:!1,activeGatheringAvailable:!1,passiveGatheringAvailable:!1,reason:"platform_not_found"};const t=await this.checkRecentGatheringActivity(r);return{canAcceptJobs:t,activeGatheringAvailable:e.capabilities.active&&t,passiveGatheringAvailable:e.capabilities.passive,reason:t?"ready":"authentication_required"}}async startActiveGathering(r,e){var a,o,c,l,u,f,w,h;if(this.isActiveGatheringRunning)throw new Error("[PF] Active gathering is already running");const t=this.getPlatformDefinition(r);if(!(t!=null&&t.capabilities.active))throw new Error(`[PF] Platform ${r} not found or doesn't support active gathering.`);const i=(a=t.gathering)==null?void 0:a.active;if(!i)throw new Error(`[PF] Active gathering configuration missing for ${r}`);e.platformId=r,this.isActiveGatheringRunning=!0,this.activeJobContext=e,this.activeScrollAttempts=0;try{if(e.jobId){const T=(o=(await chrome.storage.local.get(["jobRequirements"])).jobRequirements)==null?void 0:o[e.jobId];try{this.activeJobRequirements=T?typeof T=="string"?JSON.parse(T):T:null}catch(D){console.error(`[PF] Failed to parse job requirements for ${e.jobId}:`,D),this.activeJobRequirements=null}}const g=await this.findOrCreateGatherWindow(),S=await chrome.tabs.create({windowId:g,url:"about:blank",active:!0});if(!S.id)throw new Error("[PF] Failed to create tab");this.activeTabId=S.id,console.log(`[PF] Using tab ${this.activeTabId} for job ${e.jobId}`),this.activeBrowser=await vw({transport:await Zu.connectTab(S.id),defaultViewport:null});const m=await this.activeBrowser.pages();if(this.activePage=m[0],!this.activePage)throw new Error("[PF] Failed to get page object");if(this.activeJobContext.tabId=this.activeTabId,await chrome.storage.local.set({activeJobContext:this.activeJobContext}),await this.setupResourceBlocking(this.activePage),i.apiInterception&&i.apiInterception.patterns&&i.apiInterception.patterns.length>0){const v={patterns:i.apiInterception.patterns,extractors:i.apiInterception.extractors||[]};await this.setupAPIInterception(t,v,this.activePage,this.activeJobContext)}(c=e.commands)!=null&&c.length?(console.log(`[PF] Executing ${e.commands.length} commands for job ${e.jobId}`),await this.executeCommands(e.commands,this.activePage),console.log(`[PF] Finished executing commands for job ${e.jobId}`)):console.log(`[PF] No commands to execute for job ${e.jobId}`),(l=i.commands)!=null&&l.length&&(console.log(`[PF] Executing ${i.commands.length} platform commands`),await this.executeCommands(i.commands,this.activePage),console.log("[PF] Finished executing platform commands")),((f=(u=this.activeJobRequirements)==null?void 0:u.filters)!=null&&f.postLimit||(h=(w=this.activeJobRequirements)==null?void 0:w.filters)!=null&&h.profileLimit)&&await this.scrollUntilRequirementsMet(),this.isActiveGatheringRunning&&e.jobId&&(console.log(`[PF] Main process finished for job ${e.jobId}, checking submission.`),await this.shouldSubmitJobResult(e.jobId,this.activeJobRequirements,!0)&&await this.handlePostDataMerge(r,{items:[]}))}catch(g){throw console.error("[PF] Error during active gathering start:",g),await this.stopActiveGathering(),g}finally{this.isActiveGatheringRunning&&(console.log(`[PF] Active gathering finished for job ${e.jobId}. Stopping.`),await this.stopActiveGathering())}}async stopActiveGathering(){var t;if(!this.isActiveGatheringRunning&&!this.activeBrowser&&!this.activeTabId)return;const r=((t=this.activeJobContext)==null?void 0:t.jobId)??"unknown";if(console.log(`[PF] Stopping active gathering for job: ${r}`),this.isActiveGatheringRunning=!1,await chrome.storage.local.remove("activeJobContext").catch(i=>console.error("[PF] Error removing activeJobContext:",i)),this.activeBrowser){const i=this.activeBrowser;this.activeBrowser=null,this.activePage=null;try{await i.disconnect()}catch(a){a instanceof Error&&!a.message.includes("disconnected")&&console.error("[PF] Error disconnecting browser:",a)}}const e=this.activeTabId;if(e){this.activeTabId=null;try{await chrome.tabs.get(e),await chrome.tabs.remove(e)}catch(i){i instanceof Error&&!i.message.toLowerCase().includes("no tab with id")&&console.error(`[PF] Error closing tab ${e}:`,i)}}this.activeJobContext=null,this.activeJobRequirements=null,this.activeScrollAttempts=0,console.log(`[PF] Active gathering stopped and cleaned up for job: ${r}`)}async setupResourceBlocking(r){if(!r||r.isClosed()){console.warn("[PF] setupResourceBlocking: page closed.");return}try{if(!r._requestInterceptionEnabled){if(await r.setRequestInterception(!0).catch(t=>{if(!r.isClosed())throw t}),r.isClosed())return;r._requestInterceptionEnabled=!0}r.removeAllListeners("request");const e=["image","stylesheet","font","media","websocket","manifest","other"];r.on("request",async t=>{if(!r||r.isClosed()||t.isInterceptResolutionHandled())return;const i=t.resourceType(),a=t.url();try{if(a.includes("/i/api/1.1/dm")){await t.abort("blockedbyclient");return}e.includes(i)?await t.abort("blockedbyclient"):await t.continue()}catch(o){if(o instanceof Error&&!o.message.includes("Request is already handled")&&!o.message.includes("Target closed")&&(console.error(`[PF] Error handling request ${a}:`,o),!t.isInterceptResolutionHandled()))try{await t.continue()}catch{}}})}catch(e){if(console.error("[PF] Error setting up resource blocking:",e),!(e instanceof Error&&e.message.includes("Target closed")))throw e}}async setupAPIInterception(r,e,t,i){if(!(!t||t.isClosed())){try{if(!t._requestInterceptionEnabled){if(await t.setRequestInterception(!0).catch(a=>{if(!t.isClosed())throw a}),t.isClosed())return;t._requestInterceptionEnabled=!0}}catch(a){console.error("[PF] Failed to enable interception for API:",a);return}t.removeAllListeners("response"),t.on("response",async a=>{if(!t||t.isClosed())return;const o=a.url(),c=a.status(),l=e.patterns.find(u=>o.includes(u));if(c>=200&&c<300&&l){console.log(`[PF] Intercepted API response from ${o} (pattern: ${l})`);const u=e.extractors||[];try{const f=a.headers()["content-type"]||"";let w;if(f.includes("application/json"))w=await a.json(),console.log("[PF] Raw API response data:",{url:o,pattern:l,paths:Object.keys((w==null?void 0:w.data)||{}),dataPreview:JSON.stringify(w)});else if(f.includes("text/html"))w=await a.text(),console.warn("[PF] HTML API response handling needed.");else return;const h=await this.extractDataFromResponse(w,u,o,r);console.log(`[PF] Extraction result for ${o}:`,{itemsExtracted:h.items.length,stats:h.stats,types:h.items.map(g=>g.configId)}),h.items.length>0&&await this.handleGatheredData(r.id,h,i)}catch(f){f instanceof SyntaxError||console.error(`[PF] Error processing API response for ${o}:`,f)}}}),console.log(`[PF] API interception setup for ${r.id} patterns: ${e.patterns.join(", ")}`)}}async scrollUntilRequirementsMet(){var a,o,c,l,u,f,w;if(!this.activePage||!((a=this.activeJobRequirements)!=null&&a.filters)||!this.activeJobContext||!this.isActiveGatheringRunning)return;const r=this.activeJobContext.platformId,e=this.activeJobContext.jobId;if(!e){console.warn("[PF] Cannot scroll: Active job context missing jobId.");return}const t=this.activeJobRequirements.filters.postLimit,i=this.activeJobRequirements.filters.profileLimit;if(!(!t&&!i)){for(console.log(`[PF] Starting scroll job ${e} (${r}). Limits: Posts=${t??"N/A"}, Profiles=${i??"N/A"}`);this.activeScrollAttempts<this.maxScrollAttempts&&this.isActiveGatheringRunning;){const{relevantItems:h}=await this.getFilteredJobData(r,e,this.activeJobRequirements);let g=0,S=0;const m=this.getPlatformDefinition(r),v=((l=(c=(o=m==null?void 0:m.gathering)==null?void 0:o.passive)==null?void 0:c.itemExtractionConfig)==null?void 0:l.filter(M=>M.id.includes("post")||M.id.includes("tweet")||M.id.includes("video")).map(M=>M.id))??[],T=((w=(f=(u=m==null?void 0:m.gathering)==null?void 0:u.passive)==null?void 0:f.itemExtractionConfig)==null?void 0:w.filter(M=>M.id.includes("profile")||M.id.includes("user")||M.id.includes("channel")).map(M=>M.id))??[];h.forEach(M=>{v.includes(M.configId)&&g++,T.includes(M.configId)&&S++});const D=!t||g>=t,P=!i||S>=i;if(console.log(`[PF] Scroll Check (Job ${e}, Attempt ${this.activeScrollAttempts+1}): Posts: ${g}/${t??"N/A"} (Met: ${D}), Profiles: ${S}/${i??"N/A"} (Met: ${P})`),D&&P){console.log(`[PF] Scroll limits met for job ${e}.`);break}try{if(!this.activePage||this.activePage.isClosed()){console.warn("[PF] Page closed during scroll.");break}await this.activePage.evaluate(()=>window.scrollTo(0,document.body.scrollHeight)),await this.waitForTimeout(3e3)}catch(M){if(M instanceof Error&&(M.message.includes("Target closed")||M.message.includes("disconnected"))){console.warn("[PF] Target closed during scroll."),this.isActiveGatheringRunning=!1;break}else console.error("[PF] Error during scroll/wait:",M)}this.activeScrollAttempts++,await this.waitForTimeout(500)}this.activeScrollAttempts>=this.maxScrollAttempts&&console.log(`[PF] Max scroll attempts (${this.maxScrollAttempts}) for job ${e}`)}}async extractDataFromResponse(r,e,t,i){var l,u,f,w,h,g,S;const a=[],o={posts:0,comments:0,profiles:0};console.log(`[PF] Starting data extraction for ${t} with ${e.length} extractors`);const c=async(m,v)=>{try{const T=v.idPath?this.getByPath(m,v.idPath):void 0,D=v.urlPath?this.getByPath(m,v.urlPath):void 0;if(m==null){console.warn(`[PF] Skipping null or undefined item for extractor ${v.id}`);return}console.log("[PF] Processing item:",{extractorId:v.id,extractorType:v.type,itemId:T,itemUrl:D,itemPreview:JSON.stringify(m).slice(0,100)+"..."});const P=this.mapDataWithConfig(m,v.dataMapping);if(!P.id&&!T){console.warn(`[PF] Skipping item due to missing ID after mapping for extractor ${v.id}`,{itemPreview:JSON.stringify(m).slice(0,100)+"..."});return}console.log("[PF] Mapped data:",{extractorId:v.id,mappedFields:Object.keys(P),preview:JSON.stringify(P).slice(0,200)+"..."});const M={id:P.id||T||`${v.id}-${Date.now()}`,configId:v.mappingConfigId||v.id,platform:i.id,url:P.url||D||t,data:P};if(v.validation&&!this.validateExtractedItem(P,v.validation)){console.log(`[PF] Item failed validation for extractor ${v.id} (ID: ${M.id})`);return}const U=await this.attachMetadata(M,M.url,this.activeJobContext||void 0);switch(a.push(U),v.type){case"tweet":case"post":o.posts++;break;case"profile":o.profiles++;break;case"comment":o.comments++;break}}catch(T){console.error(`[PF] Error processing item in extractor ${v.id}:`,T,`Item preview: ${JSON.stringify(m).slice(0,100)}...`)}};for(const m of e)try{let v=null;for(const T of m.responsePaths||[])if(v=this.getByPath(r,T),v){console.log(`[PF] Found base data for extractor ${m.id} using responsePath: ${T}`);break}if(!v){console.log(`[PF] No base data found for extractor ${m.id} in any responsePath`);continue}if(Array.isArray(v)&&v.length>0&&((u=(l=v[0])==null?void 0:l.type)!=null&&u.startsWith("Timeline"))){console.log(`[PF] Base data is an array, treating as instructions for extractor ${m.id}`);for(const T of v){if(!T||typeof T!="object")continue;let D=[];if(T.type==="TimelineAddEntries"&&((f=m.entryExtraction)!=null&&f.path)){let P=this.getByPath(T,m.entryExtraction.path);Array.isArray(P)||(P=P?[P]:[]),console.log(`[PF] (${m.id}) Found ${P.length} entries in TimelineAddEntries`),P.length>0&&((w=m.entryExtraction.filters)==null?void 0:w.length)>0?(console.log(`[PF] (${m.id}) Applying ${m.entryExtraction.filters.length} filters...`),D=P.filter(M=>m.entryExtraction.filters.every(U=>{const H=this.getByPath(M,U.field);return U.values.includes(H)})),console.log(`[PF] (${m.id}) ${D.length}/${P.length} entries remained after filtering`)):D=P}else if(T.type==="TimelinePinEntry"){const P=T.entry;if(P&&this.getByPath(P,"content.entryType")==="TimelineTimelineItem"){const M=this.getByPath(P,"entryId");console.log(`[PF] (${m.id}) Found pinned entry: ${M}`),((g=(h=m.entryExtraction)==null?void 0:h.filters)==null?void 0:g.length)>0?m.entryExtraction.filters.every(H=>{const N=this.getByPath(P,H.field);return H.values.includes(N)})?(D.push(P),console.log(`[PF] (${m.id}) Pinned entry ${M} passed filters.`)):console.log(`[PF] (${m.id}) Pinned entry ${M} did NOT pass filters.`):D.push(P)}}for(const P of D)await c(P,m)}}else if(m.entryExtraction){console.log(`[PF] (${m.id}) Processing as non-instruction data with entryExtraction.`);let T=[];if(m.entryExtraction.path){let D=this.getByPath(v,m.entryExtraction.path);Array.isArray(D)||(D=D?[D]:[]),console.log(`[PF] (${m.id}) Found ${D.length} entries using path: ${m.entryExtraction.path}`),D.length>0&&((S=m.entryExtraction.filters)==null?void 0:S.length)>0?(T=D.filter(P=>m.entryExtraction.filters.every(M=>{const U=this.getByPath(P,M.field);return M.values.includes(U)})),console.log(`[PF] (${m.id}) ${T.length}/${D.length} entries remained after filtering`)):T=D}else console.log(`[PF] (${m.id}) No entryExtraction path, using baseData directly.`),T=Array.isArray(v)?v:v?[v]:[];for(const D of T)await c(D,m)}else{console.log(`[PF] (${m.id}) Processing as non-instruction data without entryExtraction.`);let T=[];m.itemsPath?(T=this.getByPath(r,m.itemsPath)||[],Array.isArray(T)||(T=[T]),console.log(`[PF] (${m.id}) Found ${T.length} items using itemsPath: ${m.itemsPath}`)):(console.log(`[PF] (${m.id}) No itemsPath, using baseData directly.`),T=Array.isArray(v)?v:v?[v]:[]);for(const D of T)await c(D,m)}}catch(v){console.error(`[PF] Error processing extractor ${m.id}:`,v)}return console.log("[PF] Extraction complete:",{sourceUrl:t,totalItems:a.length,stats:o,itemTypes:[...new Set(a.map(m=>m.configId))]}),{items:a,stats:o}}mapDataWithConfig(r,e){const t={};for(const[i,a]of Object.entries(e))try{if(typeof a=="string")t[i]=this.getByPath(r,a);else if(typeof a=="object"&&a!==null)if(a.template&&a.params)t[i]=this.processTemplate(a.template,a.params,r);else if(a.transform&&a.path){const o=this.getByPath(r,a.path);if(Array.isArray(a.transform)){let c=o;for(const l of a.transform)c=this.transformValue(c,l,a.mapping);t[i]=c}else t[i]=this.transformValue(o,a.transform,a.mapping)}else t[i]=this.mapDataWithConfig(r,a)}catch(o){console.error(`[PF] Error mapping field ${i}:`,o)}return t}transformValue(r,e,t){switch(e){case"toNumber":return Number(r)||0;case"arrayMap":return Array.isArray(r)?r.map(i=>t.field?i[t.field]:i):[];default:return r}}processTemplate(r,e,t){let i=r;for(const[a,o]of Object.entries(e)){const c=this.getByPath(t,o);i=i.replace(`{${a}}`,c)}return i}validateExtractedItem(r,e){var t,i;return!((t=e.required)!=null&&t.length&&!e.required.every(a=>r[a])||(i=e.meaningfulData)!=null&&i.length&&!e.meaningfulData.some(o=>{const c=r[o];return c&&(typeof c=="string"?c.length>0:typeof c=="number"?c>0:typeof c=="boolean"?c===!0:!1)}))}async executeCommands(r,e){if(!e||e.isClosed()){console.warn("[PF] Cannot execute commands: Page closed");return}try{for await(const t of r){if(!this.isActiveGatheringRunning||!e||e.isClosed()){console.warn("[PF] Stopping command execution: Gathering stopped or page closed");break}console.log(`[PF] Executing: ${t.type}`,t.selector||t.value||"");try{switch(t.type){case"goto":{if(!t.value||typeof t.value!="string"){if(t.required)throw new Error("[PF] 'goto' command requires a URL string in 'value'.");continue}await e.goto(t.value,{waitUntil:t.waitUntil||"load",timeout:t.timeout||3e4}).catch(i=>{throw(i.message.includes("Target closed")||i.message.includes("disconnected"))&&console.warn("[PF] Page closed during navigation, stopping command execution"),i});break}case"waitForSelector":{if(!t.selector){if(t.required)throw new Error("[PF] 'waitForSelector' requires a selector.");continue}await e.waitForSelector(t.selector,{visible:t.visible,hidden:t.hidden,timeout:t.timeout||1e4});break}case"waitUntilLoaded":{await e.waitForNavigation({waitUntil:t.waitUntil||"load",timeout:t.timeout||3e4});break}case"findElement":{if(!t.selector){if(t.required)throw new Error("[PF] 'findElement' requires a selector.");continue}if(!await e.$(t.selector)&&t.required)throw new Error(`[PF] Element not found: ${t.selector}`);break}case"click":{if(!t.selector){if(t.required)throw new Error("[PF] 'click' requires a selector.");continue}const i=await e.$(t.selector);if(!i){if(t.required)throw new Error(`[PF] Element not found for click: ${t.selector}`);continue}await i.click({clickCount:t.clickCount||1,delay:t.delay});break}case"type":{if(!t.selector||typeof t.value!="string"){if(t.required)throw new Error("[PF] 'type' requires a selector and string value.");continue}const i=await e.$(t.selector);if(!i){if(t.required)throw new Error(`[PF] Element not found for typing: ${t.selector}`);continue}await i.type(t.value,{delay:t.delay||100});break}case"press":{if(!t.value){if(t.required)throw new Error("[PF] 'press' requires a key value.");continue}if(t.selector){const i=await e.$(t.selector);if(!i){if(t.required)throw new Error(`[PF] Element not found for press: ${t.selector}`);continue}await i.press(t.value,{delay:t.delay||100})}else await e.keyboard.press(t.value,{delay:t.delay||100});break}case"wait":{const i=t.timeout||(typeof t.value=="number"?t.value:5e3);await this.waitForTimeout(i);break}case"scroll":{const i=t.scrollTarget??void 0,a=t.scrollAmount??500;if(i==="bottom")await e.evaluate(()=>window.scrollTo(0,document.body.scrollHeight));else if(i==="top")await e.evaluate(()=>window.scrollTo(0,0));else if(typeof a=="number"&&(!i||i==="amount"))await e.evaluate(o=>window.scrollBy(0,o),a);else if(i){const o=await e.$(i);if(o)await o.evaluate(c=>c.scrollIntoView({behavior:"smooth"})),t.delay&&await this.waitForTimeout(t.delay);else if(t.required)throw new Error(`[PF] Scroll target selector not found: ${i}`)}t.delay&&await this.waitForTimeout(t.delay);break}case"hover":{if(!t.selector){if(t.required)throw new Error("[PF] 'hover' requires a selector.");continue}const i=await e.$(t.selector);if(i)await i.hover();else if(t.required)throw new Error(`[PF] Element not found for hover: ${t.selector}`);break}case"waitUntilVisible":{if(!t.selector){if(t.required)throw new Error("[PF] 'waitUntilVisible' requires a selector.");continue}await e.waitForSelector(t.selector,{visible:!0,timeout:t.timeout||1e4});break}case"blockMouseEvents":{try{await e.evaluate(()=>{const i=EventTarget.prototype.addEventListener;EventTarget.prototype.addEventListener=function(c,l,u){if(c.startsWith("mouse")||c==="click"){const f=function(w){return w.preventDefault(),w.stopPropagation(),!1};return i.call(this,c,f,!0)}return i.call(this,c,l,u)},["click","mousedown","mouseup","mousemove","mouseover"].forEach(c=>{document.addEventListener(c,l=>(l.preventDefault(),l.stopPropagation(),!1),!0)}),document.body&&(document.body.style.pointerEvents="none");const o=document.createElement("style");o.textContent=`
                    * {
                      user-select: none !important;
                      pointer-events: none !important;
                      cursor: not-allowed !important;
                    }
                  `,document.head.appendChild(o),console.log("Click prevention activated")}),await this.waitForTimeout(100)}catch(i){console.error(`Error setting up click prevention: ${i}`)}break}case"select":{if(!t.selector||!t.value){if(t.required)throw new Error("[PF] 'select' requires a selector and value.");continue}const i=Array.isArray(t.value)?t.value.filter(o=>typeof o=="string"):typeof t.value=="string"?[t.value]:[];if(i.length===0){if(t.required)throw new Error("[PF] 'select' value must be a string or array of strings.");continue}const a=await e.$(t.selector);if(a)await a.select(...i);else if(t.required)throw new Error(`[PF] Element not found for select: ${t.selector}`);break}case"focus":{if(!t.selector){if(t.required)throw new Error("[PF] 'focus' requires a selector.");continue}const i=await e.$(t.selector);if(i)await i.focus();else if(t.required)throw new Error(`[PF] Element not found for focus: ${t.selector}`);break}case"blur":{if(!t.selector){if(t.required)throw new Error("[PF] 'blur' requires a selector.");continue}const i=await e.$(t.selector);if(i)await i.evaluate(a=>a.blur());else if(t.required)throw new Error(`[PF] Element not found for blur: ${t.selector}`);break}case"clear":{if(!t.selector){if(t.required)throw new Error("[PF] 'clear' requires a selector.");continue}const i=await e.$(t.selector);if(i)await i.evaluate(a=>{(a instanceof HTMLInputElement||a instanceof HTMLTextAreaElement)&&(a.value="")});else if(t.required)throw new Error(`[PF] Element not found for clear: ${t.selector}`);break}default:console.warn(`[PF] Unknown command type: ${t.type}`)}}catch(i){if(console.error(`[PF] Error in command ${t.type}:`,i),t.required&&i instanceof Error&&!i.message.includes("Target closed")&&!i.message.includes("disconnected"))throw i}}}catch(t){console.error("[PF] Error executing command sequence:",t)}}async generateMetadata(r,e){const t=new Date().toISOString(),i=r!=null&&r.isActiveJob?"active":"observer",a=[];r!=null&&r.isActiveJob&&"jobId"in r&&typeof r.jobId=="string"&&a.push({jobId:r.jobId,gatheredAt:t,gatherType:"active"});let o;return r!=null&&r.isActiveJob&&"tabId"in r&&typeof r.tabId=="number"?o=r.tabId:typeof this.activeTabId=="number"&&(o=this.activeTabId),{jobAssociations:a.length>0?a:void 0,gatheredAt:t,gatherType:i,sourceUrl:e||(this.activePage&&!this.activePage.isClosed()?this.activePage.url():void 0),tabId:o}}async attachMetadata(r,e,t){var o;const i=t??this.activeJobContext??void 0;if(!i)return r;const a=await this.generateMetadata(i,e);if(r.metadata){const c=r.metadata,l=[...c.jobAssociations||[]];if((o=a.jobAssociations)!=null&&o.length)for(const f of a.jobAssociations)l.some(w=>w.jobId===f.jobId)||l.push(f);const u={...c,...a,jobAssociations:l.length>0?l:void 0};return{...r,metadata:u}}return{...r,metadata:a}}async handleGatheredData(r,e,t){if(!this.getPlatformDefinition(r)){console.error(`[PF] Platform definition missing for ${r}`);return}const a=e.items,o=t??this.activeJobContext;if(console.log(`[PF] Handling gathered data for platform ${r}:`,{newItemsCount:(a==null?void 0:a.length)||0,jobContext:o?{jobId:o.jobId,isActiveJob:o.isActiveJob}:"none",itemsWithMetadata:a==null?void 0:a.map(c=>{var l,u;return{id:c.id,hasMetadata:!!c.metadata,jobAssociations:(u=(l=c.metadata)==null?void 0:l.jobAssociations)==null?void 0:u.map(f=>f.jobId)}})}),!a||a.length===0){o!=null&&o.isActiveJob&&await this.handlePostDataMerge(r,e);return}try{const c=await chrome.storage.local.get(["gatheredData","captureStats","showBadge"]),l=c.gatheredData||{},u=l[r]||[];console.log(`[PF] Current stored items for ${r}:`,{storedItemsCount:u.length,storedItemsWithMetadata:u.map(w=>{var h,g;return{id:w.id,hasMetadata:!!w.metadata,jobAssociations:(g=(h=w.metadata)==null?void 0:h.jobAssociations)==null?void 0:g.map(S=>S.jobId)}})});const f=await this.mergeGenericItems(u,a,o);if(console.log("[PF] Merge result:",{itemsAdded:f.itemsAdded,updatedItemsCount:f.updatedItems.length,updatedItemsWithMetadata:f.updatedItems.map(w=>{var h,g;return{id:w.id,hasMetadata:!!w.metadata,jobAssociations:(g=(h=w.metadata)==null?void 0:h.jobAssociations)==null?void 0:g.map(S=>S.jobId)}})}),f.itemsAdded>0){l[r]=f.updatedItems,await chrome.storage.local.set({gatheredData:l});const w=c.captureStats||{posts:0,comments:0,profiles:0},h={posts:w.posts+f.newlyAddedStats.posts,comments:w.comments+f.newlyAddedStats.comments,profiles:w.profiles+f.newlyAddedStats.profiles};await chrome.storage.local.set({captureStats:h}),console.log(`[PF] Merged ${r} data. New items: ${f.itemsAdded}.`),await this.updateBadge(c.showBadge);const g=r==="twitter"?ot.TWITTER_FEED:r==="reddit"?ot.REDDIT_FEED:"GENERIC_FEED";this.sendPopupUpdate(g,r,f.updatedItems,h)}o!=null&&o.isActiveJob&&await this.handlePostDataMerge(r,e)}catch(c){console.error(`[PF] Error handling gathered data for ${r}:`,c)}}async mergeGenericItems(r,e,t){var h,g,S,m,v,T,D,P,M,U,H;console.log("[PF] Starting mergeGenericItems:",{storedItemsCount:r.length,newItemsCount:e.length,context:t?{isActiveJob:t.isActiveJob,jobId:t.isActiveJob&&"jobId"in t?t.jobId:"none",startTime:t.startTime}:"none"});const i=new Map(r.map(N=>[N.id,N]));let a=0;const o={posts:0,comments:0,profiles:0},c=e.length>0?this.getPlatformDefinition(e[0].platform):void 0,l=((S=(g=(h=c==null?void 0:c.gathering)==null?void 0:h.passive)==null?void 0:g.itemExtractionConfig)==null?void 0:S.filter(N=>N.id.includes("post")||N.id.includes("tweet")).map(N=>N.id))??[],u=((T=(v=(m=c==null?void 0:c.gathering)==null?void 0:m.passive)==null?void 0:v.itemExtractionConfig)==null?void 0:T.filter(N=>N.id.includes("profile")||N.id.includes("user")).map(N=>N.id))??[],f=((M=(P=(D=c==null?void 0:c.gathering)==null?void 0:D.passive)==null?void 0:P.itemExtractionConfig)==null?void 0:M.filter(N=>N.id.includes("comment")).map(N=>N.id))??[];console.log("[PF] Config IDs for merging:",{postConfigIds:l,profileConfigIds:u,commentConfigIds:f});for(const N of e){if(!N.id){console.warn("[PF] Skipping item with missing ID:",N);continue}const G=await this.attachMetadata(N,N.url,t??void 0);if(console.log("[PF] Processing item for merge:",{id:G.id,configId:G.configId,hasMetadata:!!G.metadata,jobAssociations:(H=(U=G.metadata)==null?void 0:U.jobAssociations)==null?void 0:H.map(L=>({jobId:L.jobId,gatherType:L.gatherType}))}),!i.has(G.id))i.set(G.id,G),a++,l.includes(G.configId)&&o.posts++,u.includes(G.configId)&&o.profiles++,f.includes(G.configId)&&o.comments++;else{const L=i.get(G.id),V=await this.attachMetadata(L,L.url,t??void 0);V.data={...L.data},i.set(V.id,V)}}const w=Array.from(i.values());return console.log("[PF] Merge complete:",{itemsAdded:a,totalItems:w.length,stats:o,updatedItemsWithMetadata:w.map(N=>{var G,L;return{id:N.id,configId:N.configId,hasMetadata:!!N.metadata,jobAssociations:(L=(G=N.metadata)==null?void 0:G.jobAssociations)==null?void 0:L.map(V=>({jobId:V.jobId,gatherType:V.gatherType}))}})}),{updatedItems:w,itemsAdded:a,newlyAddedStats:o}}async handlePostDataMerge(r,e){var o,c,l,u,f,w,h,g,S;if(!this.isActiveGatheringRunning||!this.activeJobContext||this.activeJobContext.platformId!==r)return;const t=this.activeJobContext.jobId,i=this.activeJobContext.userId;if(!t||!i)return;const a=this.getPlatformDefinition(r);if(a)try{const{relevantItems:m}=await this.getFilteredJobData(r,t,this.activeJobRequirements);let v=0,T=0,D=0;const P=((l=(c=(o=a.gathering)==null?void 0:o.passive)==null?void 0:c.itemExtractionConfig)==null?void 0:l.filter(V=>V.id.includes("post")||V.id.includes("tweet")).map(V=>V.id))??[],M=((w=(f=(u=a.gathering)==null?void 0:u.passive)==null?void 0:f.itemExtractionConfig)==null?void 0:w.filter(V=>V.id.includes("profile")||V.id.includes("user")).map(V=>V.id))??[],U=((S=(g=(h=a.gathering)==null?void 0:h.passive)==null?void 0:g.itemExtractionConfig)==null?void 0:S.filter(V=>V.id.includes("comment")).map(V=>V.id))??[];m.forEach(V=>{P.includes(V.configId)&&v++,M.includes(V.configId)&&D++,U.includes(V.configId)&&T++});const H={jobId:t,userId:i,lastUpdated:new Date().toISOString(),stats:{tweets:v,comments:T,profiles:D,totalTweets:v,totalProfiles:D},status:"in_progress"},G=(await chrome.storage.local.get("jobProgress")).jobProgress||{};G[t]=H,await chrome.storage.local.set({jobProgress:G}),await this.shouldSubmitJobResult(t,this.activeJobRequirements)&&(console.log(`[PF] Submitting job ${t}.`),await Sw({job_id:t,user_id:i}),H.status="completed",G[t]=H,await chrome.storage.local.set({jobProgress:G}),console.log(`[PF] Job ${t} submitted. Stopping gathering.`),await this.stopActiveGathering())}catch(m){console.error(`[PF] Error in handlePostDataMerge for job ${t}:`,m);const T=(await chrome.storage.local.get("jobProgress")).jobProgress||{},D=m instanceof Error?`${m.name}: ${m.message}${m.stack?` Stack: ${m.stack}`:""}`:JSON.stringify(m);T[t]={...T[t],jobId:t,userId:i||"unknown",lastUpdated:new Date().toISOString(),status:"failed",error:D},await chrome.storage.local.set({jobProgress:T})}}async getFilteredJobData(r,e,t){var v,T,D,P,M,U,H,N,G,L,V,De,A;const o=((await chrome.storage.local.get("gatheredData")).gatheredData||{})[r]||[],c=this.getPlatformDefinition(r);console.log(`[PF] Starting getFilteredJobData for job ${e}:`,{platformId:r,totalPlatformItems:o.length,requirements:t?{filters:t.filters,postLimit:(v=t.filters)==null?void 0:v.postLimit,profileLimit:(T=t.filters)==null?void 0:T.profileLimit}:"none"});let l=o.filter(k=>{var K,$;return($=(K=k.metadata)==null?void 0:K.jobAssociations)==null?void 0:$.some(te=>te.jobId===e&&te.gatherType==="active")})||[];if(console.log("[PF] After job association filter:",{jobItemsCount:l.length,jobItemsWithMetadata:l.map(k=>{var K,$;return{id:k.id,configId:k.configId,jobAssociations:($=(K=k.metadata)==null?void 0:K.jobAssociations)==null?void 0:$.map(te=>({jobId:te.jobId,gatherType:te.gatherType}))}})}),t!=null&&t.filters){const k=t.filters,K=((M=(P=(D=c==null?void 0:c.gathering)==null?void 0:D.passive)==null?void 0:P.itemExtractionConfig)==null?void 0:M.filter($=>$.id.includes("profile")||$.id.includes("user")).map($=>$.id))??[];l=l.filter($=>!(k.minLikes&&$.data.likes<k.minLikes||k.minRetweets&&$.data.reposts<k.minRetweets||k.minReplies&&$.data.replies<k.minReplies||K.includes($.configId)&&(k.minFollowers&&$.data.followerCount<k.minFollowers||k.minFollowing&&$.data.followingCount<k.minFollowing))),console.log("[PF] After requirement filters:",{jobItemsCount:l.length,filteredItems:l.map($=>({id:$.id,configId:$.configId,data:{likes:$.data.likes,reposts:$.data.reposts,replies:$.data.replies,followerCount:$.data.followerCount,followingCount:$.data.followingCount}}))})}let u=0,f=0;const w=((N=(H=(U=c==null?void 0:c.gathering)==null?void 0:U.passive)==null?void 0:H.itemExtractionConfig)==null?void 0:N.filter(k=>k.id.includes("post")||k.id.includes("tweet")).map(k=>k.id))??[],h=((V=(L=(G=c==null?void 0:c.gathering)==null?void 0:G.passive)==null?void 0:L.itemExtractionConfig)==null?void 0:V.filter(k=>k.id.includes("profile")||k.id.includes("user")).map(k=>k.id))??[],g=[],S=(De=t==null?void 0:t.filters)==null?void 0:De.postLimit,m=(A=t==null?void 0:t.filters)==null?void 0:A.profileLimit;for(const k of l){const K=w.includes(k.configId),$=h.includes(k.configId);if(K&&(!S||u<S)?(g.push(k),u++):$&&(!m||f<m)?(g.push(k),f++):!K&&!$&&(!S||u<S)&&g.push(k),S&&u>=S&&m&&f>=m)break}return{relevantItems:g}}async shouldSubmitJobResult(r,e,t=!1){var m,v,T,D,P,M,U,H,N,G;const i=(m=this.activeJobContext)==null?void 0:m.platformId;if(!i)return!1;if(!e){const L=this.activeScrollAttempts>=this.maxScrollAttempts,V=!this.isActiveGatheringRunning||t;if(L||V){const A=(v=(await chrome.storage.local.get("jobProgress")).jobProgress)==null?void 0:v[r];if((A==null?void 0:A.status)!=="completed"&&(A==null?void 0:A.status)!=="failed")return!0}return!1}const{relevantItems:a}=await this.getFilteredJobData(i,r,e);let o=0,c=0;const l=this.getPlatformDefinition(i),u=((P=(D=(T=l==null?void 0:l.gathering)==null?void 0:T.passive)==null?void 0:D.itemExtractionConfig)==null?void 0:P.filter(L=>L.id.includes("post")||L.id.includes("tweet")).map(L=>L.id))??[],f=((H=(U=(M=l==null?void 0:l.gathering)==null?void 0:M.passive)==null?void 0:U.itemExtractionConfig)==null?void 0:H.filter(L=>L.id.includes("profile")||L.id.includes("user")).map(L=>L.id))??[];a.forEach(L=>{u.includes(L.configId)&&o++,f.includes(L.configId)&&c++});const w=(N=e.filters)==null?void 0:N.postLimit,h=(G=e.filters)==null?void 0:G.profileLimit,g=!w||o>=w,S=!h||c>=h;return g&&S}async updateBadge(r){if(r===!1){await chrome.action.setBadgeText({text:""});return}const t=(await chrome.storage.local.get("gatheredData")).gatheredData||{};let i=0;Object.values(t).forEach(a=>i+=(a==null?void 0:a.length)??0),await chrome.action.setBadgeBackgroundColor({color:"black"}),await chrome.action.setBadgeTextColor({color:"white"}),await chrome.action.setBadgeText({text:Vc(i)})}sendPopupUpdate(r,e,t,i){chrome.runtime.sendMessage({target:yd.POPUP,type:r,data:{platformId:e,items:t,stats:i}}).catch(()=>{})}async checkRecentGatheringActivity(r){return new Promise(e=>{chrome.storage.local.get("gatheredData",t=>{const a=(t.gatheredData||{})[r];if(!a||a.length===0){e(!1);return}const c=Date.now()-24*60*60*1e3,l=a.some(u=>{var f;return((f=u.metadata)==null?void 0:f.gatheredAt)&&new Date(u.metadata.gatheredAt).getTime()>c});e(l)})})}async waitForTimeout(r){return new Promise(e=>setTimeout(e,r))}validatePlatformDefinition(r){const t=["id","name","version","hostnames","paths","capabilities","gathering"].filter(i=>!(i in r));if(t.length>0)throw new Error(`Invalid platform definition ${r.id}: Missing fields: ${t.join(", ")}`);if(!r.capabilities.active&&!r.capabilities.passive)throw new Error(`Platform ${r.id} must support >= 1 capability`);if(r.capabilities.active&&!r.gathering.active)throw new Error(`Platform ${r.id} active but no active strategy`)}unregisterPlatform(r){this.platforms.has(r)&&(this.platforms.delete(r),console.log(`[PF] Platform ${r} unregistered.`))}getRegisteredPlatformIds(){return Array.from(this.platforms.keys())}};F(Ve,"windowRegistry",new Map),F(Ve,"isListening",!1);let ed=Ve;const fs=new ed;var vh;(vh=chrome.runtime.onSuspend)==null||vh.addListener(()=>{console.log("[PF] Runtime suspending, clearing window registry."),fs.cleanup()});let Z=null,Hc=null,jt=null,li=0,ks="Calculating...",ia=0;const Mp=5*60*1e3,kw="secure.ws.teneo.pro",Ew=`wss://${kw}/websocket`;let He=null;async function Tw(){const s=Z!==null&&Z.readyState===WebSocket.OPEN,r={isConnected:s,lastConnectionStateChange:{state:s?"CONNECTED":"DISCONNECTED",timestamp:Date.now()}};await chrome.storage.session.set(r),await chrome.storage.local.set(r),He&&He.postMessage({type:s?"WEBSOCKET_CONNECTED":"WEBSOCKET_DISCONNECTED",timestamp:Date.now()})}class Cw{constructor(){F(this,"currentState","DISCONNECTED");F(this,"lastStateChange",null);F(this,"stateChangeTimeout",null);F(this,"DEBOUNCE_TIME",5e3);F(this,"initialized",!1);this.lastStateChange={state:"DISCONNECTED",timestamp:Date.now()},this.initializeConnectionState()}async initializeConnectionState(){if(this.initialized)return;const r={isConnected:!1,lastConnectionStateChange:this.lastStateChange};await chrome.storage.session.set(r),await chrome.storage.local.set(r),this.initialized=!0,console.log("ConnectionStateManager initialized with DISCONNECTED state (session/local storage)")}getState(){return this.currentState}async setState(r){if(this.initialized||await this.initializeConnectionState(),this.currentState!==r){if(this.stateChangeTimeout&&(clearTimeout(this.stateChangeTimeout),this.stateChangeTimeout=null),r==="DISCONNECTED")return new Promise(e=>{this.stateChangeTimeout=setTimeout(()=>{this.applyStateChange(r),e()},this.DEBOUNCE_TIME)});this.applyStateChange(r)}}applyStateChange(r){this.currentState=r,this.lastStateChange={state:r,timestamp:Date.now()};const e={isConnected:r==="CONNECTED",lastConnectionStateChange:this.lastStateChange};if(chrome.storage.session.set(e),chrome.storage.local.set(e),console.log(`WebSocket state changed to: ${r} (session/local storage)`),He)switch(r){case"CONNECTED":He.postMessage({type:"WEBSOCKET_CONNECTED",timestamp:this.lastStateChange.timestamp});break;case"DISCONNECTED":He.postMessage({type:"WEBSOCKET_DISCONNECTED",timestamp:this.lastStateChange.timestamp});break;case"RECONNECTING":He.postMessage({type:"WEBSOCKET_RECONNECTING",timestamp:this.lastStateChange.timestamp});break}}async verifyConnectionState(){const r=Z!==null&&Z.readyState===WebSocket.OPEN,e=this.currentState==="CONNECTED";r!==e&&(console.log(`Connection state mismatch detected. Actual: ${r}, Stored: ${e}`),await this.setState(r?"CONNECTED":"DISCONNECTED"));const t={isConnected:r,lastConnectionStateChange:{state:r?"CONNECTED":"DISCONNECTED",timestamp:Date.now()}};await chrome.storage.session.set(t),await chrome.storage.local.set(t)}}const zt=new Cw;function Pw(s){const e=s*5e3;return Math.min(5e3+e,Mp)}function _w(){try{wd(),Hc=setInterval(async()=>{Z&&Z.readyState===WebSocket.OPEN&&(Z.send(JSON.stringify({type:"PING"})),chrome.storage.local.set({lastPingDate:new Date().toISOString()}))},1e4)}catch(s){z("Error in ping interval:",s)}}async function Ap(){console.log("checkAndSendPassiveData");try{const{passiveDataSendingEnabled:s}=await chrome.storage.local.get("passiveDataSendingEnabled");if(console.log("passiveDataSendingEnabled:",s),s===!1){console.log("Passive data sending is disabled by user setting.");return}const e=(await chrome.storage.local.get("gatheredData")).gatheredData||{};console.log("gatheredData",e);let t=0,i=0,a=0;const o=[],c=[];for(const l in e){const u=e[l]||[];t+=u.length,u.forEach((f,w)=>{var g,S;(((g=f.metadata)==null?void 0:g.gatherType)==="observer"||((S=f.metadata)==null?void 0:S.gatherType)==="autonomous")&&(i++,f.sent||(a++,o.push(f),c.push({platform:l,index:w})))})}if(console.log(`Total items: ${t}, Passive items: ${i}, Unsent passive items: ${a}`),console.log("itemsToMarkSent",c,"passiveItems",o),o.length>100){console.log(`Sending ${o.length} passive items`);const l=o.reduce((u,f)=>(f.configId.includes("comment")?u.commentCount++:f.configId.includes("tweet")?u.postCount++:f.configId.includes("profile")?u.profileCount++:f.configId.includes("post")&&u.postCount++,u),{commentCount:0,postCount:0,profileCount:0});Z==null||Z.send(JSON.stringify({event:"submitCollectedData",data:{items:o,stats:l,timestamp:new Date().toISOString(),itemCount:o.length}})),Fl();for(const{platform:u,index:f}of c)e[u]&&e[u][f]&&(e[u][f].sent=!0);await chrome.storage.local.set({gatheredData:e}),await chrome.storage.local.set({lastDataTransmission:{timestamp:new Date().toISOString(),itemCount:o.length}})}else console.log(`Not enough passive items to send: ${o.length} (need > 1)`)}catch(s){z("Error sending passive data:",s)}}function wd(){Hc&&(clearInterval(Hc),Hc=null)}function nh(){try{chrome.storage.local.get(["lastUpdated","lastDataTransmission"],async s=>{const r=s.lastUpdated,e=s.lastDataTransmission;if(console.log(" updateCountdownAndPoints - lastUpdated:",r),r){const t=new Date(r);t.setMinutes(t.getMinutes()+15);const i=new Date,a=t.getTime()-i.getTime();if(console.log(" updateCountdownAndPoints - diff:",a,"minutes:",Math.floor(a/6e4)),a>0){const o=Math.floor(a/6e4),c=Math.floor(a%6e4/1e3);ks=`${o}m ${c}s`;const l=25,f=(i.getTime()-new Date(r).getTime())/(60*1e3);let w=Math.min(l,f/15*l);if(w=parseFloat(w.toFixed(2)),e&&e.timestamp){const h=new Date(e.timestamp);if(i.getTime()-h.getTime()<=15*60*1e3){const S=Math.min(5,Math.floor(e.itemCount/200));w=Math.min(l+15,w+S),w=parseFloat(w.toFixed(2))}}if(Math.random()<.1){const h=Math.random()*2;w=Math.min(l+15,w+h),w=parseFloat(w.toFixed(2))}li=w}else console.log(" Heartbeat completed, sending completion to server"),await Ap(),Fl(),Z&&Z.readyState===WebSocket.OPEN&&(Z.send(JSON.stringify({event:"heartbeatComplete",data:{timestamp:new Date().toISOString(),potentialPoints:li}})),console.log(" Heartbeat completion sent to server, waiting for response")),ks="Calculating...",li=25,await chrome.storage.local.remove("lastDataTransmission")}else console.log(" No lastUpdated found, setting to Calculating..."),ks="Calculating...",li=0;chrome.storage.local.set({potentialPoints:li,countdown:ks})})}catch(s){z("Error updating countdown and points:",s)}}function Mw(){jt&&(clearInterval(jt),jt=null),chrome.storage.local.get(["lastUpdated"],s=>{if(!s.lastUpdated){const r=new Date;chrome.storage.local.set({lastUpdated:r.toISOString(),countdown:"15m 0s",potentialPoints:0})}}),nh(),jt=setInterval(nh,1e3)}function Aw(s,r){const e=s.split(".").map(Number),t=r.split(".").map(Number);for(let i=0;i<Math.max(e.length,t.length);i++){const a=e[i]||0,o=t[i]||0;if(a>o)return 1;if(a<o)return-1}return 0}function Iw(s){try{if(!s||typeof s!="object"||!s.version||typeof s.version!="string"||!s.generalConfig||typeof s.generalConfig!="object"||!s.gatheringConfig||typeof s.gatheringConfig!="object")return!1;const{generalConfig:r}=s;if(typeof r.passiveGatheringEnabled!="boolean"||typeof r.contentExtractionEnabled!="boolean"||typeof r.maxCaptures!="number")return!1;for(const e in s)if(e.endsWith("PlatformConfig")){const t=s[e];if(!t.id||!t.name||!t.version||!Array.isArray(t.hostnames)||!t.capabilities||typeof t.capabilities!="object")return!1}return!0}catch(r){return z("Config validation error:",r),!1}}async function Fw(s){var r;try{if(console.log("Received config update from server:",s),!s.config){O("Config update message missing config data");return}const e=s.config;if(!Iw(e)){z("Invalid config structure received from server");return}const i=(await chrome.storage.local.get("config")).config||Cl,a=i.version||"0.0.0",o=e.version;console.log(`Config version comparison: current=${a}, new=${o}`);const c=Aw(o,a);if(c>0){console.log(`Updating config from version ${a} to ${o}`);const l={...e,generalConfig:{...e.generalConfig},gatheringConfig:{...e.gatheringConfig,whitelist:((r=i.gatheringConfig)==null?void 0:r.whitelist)||e.gatheringConfig.whitelist}};await chrome.storage.local.set({config:l}),await chrome.storage.local.set({config:l});try{await chrome.runtime.sendMessage({type:"CONFIG_UPDATE_COMPLETE",data:{newConfig:l,oldConfig:i,previousVersion:a,newVersion:o}})}catch(u){z("Error notifying background script of config update:",u)}He&&He.postMessage({type:"CONFIG_UPDATED",data:{previousVersion:a,newVersion:o,timestamp:new Date().toISOString()}}),await chrome.storage.local.set({lastConfigUpdate:{timestamp:new Date().toISOString(),previousVersion:a,newVersion:o,source:"websocket"}})}else c===0?console.log("Config versions are the same, no update needed"):O(`Received older config version ${o}, current is ${a}. Ignoring.`)}catch(e){z("Error handling config update:",e)}}function Dw(){try{if(Z&&Z.readyState===WebSocket.OPEN){const s=wc().version||Cl.version;Z.send(JSON.stringify({event:"REQUEST_CONFIG_UPDATE",data:{currentVersion:s,timestamp:new Date().toISOString()}})),console.log(`Requested config update from server (current version: ${s})`)}else O("Cannot request config update: WebSocket not connected")}catch(s){z("Error requesting config update:",s)}}function Fl(){try{Z&&Z.readyState===WebSocket.OPEN&&Z.send(JSON.stringify({event:"getMyPoints",data:{timestamp:new Date().toISOString()}}))}catch(s){z("Error sending give me points request:",s)}}function Ow(){try{if(Z&&Z.readyState===WebSocket.OPEN){const s=wc().version||Cl.version;Z.send(JSON.stringify({event:"CONFIG_VERSION_INFO",data:{version:s,timestamp:new Date().toISOString()}}))}}catch(s){z("Error sending config version:",s)}}function ah(s,r){chrome.storage.local.get(["pointsTotal","pointsToday"],e=>{const t=s.points||{};console.log(" updatePointsAndStorage - Processing data:",{receivedPoints:t,savedPoints:e});const i=typeof t.total=="number"?t.total:e.pointsTotal||0,a=typeof t.daily=="number"?t.daily:e.pointsToday||0;console.log(" updatePointsAndStorage - Calculated values:",{pointsTotal:i,pointsToday:a}),r(i,a),chrome.storage.local.set({pointsTotal:i,pointsToday:a})})}function xw(s,r){chrome.storage.local.get(["pointsTotal","pointsToday"],e=>{const t=s.points||{},i=typeof t.total=="number"?t.total:e.pointsTotal||0,a=typeof t.daily=="number"?t.daily:e.pointsToday||0,o=new Date;chrome.storage.local.set({lastUpdated:o.toISOString(),pointsTotal:i,pointsToday:a}),r(i,a)})}function ua(s,r){He=s;try{if(Z){zt.verifyConnectionState();return}chrome.storage.local.get(["accessToken"],function(e){const t=e==null?void 0:e.accessToken;if(!t){z("No access token found, cannot connect WebSocket"),zt.setState("DISCONNECTED"),He&&He.postMessage({type:"USER_NOT_LOGGED_IN"});return}const a=`${Ew}?accessToken=${encodeURIComponent(t)}&version=${encodeURIComponent("v0.2")}`;console.log("Attempting WebSocket connection to:",a),Z=new WebSocket(a),Z.onopen=async()=>{console.log("WebSocket connection established"),ia=0,await zt.setState("CONNECTED"),_w(),Mw(),setTimeout(()=>{Ow(),Fl()},1e3)},Z.onmessage=o=>{const c=JSON.parse(o.data);if(console.log(" Received WebSocket message:",c),c.event==="myPoints"){console.log(" Received myPoints from server:",c),ah(c,r);return}if(c.event==="heartbeatComplete"||c.type==="heartbeatComplete"||c.message==="Pulse from server"&&c.pointsTotal!==void 0){console.log(" Received heartbeat completion response:",c),Ap(),Nw(c,r);return}if(c.type==="CONFIG_UPDATE"||c.event==="configUpdate"){Fw(c);return}He?He.postMessage({type:"FROM_WEBSOCKET",data:c}):O("Port not available");let l=!1;c.pointsTotal!==void 0&&c.pointsToday!==void 0&&(xw(c,r),l=!0),!l&&c.points&&c.points.daily!==void 0&&c.points.total!==void 0&&ah(c,r)},Z.onclose=async o=>{if(console.log("WebSocket connection closed",{wasClean:o.wasClean,code:o.code}),Z=null,wd(),jt&&(clearInterval(jt),jt=null),o.wasClean)ia=0,await zt.setState("DISCONNECTED");else{ia++;const c=Pw(ia);c<Mp?(console.log(`Attempting reconnection in ${c}ms (attempt ${ia})`),await zt.setState("RECONNECTING"),setTimeout(()=>{ua(He,r)},c)):(z("Max reconnect interval reached. Giving up."),await zt.setState("DISCONNECTED"))}},Z.onerror=o=>{z("WebSocket error:",o),Z&&Z.readyState===WebSocket.CLOSED&&z("WebSocket connection closed immediately. Possible causes: server down, invalid endpoint, or proxy misconfiguration."),zt.setState("DISCONNECTED")}})}catch(e){z("Error connecting WebSocket:",e),zt.setState("DISCONNECTED")}}function Rw(){try{Z&&(Z.close(1e3,"Manual disconnection"),Z=null,wd(),jt&&(clearInterval(jt),jt=null),zt.setState("DISCONNECTED"))}catch(s){z("Error disconnecting WebSocket:",s)}}function Lw(){return new Promise(s=>{chrome.storage.local.get(["countdown","potentialPoints"],r=>{s({countdown:r.countdown||"Calculating...",potentialPoints:r.potentialPoints||0})})})}function oh(s){He=s}async function Nw(s,r){try{console.log(" Processing heartbeat completion response:",s);const{date:e,message:t,points:i}=s,a=(i==null?void 0:i.total)||0,o=(i==null?void 0:i.daily)||0,c=new Date;await chrome.storage.local.set({lastUpdated:e||c.toISOString(),pointsTotal:a,pointsToday:o,lastHeartbeatCompletion:{timestamp:e||c.toISOString(),pointsEarned:o,message:t||"Heartbeat completed"}}),ks="15m 0s",li=0,await chrome.storage.local.set({countdown:ks,potentialPoints:li,lastDataTransmission:null}),r(a,o),console.log(" Heartbeat completion processed successfully")}catch(e){z("Error handling heartbeat completion response:",e)}}const ch={reddit:!0,twitter:!0};function Kw(s){return s==null||typeof s=="function"?{main:s}:s}async function zn(s,r,e={}){const{maxRetries:t=2,retryDelay:i=1e3,filter:a}=e;let o=0,c=[],l=Object.entries(s);for(;l.length>0&&o<=t;){c=[];for(const[u,f]of l){if(u===void 0||f===void 0||a&&!a(u,f)){typeof window<"u"&&window.console?console.warn("[objectEntriesSafe] Skipping invalid entry:",u,f):typeof global<"u"&&global.console&&global.console.warn("[objectEntriesSafe] Skipping invalid entry:",u,f),c.push([u,f]);continue}await r(u,f)}if(c.length>0&&o<t)await new Promise(u=>setTimeout(u,i)),l=c,o++;else break}}let ci=null,td={startTime:"00:00",endTime:"23:59"};chrome.storage.local.get(["gatheringHours"],s=>{s.gatheringHours&&(td=s.gatheringHours)});chrome.storage.local.get(["platformSettings"],s=>{s.platformSettings&&s.platformSettings});const $w=()=>{const s=new Date,r=s.getHours().toString().padStart(2,"0")+":"+s.getMinutes().toString().padStart(2,"0");return r>=td.startTime&&r<=td.endTime},Gc=(s,r)=>{chrome.storage.local.set({combinedPointsTotal:s,combinedPointsToday:r})},vd=new Set;chrome.runtime.onMessage.addListener((s,r)=>{var e;if(s.type==="CONTENT_SCRIPT_READY"&&((e=r.tab)!=null&&e.id)){O(`Content script ready in tab ${r.tab.id} on URL ${s.url}`),vd.add(r.tab.id);const t=us.getPlatformForUrl(s.url);t?(O(`Platform found: ${t.id}. Initializing content script...`),us.initializeContentScript(r.tab.id,t)):O(`No platform identified for tab ${r.tab.id} on URL ${s.url}. Script will remain idle.`)}return!1});chrome.tabs.onUpdated.addListener(async(s,r,e)=>{if(r.status==="complete"&&e.url){O(`Tab ${s} updated, checking if content script reload needed`),vd.delete(s);const t=wc();if(!t){z("No config found, skipping content script reload");return}if(Object.entries(t).filter(([o])=>o.endsWith("PlatformConfig")).map(([,o])=>o).some(o=>{var c;return(c=o.hostnames)==null?void 0:c.some(l=>{var u;return(u=e.url)==null?void 0:u.includes(l)})}))try{await new Promise(o=>setTimeout(o,1e3)),await us.updateContentScriptStates()}catch(o){z(`Error updating content scripts for tab ${s}:`,o)}Op(e.url)&&(O("Dashboard tab updated, scheduling sync operations"),Dp(s))}});async function lh(){try{const s=await Cc.scripting.getRegisteredContentScripts({ids:[Cc.runtime.id]});if(!s||s.length===0){O("No content scripts registered yet, skipping reload");return}vd.clear(),await Cc.scripting.unregisterContentScripts({ids:s.map(r=>r.id)}),await Cc.scripting.registerContentScripts(s),await new Promise(r=>setTimeout(r,1e3)),await us.updateContentScriptStates(),O("Content scripts reloaded successfully.")}catch(s){z("Failed to reload content scripts:",s)}}async function Ww(){const r=(await chrome.storage.session.get(["manuallyDisconnected"])).manuallyDisconnected||!1,t=(await chrome.storage.local.get("config")).config||{},i=new Set;Object.values(t).forEach(c=>{c.hostnames&&c.hostnames.forEach(l=>{i.add(l)})});const o=(await chrome.tabs.query({})).some(c=>{if(!c.url)return!1;try{const u=new URL(c.url).hostname.replace("www.","");return i.has(u)}catch{return!1}});return{isManuallyDisconnected:r,hasPlatformTab:o}}const Bw=Kw({type:"module",async main(){O("Background script loaded"),await Hw(),chrome.storage.local.get(["gatheredData"]).then(s=>{const r=bh(s.gatheredData)||0;chrome.action.setBadgeText({text:Vc(r)})}),chrome.storage.local.get("config",s=>{const r=wc()||s.config;if(!r){z("No config found, skipping content script reload");return}id(r),rd(r),chrome.storage.local.set({config:r},()=>{chrome.runtime.lastError?z("Error saving config:",chrome.runtime.lastError):(O("Config saved successfully"),lh())})}),chrome.storage.local.get(["platformSettings","passiveGatheringEnabled","contentExtractionEnabled","autoScrollEnabled","maxCaptures","gatheringHours","passiveDataSendingEnabled"],s=>{const r={};s.platformSettings||(r.platformSettings=ch),s.passiveGatheringEnabled===void 0&&(r.passiveGatheringEnabled=!1),s.contentExtractionEnabled===void 0&&(r.contentExtractionEnabled=!1),s.autoScrollEnabled===void 0&&(r.autoScrollEnabled=!1),s.maxCaptures===void 0&&(r.maxCaptures=100),s.gatheringHours||(r.gatheringHours={startTime:"00:00",endTime:"23:59"}),s.passiveDataSendingEnabled===void 0&&(r.passiveDataSendingEnabled=!0),Object.keys(r).length>0&&chrome.storage.local.set(r)}),chrome.runtime.onMessage.addListener((s,r,e)=>{var t;if(s.type==="RELOAD_CONTENT_SCRIPTS")return lh(),e({success:!0}),!0;if(s.target===yd.BACKGROUND){switch(s.type){case ot.UPDATE_BADGE_COUNT:{chrome.action.setBadgeText({text:s.data.total>0?Vc(s.data.total):""}),e({success:!0});return}case ot.GET_CURRENT_TAB:e({tabId:(t=r.tab)==null?void 0:t.id});return;case ot.RUN_PUPPETEER:if(!$w()){e({error:"Outside of gathering hours"});return}return jw(s.commands).then(()=>O("Twitter gathering with Puppeteer (Active) completed")),!0;case ot.TWITTER_FEED:case ot.REDDIT_FEED:{ol(),e({success:!0});break}case ot.SYNC_GATHERED_DATA:return ol().then(e),!0;case ot.SYNC_FULL_CONFIG:{chrome.storage.local.set({config:s.data}),e({status:"Full config synced"});break}case"PLATFORM_SETTINGS_CHANGED":s.data,qw(),e({status:"Platform settings updated"});break;default:O(`Unexpected message type: '${s.type}'`)}return s.type===ot.RUN_PUPPETEER||s.type===ot.CHECK_JOB_WEBSOCKET_STATUS}else if(s.type==="CONNECT_WEBSOCKET")ua(ci,Gc),e({status:"WebSocket connection initiated via service"});else if(s.type==="DISCONNECT_WEBSOCKET")Rw(),e({status:"WebSocket disconnected via service"});else{if(s.type==="CHECK_WEBSOCKET_STATUS")return chrome.storage.session.get(["isConnected"],i=>{e({isConnected:i.isConnected||!1})}),!0;if(s.type==="FROM_REACT")O("Received message from React:",s),e({status:"Message received in background script"});else{if(s.type==="GET_COUNTDOWN_AND_POINTS")return Lw().then(e),!0;if(s.type==="CLEAR_LOCAL_STORAGE")return chrome.storage.local.clear(()=>{chrome.runtime.lastError?(z("Error clearing local storage:",chrome.runtime.lastError),e({status:"error",message:"Failed to clear local storage"})):(chrome.storage.local.set({platformSettings:ch,passiveGatheringEnabled:!1,contentExtractionEnabled:!1,autoScrollEnabled:!1,maxCaptures:100,gatheringHours:{startTime:"00:00",endTime:"23:59"},pointsTotal:0,pointsToday:0,lastUpdated:null,jobNotifications:[],jobRequirements:{},jobProgress:{}}),e({status:"success",message:"Local storage cleared"}))}),!0;if(s.type==="GET_LATEST_POINTS")return chrome.storage.local.get(["pointsTotal","pointsToday","contentPointsTotal","contentPointsToday"],i=>{e({pointsTotal:i.pointsTotal||0,pointsToday:i.pointsToday||0,contentPointsTotal:i.contentPointsTotal||0,contentPointsToday:i.contentPointsToday||0})}),!0;if(s.type==="CHECK_WEB_APP_SESSION")return uh().then(i=>{i?(O("Session valid on startup, connecting WebSockets."),ua(ci,Gc)):O("No valid session on startup, WebSockets not connected."),e({success:i})}),!0;if(s.type==="REQUEST_CONFIG_UPDATE")Dw(),e({status:"Config update requested"});else{if(s.type==="GET_HEALTH_CHECK_INFO")return Ww().then(e),!0;if(s.type==="GET_MY_POINTS"){Fl(),e({status:"requested"});return}else{if(s.type==="FORCE_WEBSOCKET_STATE_SYNC")return Tw().then(()=>e({status:"synced"})),!0;if(s.type==="GET_STORAGE_DATA"){const i=s.keys||[];return chrome.storage.local.get(i,a=>{chrome.runtime.lastError?(z("Error getting storage data:",chrome.runtime.lastError),e({error:chrome.runtime.lastError.message})):e({data:a})}),!0}else if(s.type==="SET_STORAGE_DATA"){const i=s.data||{};return chrome.storage.local.set(i,()=>{chrome.runtime.lastError?(z("Error setting storage data:",chrome.runtime.lastError),e({error:chrome.runtime.lastError.message})):e({success:!0})}),!0}}}}}return!1}),chrome.runtime.onConnect.addListener(function(s){O("Popup connected via port"),ci=s,oh(ci),s.onMessage.addListener(r=>{O("Message received via port:",r)}),s.onDisconnect.addListener(function(){O("Popup disconnected from port"),ci=null,oh(null)})}),chrome.storage.local.get(["passiveGatheringEnabled","contentExtractionEnabled"],s=>{s.passiveGatheringEnabled&&s.contentExtractionEnabled}),uh().then(s=>{s?(O("Session valid on startup, connecting WebSockets."),ua(ci,Gc)):O("No valid session on startup, WebSockets not connected.")}),chrome.storage.onChanged.addListener((s,r)=>{if(r==="local"&&s.config){const e=s.config.newValue,t=s.config.oldValue;rd(e),id(e),Ip(e,t),Fp(e,t),O("[PF] After config change, registered platforms:",fs.getRegisteredPlatformIds())}})}});async function uh(){try{for(let e=0;e<3;e++){const[t]=await chrome.tabs.query({url:`${Bp}/*`});if(t!=null&&t.id)try{const[i]=await chrome.scripting.executeScript({target:{tabId:t.id},func:async()=>{const a=localStorage.getItem("isWhitelisted"),o=localStorage.getItem("tosAccepted");if(!a||a!=="true"||!o||o!=="true")return null;const c=localStorage.getItem("accessToken"),l=localStorage.getItem("user");if(c&&l&&a&&o){const u=JSON.parse(l);return{accessToken:c,user:u,isWhitelisted:a,tosAccepted:o}}return null}});if(i!=null&&i.result){const{accessToken:a,user:o,isWhitelisted:c,tosAccepted:l}=i.result;if(a&&o&&c&&l)return await chrome.storage.local.set({accessToken:a,user:o,isWhitelisted:c,tosAccepted:l}),ua(ci,Gc),!0}}catch(i){z(`Attempt ${e+1}/3 failed:`,i)}e<2&&(O(`Attempt ${e+1} failed, retrying in 1000ms...`),await new Promise(i=>setTimeout(i,1e3)))}return z("Failed to retrieve web app session after multiple retries."),!1}catch(e){return z("Error accessing web app localStorage:",e),!1}}async function jw(s,r){var e;await chrome.action.setBadgeBackgroundColor({color:"red"}),await chrome.action.setBadgeText({text:"busy"});try{const t={isActiveJob:!0,platformId:(r==null?void 0:r.platformId)||"x",startTime:Date.now(),commands:s,jobId:(r==null?void 0:r.jobId)||`manual-job-${Date.now()}`,userId:(r==null?void 0:r.userId)||((e=(await chrome.storage.local.get("user")).user)==null?void 0:e.id)||"manual"};O(`Starting PlatformFactory for job: ${t.jobId}`),await chrome.storage.local.set({activeJobContext:t});const a=(await chrome.storage.local.get(["jobProgress"])).jobProgress||{};a[t.jobId]={jobId:t.jobId,userId:t.userId||"unknown",lastUpdated:new Date().toISOString(),status:"in_progress"},await chrome.storage.local.set({jobProgress:a}),await fs.startActiveGathering(t.platformId,t),O(`PlatformFactory finished job: ${t.jobId}`)}catch(t){z("Error during active gathering:",t)}finally{O("Puppeteer command handling finished."),await chrome.storage.local.remove("activeJobContext");const t=await chrome.storage.local.get(["gatheredData"]),i=bh(t.gatheredData);await chrome.action.setBadgeText({text:Vc(i)})}}function qw(){us.updateContentScriptStates()}async function rd(s){await zn(s,async(r,e)=>{r.endsWith("PlatformConfig")&&e&&typeof e=="object"&&"id"in e&&typeof e.id=="string"&&(O("Registering platform:",e.id),fs.registerPlatform(e))}),O("[PF] Registered platforms:",fs.getRegisteredPlatformIds())}async function Ip(s,r){const e=[];await zn(r||{},(i,a)=>{i.endsWith("PlatformConfig")&&a&&typeof a=="object"&&"id"in a&&typeof a.id=="string"&&e.push(a.id)});const t=[];await zn(s||{},(i,a)=>{i.endsWith("PlatformConfig")&&a&&typeof a=="object"&&"id"in a&&typeof a.id=="string"&&t.push(a.id)});for(const i of e)t.includes(i)||fs.unregisterPlatform(i)}async function id(s){await zn(s,async(r,e)=>{if(r.endsWith("PlatformConfig")&&e&&typeof e=="object"&&"id"in e&&typeof e.id=="string"){const t=e;O("Registering/Updating platform with ContentScriptManager:",t.id),us.registerPlatform(t,{platform:t,platformId:t.id,scriptPath:"src/entrypoints/gather.content.ts",hostnames:t.hostnames,enabled:!0})}})}async function Fp(s,r){const e=[];await zn(r||{},(i,a)=>{i.endsWith("PlatformConfig")&&a&&typeof a=="object"&&"id"in a&&typeof a.id=="string"&&e.push(a.id)});const t=[];await zn(s||{},(i,a)=>{i.endsWith("PlatformConfig")&&a&&typeof a=="object"&&"id"in a&&typeof a.id=="string"&&t.push(a.id)});for(const i of e)t.includes(i)||us.unregisterPlatform(i)}const Dp=Lp(async s=>{O("Executing debounced sync operations",{tabId:s}),await Promise.allSettled([ol(),xp()])},1e3);function Op(s){return s.includes("dashboard.teneo.pro")}async function ol(){try{const r=(await chrome.storage.local.get(["gatheredData"])).gatheredData;if(!r)return O("No gathered data to sync"),{success:!1,error:"No gathered data found"};const[e]=await Promise.all([chrome.tabs.query({url:"https://dashboard.teneo.pro/*"}).catch(()=>[])]),t=[...e];if(t.length===0)return O("No dashboard tabs found for sync"),{success:!1,error:"No dashboard tabs found"};const i=t.map(async c=>c.id?await Rp(c.id,{type:ot.SYNC_GATHERED_DATA,data:r},"gathered data"):{success:!1,error:"No tab ID"}),o=(await Promise.allSettled(i)).filter(c=>c.status==="fulfilled"&&c.value.success).length;return O(`Successfully synced gathered data to ${o}/${t.length} dashboard tabs`),{success:o>0}}catch(s){return z("Error syncing gathered data:",s),{success:!1,error:String(s)}}}async function xp(){try{const s=wc();if(!s)return O("No full config to sync"),{success:!1,error:"No full config found"};const[r]=await Promise.all([chrome.tabs.query({url:"https://dashboard.teneo.pro/*"}).catch(()=>[])]),e=[...r];if(e.length===0)return O("No dashboard tabs found for config sync"),{success:!1,error:"No dashboard tabs found"};const t=e.map(async o=>o.id?await Rp(o.id,{type:ot.SYNC_FULL_CONFIG,data:s},"full config"):{success:!1,error:"No tab ID"}),a=(await Promise.allSettled(t)).filter(o=>o.status==="fulfilled"&&o.value.success).length;return O(`Successfully synced full config to ${a}/${e.length} dashboard tabs`),{success:a>0}}catch(s){return z("Error syncing full config:",s),{success:!1,error:String(s)}}}async function Rp(s,r,e,t=3,i=1e3){for(let a=1;a<=t;a++)try{if(!await chrome.tabs.get(s).catch(()=>null))return{success:!1,error:"Tab no longer exists"};const c=a===1?i*2:i;await new Promise(u=>setTimeout(u,c));const l=await chrome.tabs.sendMessage(s,r);if(l!=null&&l.success)return O(`Successfully synced ${e} to tab ${s} on attempt ${a}`),{success:!0};O(`Sync ${e} to tab ${s} failed on attempt ${a}:`,l)}catch(o){if(O(`Attempt ${a}/${t} failed for ${e} sync to tab ${s}:`,o),a===t)return{success:!1,error:`Failed after ${t} attempts: ${String(o)}`}}return{success:!1,error:"Unexpected end of retry loop"}}function Lp(s,r){let e;return(...t)=>{clearTimeout(e),e=setTimeout(()=>s(...t),r)}}chrome.tabs.onActivated.addListener(async s=>{try{const r=await chrome.tabs.get(s.tabId);r.url&&Op(r.url)&&(O("Switched to dashboard tab, scheduling sync operations"),Dp(s.tabId))}catch(r){z("Error handling tab activation:",r)}});const Uw=Lp(async s=>{s.gatheredData&&(O("Gathered data changed, syncing to dashboard"),await ol()),s.config&&(O("Config changed, syncing to dashboard"),await xp())},500);chrome.storage.onChanged.addListener((s,r)=>{if(r==="local"){if(s.config){const e=s.config.newValue,t=s.config.oldValue;rd(e),id(e),Ip(e,t),Fp(e,t),O("[PF] After config change, registered platforms:",fs.getRegisteredPlatformIds())}(s.gatheredData||s.config)&&Uw(s)}});chrome.runtime.onMessage.addListener((s,r,e)=>{if(s.action==="clearExtensionStorage")return O("Received request to clear extension storage."),chrome.storage.local.remove("gatheredData",()=>{chrome.runtime.lastError?(z("Error clearing extension storage:",chrome.runtime.lastError),e({status:"error",message:chrome.runtime.lastError.message})):(O("Extension storage cleared."),chrome.action.setBadgeText({text:""}),e({status:"success"}))}),!0});async function Hw(){return new Promise(s=>{chrome.storage.local.get("config",r=>{r.config?s():chrome.storage.local.set({config:Cl},()=>{s()})})})}function _c(s,...r){}const Gw={debug:(...s)=>_c(console.debug,...s),log:(...s)=>_c(console.log,...s),warn:(...s)=>_c(console.warn,...s),error:(...s)=>_c(console.error,...s)};let dh;try{jp(),dh=Bw.main(),dh instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(s){throw Gw.error("The background crashed on startup!"),s}export{Jd as $,Ml as A,ug as B,Yl as C,ue as D,pe as E,og as F,gs as G,ry as H,ga as I,Cs as J,$d as K,St as L,Zg as M,xd as N,Yw as O,Gn as P,Se as Q,hy as R,Hy as S,ti as T,md as U,Ue as V,py as W,Xc as X,Wt as Y,Bt as Z,yy as _,wf as a,Ts as a0,Qn as a1,Ut as a2,Je as a3,Gm as a4,Qm as a5,Zw as a6,bs as a7,le as a8,iy as a9,sy as aa,Re as ab,ny as ac,Xl as ad,Ay as ae,tw as af,Ty as ag,hg as ah,se as ai,Vh as aj,ly as ak,nv as al,Xh as am,fy as an,at as ao,fg as ap,mg as aq,pg as ar,x as b,B as c,fd as d,qt as e,oe as f,gg as g,Vg as h,sv as i,ls as j,re as k,ca as l,Tt as m,qd as n,tg as o,eg as p,Kl as q,ey as r,ii as s,Q as t,ev as u,tv as v,rv as w,pd as x,pr as y,Oc as z};
